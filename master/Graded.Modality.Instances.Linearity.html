<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Graded.Modality.Instances.Linearity</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- A modality for linear types.</a>
<a id="106" class="Comment">------------------------------------------------------------------------</a>

<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="Tools.Bool.html" class="Module">Tools.Bool</a>

<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Graded.Modality.Instances.Zero-one-many.html" class="Module">Graded.Modality.Instances.Zero-one-many</a> <a id="256" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> as <a id="𝟘𝟙ω"></a><a id="265" href="Graded.Modality.Instances.Linearity.html#265" class="Module">𝟘𝟙ω</a>

<a id="270" class="Keyword">open</a> <a id="275" class="Keyword">import</a> <a id="282" href="Graded.Mode.Restrictions.html" class="Module">Graded.Mode.Restrictions</a>

<a id="308" class="Keyword">module</a> <a id="315" href="Graded.Modality.Instances.Linearity.html" class="Module">Graded.Modality.Instances.Linearity</a>
  <a id="353" class="Symbol">(</a><a id="354" href="Graded.Modality.Instances.Linearity.html#354" class="Bound">mrs</a> <a id="358" class="Symbol">:</a> <a id="360" href="Graded.Mode.Restrictions.html#270" class="Record">Mode-restrictions</a><a id="377" class="Symbol">)</a>
  <a id="381" class="Keyword">where</a>

<a id="388" class="Keyword">open</a> <a id="393" href="Graded.Mode.Restrictions.html#270" class="Module">Mode-restrictions</a> <a id="411" href="Graded.Modality.Instances.Linearity.html#354" class="Bound">mrs</a>

<a id="416" class="Keyword">open</a> <a id="421" href="Graded.Modality.Instances.Linearity.html#265" class="Module">𝟘𝟙ω</a> <a id="425" class="Keyword">renaming</a> <a id="434" class="Symbol">(</a><a id="435" href="Graded.Modality.Instances.Zero-one-many.html#1270" class="Datatype">Zero-one-many</a> <a id="449" class="Symbol">to</a> <a id="452" class="Datatype">Linearity</a><a id="461" class="Symbol">)</a> <a id="463" class="Keyword">public</a>

<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="Graded.Modality.html" class="Module">Graded.Modality</a> <a id="499" href="Graded.Modality.Instances.Linearity.html#452" class="Datatype">Linearity</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Graded.FullReduction.Assumptions.html" class="Module">Graded.FullReduction.Assumptions</a>
<a id="554" class="Keyword">import</a> <a id="561" href="Graded.Modality.Properties.html" class="Module">Graded.Modality.Properties</a>

<a id="589" class="Keyword">open</a> <a id="594" class="Keyword">import</a> <a id="601" href="Definition.Typed.Restrictions.html" class="Module">Definition.Typed.Restrictions</a> <a id="631" href="Graded.Modality.Instances.Linearity.html#452" class="Datatype">Linearity</a>

<a id="642" class="Keyword">open</a> <a id="647" class="Keyword">import</a> <a id="654" href="Tools.Empty.html" class="Module">Tools.Empty</a>
<a id="666" class="Keyword">open</a> <a id="671" class="Keyword">import</a> <a id="678" href="Tools.Function.html" class="Module">Tools.Function</a>
<a id="693" class="Keyword">open</a> <a id="698" class="Keyword">import</a> <a id="705" href="Tools.Nullary.html" class="Module">Tools.Nullary</a>
<a id="719" class="Keyword">open</a> <a id="724" class="Keyword">import</a> <a id="731" href="Tools.Product.html" class="Module">Tools.Product</a>
<a id="745" class="Keyword">open</a> <a id="750" class="Keyword">import</a> <a id="757" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>
<a id="785" class="Keyword">import</a> <a id="792" href="Tools.Reasoning.PartialOrder.html" class="Module">Tools.Reasoning.PartialOrder</a>
<a id="821" class="Keyword">open</a> <a id="826" class="Keyword">import</a> <a id="833" href="Tools.Unit.html" class="Module">Tools.Unit</a>

<a id="845" class="Keyword">private</a> <a id="853" class="Keyword">variable</a>
  <a id="864" href="Graded.Modality.Instances.Linearity.html#864" class="Generalizable">rs</a> <a id="867" class="Symbol">:</a> <a id="869" href="Definition.Typed.Restrictions.html#406" class="Record">Type-restrictions</a>

<a id="888" class="Comment">-- A &quot;linear types&quot; modality.</a>

<a id="linearityModality"></a><a id="919" href="Graded.Modality.Instances.Linearity.html#919" class="Function">linearityModality</a> <a id="937" class="Symbol">:</a> <a id="939" href="Graded.Modality.html#5150" class="Record">Modality</a>
<a id="948" href="Graded.Modality.Instances.Linearity.html#919" class="Function">linearityModality</a> <a id="966" class="Symbol">=</a> <a id="968" href="Graded.Modality.Instances.Zero-one-many.html#30324" class="Function">zero-one-many-greatest</a> <a id="991" href="Graded.Modality.Instances.Linearity.html#354" class="Bound">mrs</a>

<a id="996" class="Keyword">open</a> <a id="1001" href="Graded.Modality.Properties.html" class="Module">Graded.Modality.Properties</a> <a id="1028" href="Graded.Modality.Instances.Linearity.html#919" class="Function">linearityModality</a>

<a id="1047" class="Comment">-- An instance of Type-restrictions is suitable for the full reduction</a>
<a id="1118" class="Comment">-- theorem if</a>
<a id="1132" class="Comment">-- * Unit-restriction does not hold,</a>
<a id="1169" class="Comment">-- * Σₚ-restriction 𝟘 p does not hold, and</a>
<a id="1212" class="Comment">-- * Σₚ-restriction ω p does not hold.</a>

<a id="Suitable-for-full-reduction"></a><a id="1252" href="Graded.Modality.Instances.Linearity.html#1252" class="Function">Suitable-for-full-reduction</a> <a id="1280" class="Symbol">:</a>
  <a id="1284" href="Definition.Typed.Restrictions.html#406" class="Record">Type-restrictions</a> <a id="1302" class="Symbol">→</a> <a id="1304" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="1308" href="Graded.Modality.Instances.Linearity.html#1252" class="Function">Suitable-for-full-reduction</a> <a id="1336" href="Graded.Modality.Instances.Linearity.html#1336" class="Bound">rs</a> <a id="1339" class="Symbol">=</a>
  <a id="1343" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="1345" href="Definition.Typed.Restrictions.html#538" class="Field">Unit-restriction</a> <a id="1362" href="Data.Product.html#1167" class="Function Operator">×</a>
  <a id="1366" class="Symbol">(∀</a> <a id="1369" href="Graded.Modality.Instances.Linearity.html#1369" class="Bound">p</a> <a id="1371" class="Symbol">→</a> <a id="1373" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="1375" href="Definition.Typed.Restrictions.html#962" class="Function">Σₚ-restriction</a> <a id="1390" href="Graded.Modality.Instances.Zero-one-many.html#1298" class="InductiveConstructor">𝟘</a> <a id="1392" href="Graded.Modality.Instances.Linearity.html#1369" class="Bound">p</a><a id="1393" class="Symbol">)</a> <a id="1395" href="Data.Product.html#1167" class="Function Operator">×</a>
  <a id="1399" class="Symbol">(∀</a> <a id="1402" href="Graded.Modality.Instances.Linearity.html#1402" class="Bound">p</a> <a id="1404" class="Symbol">→</a> <a id="1406" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="1408" href="Definition.Typed.Restrictions.html#962" class="Function">Σₚ-restriction</a> <a id="1423" href="Graded.Modality.Instances.Zero-one-many.html#1302" class="InductiveConstructor">ω</a> <a id="1425" href="Graded.Modality.Instances.Linearity.html#1402" class="Bound">p</a><a id="1426" class="Symbol">)</a>
  <a id="1430" class="Keyword">where</a>
  <a id="1438" class="Keyword">open</a> <a id="1443" href="Definition.Typed.Restrictions.html#406" class="Module">Type-restrictions</a> <a id="1461" href="Graded.Modality.Instances.Linearity.html#1336" class="Bound">rs</a>

<a id="1465" class="Comment">-- Given an instance of Type-restrictions one can create a &quot;suitable&quot;</a>
<a id="1535" class="Comment">-- instance.</a>

<a id="suitable-for-full-reduction"></a><a id="1549" href="Graded.Modality.Instances.Linearity.html#1549" class="Function">suitable-for-full-reduction</a> <a id="1577" class="Symbol">:</a>
  <a id="1581" href="Definition.Typed.Restrictions.html#406" class="Record">Type-restrictions</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Data.Product.html#1369" class="Function">∃</a> <a id="1603" href="Graded.Modality.Instances.Linearity.html#1252" class="Function">Suitable-for-full-reduction</a>
<a id="1631" href="Graded.Modality.Instances.Linearity.html#1549" class="Function">suitable-for-full-reduction</a> <a id="1659" href="Graded.Modality.Instances.Linearity.html#1659" class="Bound">rs</a> <a id="1662" class="Symbol">=</a>
    <a id="1668" class="Keyword">record</a> <a id="1675" href="Graded.Modality.Instances.Linearity.html#1659" class="Bound">rs</a>
      <a id="1684" class="Symbol">{</a> <a id="1686" href="Definition.Typed.Restrictions.html#538" class="Field">Unit-restriction</a> <a id="1703" class="Symbol">=</a> <a id="1705" href="Data.Empty.html#526" class="Datatype">⊥</a>
      <a id="1713" class="Symbol">;</a> <a id="1715" href="Definition.Typed.Restrictions.html#617" class="Field">ΠΣ-restriction</a>   <a id="1732" class="Symbol">=</a> <a id="1734" class="Symbol">λ</a> <a id="1736" href="Graded.Modality.Instances.Linearity.html#1736" class="Bound">b</a> <a id="1738" href="Graded.Modality.Instances.Linearity.html#1738" class="Bound">p</a> <a id="1740" href="Graded.Modality.Instances.Linearity.html#1740" class="Bound">q</a> <a id="1742" class="Symbol">→</a>
          <a id="1754" href="Definition.Typed.Restrictions.html#617" class="Field">ΠΣ-restriction</a> <a id="1769" href="Graded.Modality.Instances.Linearity.html#1736" class="Bound">b</a> <a id="1771" href="Graded.Modality.Instances.Linearity.html#1738" class="Bound">p</a> <a id="1773" href="Graded.Modality.Instances.Linearity.html#1740" class="Bound">q</a> <a id="1775" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1777" href="Graded.Modality.Instances.Linearity.html#1738" class="Bound">p</a> <a id="1779" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="1781" href="Graded.Modality.Instances.Zero-one-many.html#1298" class="InductiveConstructor">𝟘</a> <a id="1783" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1785" href="Graded.Modality.Instances.Linearity.html#1738" class="Bound">p</a> <a id="1787" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="1789" href="Graded.Modality.Instances.Zero-one-many.html#1302" class="InductiveConstructor">ω</a>
      <a id="1797" class="Symbol">}</a>
  <a id="1801" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1803" href="Function.Base.html#615" class="Function">idᶠ</a>
  <a id="1809" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1811" class="Symbol">(λ</a> <a id="1814" href="Graded.Modality.Instances.Linearity.html#1814" class="Bound">_</a> <a id="1816" class="Symbol">→</a> <a id="1818" class="Symbol">(</a><a id="1819" href="Function.Base.html#1919" class="Function Operator">_$</a> <a id="1822" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="1826" class="Symbol">)</a> <a id="1828" href="Function.Base.html#1031" class="Function Operator">∘→</a> <a id="1831" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="1837" href="Function.Base.html#1031" class="Function Operator">∘→</a> <a id="1840" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="1845" class="Symbol">)</a>
  <a id="1849" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1851" class="Symbol">(λ</a> <a id="1854" href="Graded.Modality.Instances.Linearity.html#1854" class="Bound">_</a> <a id="1856" class="Symbol">→</a> <a id="1858" class="Symbol">(</a><a id="1859" href="Function.Base.html#1919" class="Function Operator">_$</a> <a id="1862" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="1866" class="Symbol">)</a> <a id="1868" href="Function.Base.html#1031" class="Function Operator">∘→</a> <a id="1871" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="1877" href="Function.Base.html#1031" class="Function Operator">∘→</a> <a id="1880" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a><a id="1885" class="Symbol">)</a>
  <a id="1889" class="Keyword">where</a>
  <a id="1897" class="Keyword">open</a> <a id="1902" href="Definition.Typed.Restrictions.html#406" class="Module">Type-restrictions</a> <a id="1920" href="Graded.Modality.Instances.Linearity.html#1659" class="Bound">rs</a>

<a id="1924" class="Comment">-- The full reduction assumptions hold for linearityModality and any</a>
<a id="1993" class="Comment">-- &quot;suitable&quot; Type-restrictions.</a>

<a id="full-reduction-assumptions"></a><a id="2027" href="Graded.Modality.Instances.Linearity.html#2027" class="Function">full-reduction-assumptions</a> <a id="2054" class="Symbol">:</a>
  <a id="2058" href="Graded.Modality.Instances.Linearity.html#1252" class="Function">Suitable-for-full-reduction</a> <a id="2086" href="Graded.Modality.Instances.Linearity.html#864" class="Generalizable">rs</a> <a id="2089" class="Symbol">→</a>
  <a id="2093" href="Graded.FullReduction.Assumptions.html#686" class="Record">Full-reduction-assumptions</a> <a id="2120" href="Graded.Modality.Instances.Linearity.html#919" class="Function">linearityModality</a> <a id="2138" href="Graded.Modality.Instances.Linearity.html#864" class="Generalizable">rs</a>
<a id="2141" href="Graded.Modality.Instances.Linearity.html#2027" class="Function">full-reduction-assumptions</a> <a id="2168" class="Symbol">(</a><a id="2169" href="Graded.Modality.Instances.Linearity.html#2169" class="Bound">¬Unit</a> <a id="2175" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2177" href="Graded.Modality.Instances.Linearity.html#2177" class="Bound">¬𝟘</a> <a id="2180" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2182" href="Graded.Modality.Instances.Linearity.html#2182" class="Bound">¬ω</a><a id="2184" class="Symbol">)</a> <a id="2186" class="Symbol">=</a> <a id="2188" class="Keyword">record</a>
  <a id="2197" class="Symbol">{</a> <a id="2199" href="Graded.FullReduction.Assumptions.html#870" class="Field">≤𝟘</a>           <a id="2212" class="Symbol">=</a> <a id="2214" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="2221" href="Function.Base.html#1031" class="Function Operator">∘→</a> <a id="2224" href="Graded.Modality.Instances.Linearity.html#2169" class="Bound">¬Unit</a>
  <a id="2232" class="Symbol">;</a> <a id="2234" href="Graded.FullReduction.Assumptions.html#1041" class="Field">·-increasing</a> <a id="2247" class="Symbol">=</a> <a id="2249" class="Symbol">λ</a> <a id="2251" class="Keyword">where</a>
      <a id="2263" class="Symbol">{</a><a id="2264" class="Argument">p</a> <a id="2266" class="Symbol">=</a> <a id="2268" href="Graded.Modality.Instances.Zero-one-many.html#1298" class="InductiveConstructor">𝟘</a><a id="2269" class="Symbol">}</a>         <a id="2279" href="Graded.Modality.Instances.Linearity.html#2279" class="Bound">ok</a> <a id="2282" class="Symbol">→</a> <a id="2284" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="2291" class="Symbol">(</a><a id="2292" href="Graded.Modality.Instances.Linearity.html#2177" class="Bound">¬𝟘</a> <a id="2295" class="Symbol">_</a> <a id="2297" href="Graded.Modality.Instances.Linearity.html#2279" class="Bound">ok</a><a id="2299" class="Symbol">)</a>
      <a id="2307" class="Symbol">{</a><a id="2308" class="Argument">p</a> <a id="2310" class="Symbol">=</a> <a id="2312" href="Graded.Modality.Instances.Zero-one-many.html#1302" class="InductiveConstructor">ω</a><a id="2313" class="Symbol">}</a>         <a id="2323" href="Graded.Modality.Instances.Linearity.html#2323" class="Bound">ok</a> <a id="2326" class="Symbol">→</a> <a id="2328" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="2335" class="Symbol">(</a><a id="2336" href="Graded.Modality.Instances.Linearity.html#2182" class="Bound">¬ω</a> <a id="2339" class="Symbol">_</a> <a id="2341" href="Graded.Modality.Instances.Linearity.html#2323" class="Bound">ok</a><a id="2343" class="Symbol">)</a>
      <a id="2351" class="Symbol">{</a><a id="2352" class="Argument">p</a> <a id="2354" class="Symbol">=</a> <a id="2356" href="Graded.Modality.Instances.Zero-one-many.html#1300" class="InductiveConstructor">𝟙</a><a id="2357" class="Symbol">}</a> <a id="2359" class="Symbol">{</a><a id="2360" class="Argument">r</a> <a id="2362" class="Symbol">=</a> <a id="2364" href="Graded.Modality.Instances.Linearity.html#2364" class="Bound">q</a><a id="2365" class="Symbol">}</a> <a id="2367" class="Symbol">_</a>  <a id="2370" class="Symbol">→</a> <a id="2372" href="Relation.Binary.Reasoning.Base.Triple.html#3010" class="Function Operator">begin</a>
        <a id="2386" href="Graded.Modality.Instances.Linearity.html#2364" class="Bound">q</a>      <a id="2393" href="Relation.Binary.Reasoning.Base.Triple.html#4870" class="Function">≡˘⟨</a> <a id="2397" href="Graded.Modality.html#2138" class="Function">·-identityˡ</a> <a id="2409" class="Symbol">_</a> <a id="2411" href="Relation.Binary.Reasoning.Base.Triple.html#4870" class="Function">⟩</a>
        <a id="2421" href="Graded.Modality.Instances.Zero-one-many.html#1300" class="InductiveConstructor">𝟙</a> <a id="2423" href="Graded.Modality.Instances.Zero-one-many.html#7118" class="Function Operator">·</a> <a id="2425" href="Graded.Modality.Instances.Linearity.html#2364" class="Bound">q</a>  <a id="2428" href="Relation.Binary.Reasoning.Base.Triple.html#5119" class="Function Operator">∎</a>
  <a id="2432" class="Symbol">;</a> <a id="2434" href="Graded.FullReduction.Assumptions.html#1237" class="Field">⌞⌟≡𝟙ᵐ→≤𝟙</a> <a id="2443" class="Symbol">=</a> <a id="2445" class="Symbol">λ</a> <a id="2447" class="Keyword">where</a>
      <a id="2459" class="Symbol">{</a><a id="2460" class="Argument">p</a> <a id="2462" class="Symbol">=</a> <a id="2464" href="Graded.Modality.Instances.Zero-one-many.html#1298" class="InductiveConstructor">𝟘</a><a id="2465" class="Symbol">}</a> <a id="2467" href="Graded.Modality.Instances.Linearity.html#2467" class="Bound">ok</a>   <a id="2472" class="Symbol">→</a> <a id="2474" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="2481" class="Symbol">(</a><a id="2482" href="Graded.Modality.Instances.Linearity.html#2177" class="Bound">¬𝟘</a> <a id="2485" class="Symbol">_</a> <a id="2487" href="Graded.Modality.Instances.Linearity.html#2467" class="Bound">ok</a><a id="2489" class="Symbol">)</a>
      <a id="2497" class="Symbol">{</a><a id="2498" class="Argument">p</a> <a id="2500" class="Symbol">=</a> <a id="2502" href="Graded.Modality.Instances.Zero-one-many.html#1302" class="InductiveConstructor">ω</a><a id="2503" class="Symbol">}</a> <a id="2505" href="Graded.Modality.Instances.Linearity.html#2505" class="Bound">ok</a>   <a id="2510" class="Symbol">→</a> <a id="2512" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="2519" class="Symbol">(</a><a id="2520" href="Graded.Modality.Instances.Linearity.html#2182" class="Bound">¬ω</a> <a id="2523" class="Symbol">_</a> <a id="2525" href="Graded.Modality.Instances.Linearity.html#2505" class="Bound">ok</a><a id="2527" class="Symbol">)</a>
      <a id="2535" class="Symbol">{</a><a id="2536" class="Argument">p</a> <a id="2538" class="Symbol">=</a> <a id="2540" href="Graded.Modality.Instances.Zero-one-many.html#1300" class="InductiveConstructor">𝟙</a><a id="2541" class="Symbol">}</a> <a id="2543" class="Symbol">_</a>  <a id="2546" class="Symbol">_</a> <a id="2548" class="Symbol">→</a> <a id="2550" href="Relation.Binary.Reasoning.Base.Triple.html#3010" class="Function Operator">begin</a>
        <a id="2564" href="Graded.Modality.Instances.Zero-one-many.html#1300" class="InductiveConstructor">𝟙</a>  <a id="2567" href="Relation.Binary.Reasoning.Base.Triple.html#5023" class="Function Operator">≡⟨⟩</a>
        <a id="2579" href="Graded.Modality.Instances.Zero-one-many.html#1300" class="InductiveConstructor">𝟙</a>  <a id="2582" href="Relation.Binary.Reasoning.Base.Triple.html#5119" class="Function Operator">∎</a>
  <a id="2586" class="Symbol">}</a>
  <a id="2590" class="Keyword">where</a>
  <a id="2598" class="Keyword">open</a> <a id="2603" href="Graded.Modality.html#5150" class="Module">Modality</a> <a id="2612" href="Graded.Modality.Instances.Linearity.html#919" class="Function">linearityModality</a> <a id="2630" class="Keyword">using</a> <a id="2636" class="Symbol">(</a><a id="2637" href="Graded.Modality.html#2138" class="Function">·-identityˡ</a><a id="2648" class="Symbol">)</a>
  <a id="2652" class="Keyword">open</a> <a id="2657" href="Tools.Reasoning.PartialOrder.html" class="Module">Tools.Reasoning.PartialOrder</a> <a id="2686" href="Graded.Modality.Properties.PartialOrder.html#1499" class="Function">≤-poset</a>
</pre></body></html>