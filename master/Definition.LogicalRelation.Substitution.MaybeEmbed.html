<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Definition.LogicalRelation.Substitution.MaybeEmbed</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Embedding of the logical relation into higher type levels</a>
<a id="135" class="Comment">------------------------------------------------------------------------</a>

<a id="209" class="Keyword">open</a> <a id="214" class="Keyword">import</a> <a id="221" href="Definition.Typed.EqualityRelation.html" class="Module">Definition.Typed.EqualityRelation</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Definition.Typed.Restrictions.html" class="Module">Definition.Typed.Restrictions</a>
<a id="297" class="Keyword">open</a> <a id="302" class="Keyword">import</a> <a id="309" href="Graded.Modality.html" class="Module">Graded.Modality</a>

<a id="326" class="Keyword">module</a> <a id="333" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html" class="Module">Definition.LogicalRelation.Substitution.MaybeEmbed</a>
  <a id="386" class="Symbol">{</a><a id="387" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#387" class="Bound">a</a><a id="388" class="Symbol">}</a> <a id="390" class="Symbol">{</a><a id="391" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#391" class="Bound">M</a> <a id="393" class="Symbol">:</a> <a id="395" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="399" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#387" class="Bound">a</a><a id="400" class="Symbol">}</a>
  <a id="404" class="Symbol">{</a><a id="405" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#405" class="Bound">𝕄</a> <a id="407" class="Symbol">:</a> <a id="409" href="Graded.Modality.html#7187" class="Record">Modality</a> <a id="418" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#391" class="Bound">M</a><a id="419" class="Symbol">}</a>
  <a id="423" class="Symbol">(</a><a id="424" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#424" class="Bound">R</a> <a id="426" class="Symbol">:</a> <a id="428" href="Definition.Typed.Restrictions.html#752" class="Record">Type-restrictions</a> <a id="446" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#405" class="Bound">𝕄</a><a id="447" class="Symbol">)</a>
  <a id="451" class="Symbol">{{</a><a id="453" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#453" class="Bound">eqrel</a> <a id="459" class="Symbol">:</a> <a id="461" href="Definition.Typed.EqualityRelation.html#1140" class="Record">EqRelSet</a> <a id="470" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#424" class="Bound">R</a><a id="471" class="Symbol">}}</a>
  <a id="476" class="Keyword">where</a>

<a id="483" class="Keyword">open</a> <a id="488" href="Definition.Typed.EqualityRelation.html#1140" class="Module">EqRelSet</a> <a id="497" class="Symbol">{{...}}</a>

<a id="506" class="Keyword">open</a> <a id="511" class="Keyword">import</a> <a id="518" href="Definition.LogicalRelation.html" class="Module">Definition.LogicalRelation</a> <a id="545" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#424" class="Bound">R</a>
<a id="547" class="Keyword">open</a> <a id="552" class="Keyword">import</a> <a id="559" href="Definition.LogicalRelation.Irrelevance.html" class="Module">Definition.LogicalRelation.Irrelevance</a> <a id="598" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#424" class="Bound">R</a>
<a id="600" class="Keyword">open</a> <a id="605" class="Keyword">import</a> <a id="612" href="Definition.LogicalRelation.Properties.html" class="Module">Definition.LogicalRelation.Properties</a> <a id="650" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#424" class="Bound">R</a>
<a id="652" class="Keyword">open</a> <a id="657" class="Keyword">import</a> <a id="664" href="Definition.LogicalRelation.Substitution.html" class="Module">Definition.LogicalRelation.Substitution</a> <a id="704" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#424" class="Bound">R</a>
<a id="706" class="Keyword">open</a> <a id="711" class="Keyword">import</a> <a id="718" href="Definition.Untyped.html" class="Module">Definition.Untyped</a> <a id="737" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#391" class="Bound">M</a> <a id="739" class="Keyword">using</a> <a id="745" class="Symbol">(</a><a id="746" href="Definition.Untyped.NotParametrised.html#791" class="Datatype">Con</a> <a id="750" class="Symbol">;</a> <a id="752" href="Definition.Untyped.html#2392" class="Datatype">Term</a><a id="756" class="Symbol">)</a>

<a id="759" class="Keyword">open</a> <a id="764" class="Keyword">import</a> <a id="771" href="Tools.Nat.html" class="Module">Tools.Nat</a>
<a id="781" class="Keyword">open</a> <a id="786" class="Keyword">import</a> <a id="793" href="Tools.Product.html" class="Module">Tools.Product</a>

<a id="808" class="Keyword">private</a>
  <a id="818" class="Keyword">variable</a>
    <a id="831" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#831" class="Generalizable">n</a> <a id="833" class="Symbol">:</a> <a id="835" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
    <a id="843" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#843" class="Generalizable">Γ</a> <a id="845" class="Symbol">:</a> <a id="847" href="Definition.Untyped.NotParametrised.html#791" class="Datatype">Con</a> <a id="851" href="Definition.Untyped.html#2392" class="Datatype">Term</a> <a id="856" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#831" class="Generalizable">n</a>

<a id="859" class="Comment">-- Any level can be embedded into the highest level (validity variant).</a>
<a id="maybeEmbᵛ"></a><a id="931" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#931" class="Function">maybeEmbᵛ</a> <a id="941" class="Symbol">:</a> <a id="943" class="Symbol">∀</a> <a id="945" class="Symbol">{</a><a id="946" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#946" class="Bound">l</a> <a id="948" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#948" class="Bound">A</a><a id="949" class="Symbol">}</a>
            <a id="963" class="Symbol">(</a><a id="964" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#964" class="Bound">[Γ]</a> <a id="968" class="Symbol">:</a> <a id="970" href="Definition.LogicalRelation.Substitution.html#840" class="Datatype Operator">⊩ᵛ</a> <a id="973" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#843" class="Generalizable">Γ</a><a id="974" class="Symbol">)</a>
          <a id="986" class="Symbol">→</a> <a id="988" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#843" class="Generalizable">Γ</a> <a id="990" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">⊩ᵛ⟨</a> <a id="994" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#946" class="Bound">l</a> <a id="996" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">⟩</a> <a id="998" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#948" class="Bound">A</a> <a id="1000" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">/</a> <a id="1002" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#964" class="Bound">[Γ]</a>
          <a id="1016" class="Symbol">→</a> <a id="1018" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#843" class="Generalizable">Γ</a> <a id="1020" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">⊩ᵛ⟨</a> <a id="1024" href="Definition.LogicalRelation.html#6359" class="InductiveConstructor">¹</a> <a id="1026" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">⟩</a> <a id="1028" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#948" class="Bound">A</a> <a id="1030" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">/</a> <a id="1032" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#964" class="Bound">[Γ]</a>
<a id="1036" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#931" class="Function">maybeEmbᵛ</a> <a id="1046" class="Symbol">{</a><a id="1047" class="Argument">l</a> <a id="1049" class="Symbol">=</a> <a id="1051" href="Definition.LogicalRelation.html#6289" class="InductiveConstructor">⁰</a><a id="1052" class="Symbol">}</a> <a id="1054" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1054" class="Bound">[Γ]</a> <a id="1058" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1058" class="Bound">[A]</a> <a id="1062" class="Symbol">=</a> <a id="1064" href="Definition.LogicalRelation.Substitution.html#1147" class="InductiveConstructor">wrap</a> <a id="1069" class="Symbol">λ</a> <a id="1071" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1071" class="Bound">⊢Δ</a> <a id="1074" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1074" class="Bound">[σ]</a> <a id="1078" class="Symbol">→</a>
  <a id="1082" class="Keyword">let</a> <a id="1086" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1086" class="Bound">[σA]</a>  <a id="1092" class="Symbol">=</a> <a id="1094" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1100" class="Symbol">(</a><a id="1101" href="Definition.LogicalRelation.Substitution.html#1168" class="Field">unwrap</a> <a id="1108" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1058" class="Bound">[A]</a> <a id="1112" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1071" class="Bound">⊢Δ</a> <a id="1115" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1074" class="Bound">[σ]</a><a id="1118" class="Symbol">)</a>
      <a id="1126" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1126" class="Bound">[σA]′</a> <a id="1132" class="Symbol">=</a> <a id="1134" href="Definition.LogicalRelation.Properties.MaybeEmb.html#1509" class="Function">maybeEmb</a> <a id="1143" class="Symbol">(</a><a id="1144" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1150" class="Symbol">(</a><a id="1151" href="Definition.LogicalRelation.Substitution.html#1168" class="Field">unwrap</a> <a id="1158" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1058" class="Bound">[A]</a> <a id="1162" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1071" class="Bound">⊢Δ</a> <a id="1165" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1074" class="Bound">[σ]</a><a id="1168" class="Symbol">))</a>
  <a id="1173" class="Keyword">in</a>  <a id="1177" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1126" class="Bound">[σA]′</a>
  <a id="1185" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a>   <a id="1189" class="Symbol">(λ</a> <a id="1192" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1192" class="Bound">[σ′]</a> <a id="1197" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1197" class="Bound">[σ≡σ′]</a> <a id="1204" class="Symbol">→</a> <a id="1206" href="Definition.LogicalRelation.Irrelevance.html#1500" class="Function">irrelevanceEq</a> <a id="1220" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1086" class="Bound">[σA]</a> <a id="1225" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1126" class="Bound">[σA]′</a> <a id="1231" class="Symbol">(</a><a id="1232" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1238" class="Symbol">(</a><a id="1239" href="Definition.LogicalRelation.Substitution.html#1168" class="Field">unwrap</a> <a id="1246" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1058" class="Bound">[A]</a> <a id="1250" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1071" class="Bound">⊢Δ</a> <a id="1253" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1074" class="Bound">[σ]</a><a id="1256" class="Symbol">)</a> <a id="1258" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1192" class="Bound">[σ′]</a> <a id="1263" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1197" class="Bound">[σ≡σ′]</a><a id="1269" class="Symbol">))</a>
<a id="1272" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#931" class="Function">maybeEmbᵛ</a> <a id="1282" class="Symbol">{</a><a id="1283" class="Argument">l</a> <a id="1285" class="Symbol">=</a> <a id="1287" href="Definition.LogicalRelation.html#6359" class="InductiveConstructor">¹</a><a id="1288" class="Symbol">}</a> <a id="1290" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1290" class="Bound">[Γ]</a> <a id="1294" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1294" class="Bound">[A]</a> <a id="1298" class="Symbol">=</a> <a id="1300" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1294" class="Bound">[A]</a>

<a id="1305" class="Comment">-- The lowest level can be embedded in any level (validity variant).</a>
<a id="maybeEmbₛ′"></a><a id="1374" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1374" class="Function">maybeEmbₛ′</a> <a id="1385" class="Symbol">:</a> <a id="1387" class="Symbol">∀</a> <a id="1389" class="Symbol">{</a><a id="1390" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1390" class="Bound">l</a> <a id="1392" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1392" class="Bound">A</a><a id="1393" class="Symbol">}</a>
             <a id="1408" class="Symbol">(</a><a id="1409" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1409" class="Bound">[Γ]</a> <a id="1413" class="Symbol">:</a> <a id="1415" href="Definition.LogicalRelation.Substitution.html#840" class="Datatype Operator">⊩ᵛ</a> <a id="1418" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#843" class="Generalizable">Γ</a><a id="1419" class="Symbol">)</a>
           <a id="1432" class="Symbol">→</a> <a id="1434" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#843" class="Generalizable">Γ</a> <a id="1436" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">⊩ᵛ⟨</a> <a id="1440" href="Definition.LogicalRelation.html#6289" class="InductiveConstructor">⁰</a> <a id="1442" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">⟩</a> <a id="1444" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1392" class="Bound">A</a> <a id="1446" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">/</a> <a id="1448" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1409" class="Bound">[Γ]</a>
           <a id="1463" class="Symbol">→</a> <a id="1465" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#843" class="Generalizable">Γ</a> <a id="1467" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">⊩ᵛ⟨</a> <a id="1471" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1390" class="Bound">l</a> <a id="1473" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">⟩</a> <a id="1475" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1392" class="Bound">A</a> <a id="1477" href="Definition.LogicalRelation.Substitution.html#987" class="Record Operator">/</a> <a id="1479" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1409" class="Bound">[Γ]</a>
<a id="1483" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1374" class="Function">maybeEmbₛ′</a> <a id="1494" class="Symbol">{</a><a id="1495" class="Argument">l</a> <a id="1497" class="Symbol">=</a> <a id="1499" href="Definition.LogicalRelation.html#6289" class="InductiveConstructor">⁰</a><a id="1500" class="Symbol">}</a> <a id="1502" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1502" class="Bound">[Γ]</a> <a id="1506" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1506" class="Bound">[A]</a> <a id="1510" class="Symbol">=</a> <a id="1512" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1506" class="Bound">[A]</a>
<a id="1516" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1374" class="Function">maybeEmbₛ′</a> <a id="1527" class="Symbol">{</a><a id="1528" class="Argument">l</a> <a id="1530" class="Symbol">=</a> <a id="1532" href="Definition.LogicalRelation.html#6359" class="InductiveConstructor">¹</a><a id="1533" class="Symbol">}</a> <a id="1535" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1535" class="Bound">[Γ]</a> <a id="1539" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1539" class="Bound">[A]</a> <a id="1543" class="Symbol">=</a> <a id="1545" href="Definition.LogicalRelation.Substitution.html#1147" class="InductiveConstructor">wrap</a> <a id="1550" class="Symbol">λ</a> <a id="1552" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1552" class="Bound">⊢Δ</a> <a id="1555" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1555" class="Bound">[σ]</a> <a id="1559" class="Symbol">→</a>
  <a id="1563" class="Keyword">let</a> <a id="1567" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1567" class="Bound">[σA]</a>  <a id="1573" class="Symbol">=</a> <a id="1575" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1581" class="Symbol">(</a><a id="1582" href="Definition.LogicalRelation.Substitution.html#1168" class="Field">unwrap</a> <a id="1589" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1539" class="Bound">[A]</a> <a id="1593" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1552" class="Bound">⊢Δ</a> <a id="1596" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1555" class="Bound">[σ]</a><a id="1599" class="Symbol">)</a>
      <a id="1607" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1607" class="Bound">[σA]′</a> <a id="1613" class="Symbol">=</a> <a id="1615" href="Definition.LogicalRelation.Properties.MaybeEmb.html#1685" class="Function">maybeEmb′</a> <a id="1625" class="Symbol">(</a><a id="1626" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Definition.LogicalRelation.Substitution.html#1168" class="Field">unwrap</a> <a id="1640" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1539" class="Bound">[A]</a> <a id="1644" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1552" class="Bound">⊢Δ</a> <a id="1647" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1555" class="Bound">[σ]</a><a id="1650" class="Symbol">))</a>
  <a id="1655" class="Keyword">in</a>  <a id="1659" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1607" class="Bound">[σA]′</a>
  <a id="1667" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a>   <a id="1671" class="Symbol">(λ</a> <a id="1674" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1674" class="Bound">[σ′]</a> <a id="1679" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1679" class="Bound">[σ≡σ′]</a> <a id="1686" class="Symbol">→</a> <a id="1688" href="Definition.LogicalRelation.Irrelevance.html#1500" class="Function">irrelevanceEq</a> <a id="1702" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1567" class="Bound">[σA]</a> <a id="1707" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1607" class="Bound">[σA]′</a> <a id="1713" class="Symbol">(</a><a id="1714" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1720" class="Symbol">(</a><a id="1721" href="Definition.LogicalRelation.Substitution.html#1168" class="Field">unwrap</a> <a id="1728" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1539" class="Bound">[A]</a> <a id="1732" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1552" class="Bound">⊢Δ</a> <a id="1735" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1555" class="Bound">[σ]</a><a id="1738" class="Symbol">)</a> <a id="1740" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1674" class="Bound">[σ′]</a> <a id="1745" href="Definition.LogicalRelation.Substitution.MaybeEmbed.html#1679" class="Bound">[σ≡σ′]</a><a id="1751" class="Symbol">))</a>
</pre></body></html>