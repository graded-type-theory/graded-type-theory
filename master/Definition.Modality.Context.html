<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Definition.Modality.Context</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Modality (grade) contexts.</a>
<a id="104" class="Comment">------------------------------------------------------------------------</a>

<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Definition.Modality.html" class="Module">Definition.Modality</a>

<a id="211" class="Keyword">module</a> <a id="218" href="Definition.Modality.Context.html" class="Module">Definition.Modality.Context</a>
  <a id="248" class="Symbol">{</a><a id="249" href="Definition.Modality.Context.html#249" class="Bound">a</a><a id="250" class="Symbol">}</a> <a id="252" class="Symbol">{</a><a id="253" href="Definition.Modality.Context.html#253" class="Bound">M</a> <a id="255" class="Symbol">:</a> <a id="257" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="261" href="Definition.Modality.Context.html#249" class="Bound">a</a><a id="262" class="Symbol">}</a> <a id="264" class="Symbol">(</a><a id="265" href="Definition.Modality.Context.html#265" class="Bound">𝕄</a> <a id="267" class="Symbol">:</a> <a id="269" href="Definition.Modality.html#5110" class="Record">Modality</a> <a id="278" href="Definition.Modality.Context.html#253" class="Bound">M</a><a id="279" class="Symbol">)</a> <a id="281" class="Keyword">where</a>

<a id="288" class="Keyword">open</a> <a id="293" href="Definition.Modality.html#5110" class="Module">Modality</a> <a id="302" href="Definition.Modality.Context.html#265" class="Bound">𝕄</a>

<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Tools.Fin.html" class="Module">Tools.Fin</a>
<a id="327" class="Keyword">open</a> <a id="332" class="Keyword">import</a> <a id="339" href="Tools.Nat.html" class="Module">Tools.Nat</a> <a id="349" class="Keyword">renaming</a> <a id="358" class="Symbol">(</a><a id="359" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+_</a> <a id="363" class="Symbol">to</a> <a id="366" class="Primitive Operator">_+ⁿ_</a><a id="370" class="Symbol">)</a>
<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>

<a id="413" class="Keyword">infixl</a> <a id="420" class="Number">30</a> <a id="423" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">_∙_</a>
<a id="427" class="Keyword">infixr</a> <a id="434" class="Number">40</a> <a id="437" href="Definition.Modality.Context.html#1436" class="Function Operator">_+ᶜ_</a>
<a id="442" class="Keyword">infixr</a> <a id="449" class="Number">40</a> <a id="452" href="Definition.Modality.Context.html#1556" class="Function Operator">_∧ᶜ_</a>
<a id="457" class="Keyword">infixr</a> <a id="464" class="Number">45</a> <a id="467" href="Definition.Modality.Context.html#1668" class="Function Operator">_·ᶜ_</a>
<a id="472" class="Keyword">infixr</a> <a id="479" class="Number">45</a> <a id="482" href="Definition.Modality.Context.html#1325" class="Function Operator">_*_</a>
<a id="486" class="Keyword">infix</a>  <a id="493" class="Number">50</a> <a id="496" href="Definition.Modality.Context.html#1876" class="Function Operator">_⊛ᶜ_▷_</a>
<a id="503" class="Keyword">infix</a>  <a id="510" class="Number">10</a> <a id="513" href="Definition.Modality.Context.html#1790" class="Function Operator">_≤ᶜ_</a>
<a id="518" class="Keyword">infix</a>  <a id="525" class="Number">35</a> <a id="528" href="Definition.Modality.Context.html#1042" class="Function Operator">_,_≔_</a>
<a id="534" class="Keyword">infix</a>  <a id="541" class="Number">60</a> <a id="544" href="Definition.Modality.Context.html#1197" class="Function Operator">_⟨_⟩</a>

<a id="550" class="Keyword">private</a>
  <a id="560" class="Keyword">variable</a>
    <a id="573" href="Definition.Modality.Context.html#573" class="Generalizable">m</a> <a id="575" href="Definition.Modality.Context.html#575" class="Generalizable">n</a> <a id="577" class="Symbol">:</a> <a id="579" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a>


<a id="585" class="Comment">-- Modality Contexts are snoc-lists</a>

<a id="622" class="Keyword">data</a> <a id="Conₘ"></a><a id="627" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="632" class="Symbol">:</a> <a id="634" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a> <a id="638" class="Symbol">→</a> <a id="640" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="644" href="Definition.Modality.Context.html#249" class="Bound">a</a> <a id="646" class="Keyword">where</a>
  <a id="Conₘ.ε"></a><a id="654" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a>   <a id="658" class="Symbol">:</a> <a id="660" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="665" class="Number">0</a>
  <a id="Conₘ._∙_"></a><a id="669" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">_∙_</a> <a id="673" class="Symbol">:</a> <a id="675" class="Symbol">(</a><a id="676" href="Definition.Modality.Context.html#676" class="Bound">γ</a> <a id="678" class="Symbol">:</a> <a id="680" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="685" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="686" class="Symbol">)</a> <a id="688" class="Symbol">→</a> <a id="690" class="Symbol">(</a><a id="691" href="Definition.Modality.Context.html#691" class="Bound">p</a> <a id="693" class="Symbol">:</a> <a id="695" href="Definition.Modality.Context.html#253" class="Bound">M</a><a id="696" class="Symbol">)</a> <a id="698" class="Symbol">→</a> <a id="700" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="705" class="Symbol">(</a><a id="706" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="709" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="710" class="Symbol">)</a>

<a id="713" class="Comment">-- Modality equality lifted pointwise to contexts</a>

<a id="764" class="Keyword">data</a> <a id="_≈ᶜ_"></a><a id="769" href="Definition.Modality.Context.html#769" class="Datatype Operator">_≈ᶜ_</a> <a id="774" class="Symbol">:</a> <a id="776" class="Symbol">(</a><a id="777" href="Definition.Modality.Context.html#777" class="Bound">γ</a> <a id="779" href="Definition.Modality.Context.html#779" class="Bound">δ</a> <a id="781" class="Symbol">:</a> <a id="783" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="788" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="789" class="Symbol">)</a> <a id="791" class="Symbol">→</a> <a id="793" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="797" href="Definition.Modality.Context.html#249" class="Bound">a</a> <a id="799" class="Keyword">where</a>
  <a id="_≈ᶜ_.ε"></a><a id="807" href="Definition.Modality.Context.html#807" class="InductiveConstructor">ε</a> <a id="809" class="Symbol">:</a> <a id="811" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="813" href="Definition.Modality.Context.html#769" class="Datatype Operator">≈ᶜ</a> <a id="816" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a>
  <a id="_≈ᶜ_._∙_"></a><a id="820" href="Definition.Modality.Context.html#820" class="InductiveConstructor Operator">_∙_</a> <a id="824" class="Symbol">:</a> <a id="826" class="Symbol">{</a><a id="827" href="Definition.Modality.Context.html#827" class="Bound">γ</a> <a id="829" href="Definition.Modality.Context.html#829" class="Bound">δ</a> <a id="831" class="Symbol">:</a> <a id="833" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="838" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="839" class="Symbol">}</a> <a id="841" class="Symbol">{</a><a id="842" href="Definition.Modality.Context.html#842" class="Bound">p</a> <a id="844" href="Definition.Modality.Context.html#844" class="Bound">q</a> <a id="846" class="Symbol">:</a> <a id="848" href="Definition.Modality.Context.html#253" class="Bound">M</a><a id="849" class="Symbol">}</a> <a id="851" class="Symbol">→</a> <a id="853" href="Definition.Modality.Context.html#827" class="Bound">γ</a> <a id="855" href="Definition.Modality.Context.html#769" class="Datatype Operator">≈ᶜ</a> <a id="858" href="Definition.Modality.Context.html#829" class="Bound">δ</a> <a id="860" class="Symbol">→</a> <a id="862" href="Definition.Modality.Context.html#842" class="Bound">p</a> <a id="864" href="Relation.Binary.Bundles.html#1098" class="Function Operator">≈</a> <a id="866" href="Definition.Modality.Context.html#844" class="Bound">q</a> <a id="868" class="Symbol">→</a> <a id="870" class="Symbol">(</a><a id="871" href="Definition.Modality.Context.html#827" class="Bound">γ</a> <a id="873" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="875" href="Definition.Modality.Context.html#842" class="Bound">p</a><a id="876" class="Symbol">)</a> <a id="878" href="Definition.Modality.Context.html#769" class="Datatype Operator">≈ᶜ</a> <a id="881" class="Symbol">(</a><a id="882" href="Definition.Modality.Context.html#829" class="Bound">δ</a> <a id="884" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="886" href="Definition.Modality.Context.html#844" class="Bound">q</a><a id="887" class="Symbol">)</a>


<a id="headₘ"></a><a id="891" href="Definition.Modality.Context.html#891" class="Function">headₘ</a> <a id="897" class="Symbol">:</a> <a id="899" class="Symbol">(</a><a id="900" href="Definition.Modality.Context.html#900" class="Bound">γ</a> <a id="902" class="Symbol">:</a> <a id="904" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="909" class="Symbol">(</a><a id="910" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="913" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="914" class="Symbol">))</a> <a id="917" class="Symbol">→</a> <a id="919" href="Definition.Modality.Context.html#253" class="Bound">M</a>
<a id="921" href="Definition.Modality.Context.html#891" class="Function">headₘ</a> <a id="927" class="Symbol">(</a><a id="928" href="Definition.Modality.Context.html#928" class="Bound">γ</a> <a id="930" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="932" href="Definition.Modality.Context.html#932" class="Bound">p</a><a id="933" class="Symbol">)</a> <a id="935" class="Symbol">=</a> <a id="937" href="Definition.Modality.Context.html#932" class="Bound">p</a>

<a id="tailₘ"></a><a id="940" href="Definition.Modality.Context.html#940" class="Function">tailₘ</a> <a id="946" class="Symbol">:</a> <a id="948" class="Symbol">(</a><a id="949" href="Definition.Modality.Context.html#949" class="Bound">γ</a> <a id="951" class="Symbol">:</a> <a id="953" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="958" class="Symbol">(</a><a id="959" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="962" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="963" class="Symbol">))</a> <a id="966" class="Symbol">→</a> <a id="968" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="973" href="Definition.Modality.Context.html#575" class="Generalizable">n</a>
<a id="975" href="Definition.Modality.Context.html#940" class="Function">tailₘ</a> <a id="981" class="Symbol">(</a><a id="982" href="Definition.Modality.Context.html#982" class="Bound">γ</a> <a id="984" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="986" href="Definition.Modality.Context.html#986" class="Bound">p</a><a id="987" class="Symbol">)</a> <a id="989" class="Symbol">=</a> <a id="991" href="Definition.Modality.Context.html#982" class="Bound">γ</a>

<a id="994" class="Comment">-- Update the value of an element in a context</a>

<a id="_,_≔_"></a><a id="1042" href="Definition.Modality.Context.html#1042" class="Function Operator">_,_≔_</a> <a id="1048" class="Symbol">:</a> <a id="1050" class="Symbol">(</a><a id="1051" href="Definition.Modality.Context.html#1051" class="Bound">γ</a> <a id="1053" class="Symbol">:</a> <a id="1055" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1060" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1061" class="Symbol">)</a> <a id="1063" class="Symbol">(</a><a id="1064" href="Definition.Modality.Context.html#1064" class="Bound">x</a> <a id="1066" class="Symbol">:</a> <a id="1068" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1072" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1073" class="Symbol">)</a> <a id="1075" class="Symbol">(</a><a id="1076" href="Definition.Modality.Context.html#1076" class="Bound">p</a> <a id="1078" class="Symbol">:</a> <a id="1080" href="Definition.Modality.Context.html#253" class="Bound">M</a><a id="1081" class="Symbol">)</a> <a id="1083" class="Symbol">→</a> <a id="1085" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1090" href="Definition.Modality.Context.html#575" class="Generalizable">n</a>
<a id="1092" class="Symbol">(</a><a id="1093" href="Definition.Modality.Context.html#1093" class="Bound">γ</a> <a id="1095" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1097" href="Definition.Modality.Context.html#1097" class="Bound">q</a><a id="1098" class="Symbol">)</a> <a id="1100" href="Definition.Modality.Context.html#1042" class="Function Operator">,</a> <a id="1102" href="Data.Fin.Base.html#1148" class="InductiveConstructor">x0</a>     <a id="1109" href="Definition.Modality.Context.html#1042" class="Function Operator">≔</a> <a id="1111" href="Definition.Modality.Context.html#1111" class="Bound">p</a> <a id="1113" class="Symbol">=</a> <a id="1115" href="Definition.Modality.Context.html#1093" class="Bound">γ</a> <a id="1117" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1119" href="Definition.Modality.Context.html#1111" class="Bound">p</a>
<a id="1121" class="Symbol">(</a><a id="1122" href="Definition.Modality.Context.html#1122" class="Bound">γ</a> <a id="1124" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1126" href="Definition.Modality.Context.html#1126" class="Bound">q</a><a id="1127" class="Symbol">)</a> <a id="1129" href="Definition.Modality.Context.html#1042" class="Function Operator">,</a> <a id="1131" class="Symbol">(</a><a id="1132" href="Definition.Modality.Context.html#1132" class="Bound">x</a> <a id="1134" href="Data.Fin.Base.html#1179" class="InductiveConstructor Operator">+1</a><a id="1136" class="Symbol">)</a> <a id="1138" href="Definition.Modality.Context.html#1042" class="Function Operator">≔</a> <a id="1140" href="Definition.Modality.Context.html#1140" class="Bound">p</a> <a id="1142" class="Symbol">=</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Definition.Modality.Context.html#1122" class="Bound">γ</a> <a id="1147" href="Definition.Modality.Context.html#1042" class="Function Operator">,</a> <a id="1149" href="Definition.Modality.Context.html#1132" class="Bound">x</a> <a id="1151" href="Definition.Modality.Context.html#1042" class="Function Operator">≔</a> <a id="1153" href="Definition.Modality.Context.html#1140" class="Bound">p</a><a id="1154" class="Symbol">)</a> <a id="1156" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1158" href="Definition.Modality.Context.html#1126" class="Bound">q</a>

<a id="1161" class="Comment">-- Look up an element in a context</a>

<a id="_⟨_⟩"></a><a id="1197" href="Definition.Modality.Context.html#1197" class="Function Operator">_⟨_⟩</a> <a id="1202" class="Symbol">:</a> <a id="1204" class="Symbol">(</a><a id="1205" href="Definition.Modality.Context.html#1205" class="Bound">γ</a> <a id="1207" class="Symbol">:</a> <a id="1209" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1214" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1215" class="Symbol">)</a> <a id="1217" class="Symbol">→</a> <a id="1219" class="Symbol">(</a><a id="1220" href="Definition.Modality.Context.html#1220" class="Bound">x</a> <a id="1222" class="Symbol">:</a> <a id="1224" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1228" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1229" class="Symbol">)</a> <a id="1231" class="Symbol">→</a> <a id="1233" href="Definition.Modality.Context.html#253" class="Bound">M</a>
<a id="1235" class="Symbol">(</a><a id="1236" href="Definition.Modality.Context.html#1236" class="Bound">γ</a> <a id="1238" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1240" href="Definition.Modality.Context.html#1240" class="Bound">p</a><a id="1241" class="Symbol">)</a> <a id="1243" href="Definition.Modality.Context.html#1197" class="Function Operator">⟨</a> <a id="1245" href="Data.Fin.Base.html#1148" class="InductiveConstructor">x0</a> <a id="1248" href="Definition.Modality.Context.html#1197" class="Function Operator">⟩</a>   <a id="1252" class="Symbol">=</a> <a id="1254" href="Definition.Modality.Context.html#1240" class="Bound">p</a>
<a id="1256" class="Symbol">(</a><a id="1257" href="Definition.Modality.Context.html#1257" class="Bound">γ</a> <a id="1259" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1261" href="Definition.Modality.Context.html#1261" class="Bound">p</a><a id="1262" class="Symbol">)</a> <a id="1264" href="Definition.Modality.Context.html#1197" class="Function Operator">⟨</a> <a id="1266" href="Definition.Modality.Context.html#1266" class="Bound">x</a> <a id="1268" href="Data.Fin.Base.html#1179" class="InductiveConstructor Operator">+1</a> <a id="1271" href="Definition.Modality.Context.html#1197" class="Function Operator">⟩</a> <a id="1273" class="Symbol">=</a> <a id="1275" href="Definition.Modality.Context.html#1257" class="Bound">γ</a> <a id="1277" href="Definition.Modality.Context.html#1197" class="Function Operator">⟨</a> <a id="1279" href="Definition.Modality.Context.html#1266" class="Bound">x</a> <a id="1281" href="Definition.Modality.Context.html#1197" class="Function Operator">⟩</a>


<a id="1285" class="Comment">-- Scalar product of modality contexts</a>

<a id="_*_"></a><a id="1325" href="Definition.Modality.Context.html#1325" class="Function Operator">_*_</a> <a id="1329" class="Symbol">:</a> <a id="1331" class="Symbol">(</a><a id="1332" href="Definition.Modality.Context.html#1332" class="Bound">γ</a> <a id="1334" href="Definition.Modality.Context.html#1334" class="Bound">δ</a> <a id="1336" class="Symbol">:</a> <a id="1338" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1343" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1344" class="Symbol">)</a> <a id="1346" class="Symbol">→</a> <a id="1348" href="Definition.Modality.Context.html#253" class="Bound">M</a>
<a id="1350" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1352" href="Definition.Modality.Context.html#1325" class="Function Operator">*</a> <a id="1354" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1356" class="Symbol">=</a> <a id="1358" href="Definition.Modality.html#807" class="Function">𝟘</a>
<a id="1360" class="Symbol">(</a><a id="1361" href="Definition.Modality.Context.html#1361" class="Bound">γ</a> <a id="1363" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1365" href="Definition.Modality.Context.html#1365" class="Bound">p</a><a id="1366" class="Symbol">)</a> <a id="1368" href="Definition.Modality.Context.html#1325" class="Function Operator">*</a> <a id="1370" class="Symbol">(</a><a id="1371" href="Definition.Modality.Context.html#1371" class="Bound">δ</a> <a id="1373" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1375" href="Definition.Modality.Context.html#1375" class="Bound">q</a><a id="1376" class="Symbol">)</a> <a id="1378" class="Symbol">=</a> <a id="1380" href="Definition.Modality.Context.html#1361" class="Bound">γ</a> <a id="1382" href="Definition.Modality.Context.html#1325" class="Function Operator">*</a> <a id="1384" href="Definition.Modality.Context.html#1371" class="Bound">δ</a> <a id="1386" href="Definition.Modality.html#684" class="Function Operator">+</a> <a id="1388" href="Definition.Modality.Context.html#1365" class="Bound">p</a> <a id="1390" href="Definition.Modality.html#712" class="Function Operator">·</a> <a id="1392" href="Definition.Modality.Context.html#1375" class="Bound">q</a>

<a id="1395" class="Comment">-- Addition lifted to modality contexts</a>

<a id="_+ᶜ_"></a><a id="1436" href="Definition.Modality.Context.html#1436" class="Function Operator">_+ᶜ_</a> <a id="1441" class="Symbol">:</a> <a id="1443" class="Symbol">(</a><a id="1444" href="Definition.Modality.Context.html#1444" class="Bound">γ</a> <a id="1446" href="Definition.Modality.Context.html#1446" class="Bound">δ</a> <a id="1448" class="Symbol">:</a> <a id="1450" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1455" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1456" class="Symbol">)</a> <a id="1458" class="Symbol">→</a> <a id="1460" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1465" href="Definition.Modality.Context.html#575" class="Generalizable">n</a>
<a id="1467" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1469" href="Definition.Modality.Context.html#1436" class="Function Operator">+ᶜ</a> <a id="1472" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1474" class="Symbol">=</a> <a id="1476" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a>
<a id="1478" class="Symbol">(</a><a id="1479" href="Definition.Modality.Context.html#1479" class="Bound">γ</a> <a id="1481" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1483" href="Definition.Modality.Context.html#1483" class="Bound">p</a><a id="1484" class="Symbol">)</a> <a id="1486" href="Definition.Modality.Context.html#1436" class="Function Operator">+ᶜ</a> <a id="1489" class="Symbol">(</a><a id="1490" href="Definition.Modality.Context.html#1490" class="Bound">δ</a> <a id="1492" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1494" href="Definition.Modality.Context.html#1494" class="Bound">q</a><a id="1495" class="Symbol">)</a> <a id="1497" class="Symbol">=</a> <a id="1499" class="Symbol">(</a><a id="1500" href="Definition.Modality.Context.html#1479" class="Bound">γ</a> <a id="1502" href="Definition.Modality.Context.html#1436" class="Function Operator">+ᶜ</a> <a id="1505" href="Definition.Modality.Context.html#1490" class="Bound">δ</a><a id="1506" class="Symbol">)</a> <a id="1508" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1510" class="Symbol">(</a><a id="1511" href="Definition.Modality.Context.html#1483" class="Bound">p</a> <a id="1513" href="Definition.Modality.html#684" class="Function Operator">+</a> <a id="1515" href="Definition.Modality.Context.html#1494" class="Bound">q</a><a id="1516" class="Symbol">)</a>

<a id="1519" class="Comment">-- Meet lifted to modality contexts</a>

<a id="_∧ᶜ_"></a><a id="1556" href="Definition.Modality.Context.html#1556" class="Function Operator">_∧ᶜ_</a> <a id="1561" class="Symbol">:</a> <a id="1563" class="Symbol">(</a><a id="1564" href="Definition.Modality.Context.html#1564" class="Bound">γ</a> <a id="1566" href="Definition.Modality.Context.html#1566" class="Bound">δ</a> <a id="1568" class="Symbol">:</a> <a id="1570" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1575" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1576" class="Symbol">)</a> <a id="1578" class="Symbol">→</a> <a id="1580" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1585" href="Definition.Modality.Context.html#575" class="Generalizable">n</a>
<a id="1587" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1589" href="Definition.Modality.Context.html#1556" class="Function Operator">∧ᶜ</a> <a id="1592" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1594" class="Symbol">=</a> <a id="1596" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a>
<a id="1598" class="Symbol">(</a><a id="1599" href="Definition.Modality.Context.html#1599" class="Bound">γ</a> <a id="1601" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1603" href="Definition.Modality.Context.html#1603" class="Bound">p</a><a id="1604" class="Symbol">)</a> <a id="1606" href="Definition.Modality.Context.html#1556" class="Function Operator">∧ᶜ</a> <a id="1609" class="Symbol">(</a><a id="1610" href="Definition.Modality.Context.html#1610" class="Bound">δ</a> <a id="1612" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1614" href="Definition.Modality.Context.html#1614" class="Bound">q</a><a id="1615" class="Symbol">)</a> <a id="1617" class="Symbol">=</a> <a id="1619" class="Symbol">(</a><a id="1620" href="Definition.Modality.Context.html#1599" class="Bound">γ</a> <a id="1622" href="Definition.Modality.Context.html#1556" class="Function Operator">∧ᶜ</a> <a id="1625" href="Definition.Modality.Context.html#1610" class="Bound">δ</a><a id="1626" class="Symbol">)</a> <a id="1628" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1630" class="Symbol">(</a><a id="1631" href="Definition.Modality.Context.html#1603" class="Bound">p</a> <a id="1633" href="Definition.Modality.html#746" class="Function Operator">∧</a> <a id="1635" href="Definition.Modality.Context.html#1614" class="Bound">q</a><a id="1636" class="Symbol">)</a>

<a id="1639" class="Comment">-- Modality context scaling</a>

<a id="_·ᶜ_"></a><a id="1668" href="Definition.Modality.Context.html#1668" class="Function Operator">_·ᶜ_</a> <a id="1673" class="Symbol">:</a> <a id="1675" class="Symbol">(</a><a id="1676" href="Definition.Modality.Context.html#1676" class="Bound">p</a> <a id="1678" class="Symbol">:</a> <a id="1680" href="Definition.Modality.Context.html#253" class="Bound">M</a><a id="1681" class="Symbol">)</a> <a id="1683" class="Symbol">(</a><a id="1684" href="Definition.Modality.Context.html#1684" class="Bound">γ</a> <a id="1686" class="Symbol">:</a> <a id="1688" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1693" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1694" class="Symbol">)</a> <a id="1696" class="Symbol">→</a> <a id="1698" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1703" href="Definition.Modality.Context.html#575" class="Generalizable">n</a>
<a id="1705" href="Definition.Modality.Context.html#1705" class="Bound">p</a> <a id="1707" href="Definition.Modality.Context.html#1668" class="Function Operator">·ᶜ</a> <a id="1710" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1712" class="Symbol">=</a> <a id="1714" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a>
<a id="1716" href="Definition.Modality.Context.html#1716" class="Bound">p</a> <a id="1718" href="Definition.Modality.Context.html#1668" class="Function Operator">·ᶜ</a> <a id="1721" class="Symbol">(</a><a id="1722" href="Definition.Modality.Context.html#1722" class="Bound">γ</a> <a id="1724" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1726" href="Definition.Modality.Context.html#1726" class="Bound">q</a><a id="1727" class="Symbol">)</a> <a id="1729" class="Symbol">=</a> <a id="1731" class="Symbol">(</a><a id="1732" href="Definition.Modality.Context.html#1716" class="Bound">p</a> <a id="1734" href="Definition.Modality.Context.html#1668" class="Function Operator">·ᶜ</a> <a id="1737" href="Definition.Modality.Context.html#1722" class="Bound">γ</a><a id="1738" class="Symbol">)</a> <a id="1740" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1742" class="Symbol">(</a><a id="1743" href="Definition.Modality.Context.html#1716" class="Bound">p</a> <a id="1745" href="Definition.Modality.html#712" class="Function Operator">·</a> <a id="1747" href="Definition.Modality.Context.html#1726" class="Bound">q</a><a id="1748" class="Symbol">)</a>

<a id="1751" class="Comment">-- Partial order of modality contexts</a>

<a id="_≤ᶜ_"></a><a id="1790" href="Definition.Modality.Context.html#1790" class="Function Operator">_≤ᶜ_</a> <a id="1795" class="Symbol">:</a> <a id="1797" class="Symbol">(</a><a id="1798" href="Definition.Modality.Context.html#1798" class="Bound">γ</a> <a id="1800" href="Definition.Modality.Context.html#1800" class="Bound">δ</a> <a id="1802" class="Symbol">:</a> <a id="1804" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1809" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1810" class="Symbol">)</a> <a id="1812" class="Symbol">→</a> <a id="1814" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1818" href="Definition.Modality.Context.html#249" class="Bound">a</a>
<a id="1820" href="Definition.Modality.Context.html#1820" class="Bound">γ</a> <a id="1822" href="Definition.Modality.Context.html#1790" class="Function Operator">≤ᶜ</a> <a id="1825" href="Definition.Modality.Context.html#1825" class="Bound">δ</a> <a id="1827" class="Symbol">=</a> <a id="1829" href="Definition.Modality.Context.html#1820" class="Bound">γ</a> <a id="1831" href="Definition.Modality.Context.html#769" class="Datatype Operator">≈ᶜ</a> <a id="1834" href="Definition.Modality.Context.html#1820" class="Bound">γ</a> <a id="1836" href="Definition.Modality.Context.html#1556" class="Function Operator">∧ᶜ</a> <a id="1839" href="Definition.Modality.Context.html#1825" class="Bound">δ</a>

<a id="1842" class="Comment">-- ⊛ lifted to modality contexts</a>

<a id="_⊛ᶜ_▷_"></a><a id="1876" href="Definition.Modality.Context.html#1876" class="Function Operator">_⊛ᶜ_▷_</a> <a id="1883" class="Symbol">:</a> <a id="1885" class="Symbol">(</a><a id="1886" href="Definition.Modality.Context.html#1886" class="Bound">γ</a> <a id="1888" href="Definition.Modality.Context.html#1888" class="Bound">δ</a> <a id="1890" class="Symbol">:</a> <a id="1892" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1897" href="Definition.Modality.Context.html#575" class="Generalizable">n</a><a id="1898" class="Symbol">)</a> <a id="1900" class="Symbol">(</a><a id="1901" href="Definition.Modality.Context.html#1901" class="Bound">r</a> <a id="1903" class="Symbol">:</a> <a id="1905" href="Definition.Modality.Context.html#253" class="Bound">M</a><a id="1906" class="Symbol">)</a> <a id="1908" class="Symbol">→</a> <a id="1910" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="1915" href="Definition.Modality.Context.html#575" class="Generalizable">n</a>
<a id="1917" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1919" href="Definition.Modality.Context.html#1876" class="Function Operator">⊛ᶜ</a> <a id="1922" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a> <a id="1924" href="Definition.Modality.Context.html#1876" class="Function Operator">▷</a> <a id="1926" href="Definition.Modality.Context.html#1926" class="Bound">r</a> <a id="1928" class="Symbol">=</a> <a id="1930" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a>
<a id="1932" class="Symbol">(</a><a id="1933" href="Definition.Modality.Context.html#1933" class="Bound">γ</a> <a id="1935" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1937" href="Definition.Modality.Context.html#1937" class="Bound">p</a><a id="1938" class="Symbol">)</a> <a id="1940" href="Definition.Modality.Context.html#1876" class="Function Operator">⊛ᶜ</a> <a id="1943" class="Symbol">(</a><a id="1944" href="Definition.Modality.Context.html#1944" class="Bound">δ</a> <a id="1946" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1948" href="Definition.Modality.Context.html#1948" class="Bound">q</a><a id="1949" class="Symbol">)</a> <a id="1951" href="Definition.Modality.Context.html#1876" class="Function Operator">▷</a> <a id="1953" href="Definition.Modality.Context.html#1953" class="Bound">r</a> <a id="1955" class="Symbol">=</a> <a id="1957" class="Symbol">(</a><a id="1958" href="Definition.Modality.Context.html#1933" class="Bound">γ</a> <a id="1960" href="Definition.Modality.Context.html#1876" class="Function Operator">⊛ᶜ</a> <a id="1963" href="Definition.Modality.Context.html#1944" class="Bound">δ</a> <a id="1965" href="Definition.Modality.Context.html#1876" class="Function Operator">▷</a> <a id="1967" href="Definition.Modality.Context.html#1953" class="Bound">r</a><a id="1968" class="Symbol">)</a> <a id="1970" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="1972" class="Symbol">(</a><a id="1973" href="Definition.Modality.Context.html#1937" class="Bound">p</a> <a id="1975" href="Definition.Modality.html#4047" class="Function Operator">⊛</a> <a id="1977" href="Definition.Modality.Context.html#1948" class="Bound">q</a> <a id="1979" href="Definition.Modality.html#4047" class="Function Operator">▷</a> <a id="1981" href="Definition.Modality.Context.html#1953" class="Bound">r</a><a id="1982" class="Symbol">)</a>

<a id="1985" class="Comment">-- Zero modality context</a>

<a id="𝟘ᶜ"></a><a id="2011" href="Definition.Modality.Context.html#2011" class="Function">𝟘ᶜ</a> <a id="2014" class="Symbol">:</a> <a id="2016" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="2021" href="Definition.Modality.Context.html#575" class="Generalizable">n</a>
<a id="2023" href="Definition.Modality.Context.html#2011" class="Function">𝟘ᶜ</a> <a id="2026" class="Symbol">{</a><a id="2027" class="Argument">n</a> <a id="2029" class="Symbol">=</a> <a id="2031" class="Number">0</a><a id="2032" class="Symbol">}</a>    <a id="2037" class="Symbol">=</a> <a id="2039" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a>
<a id="2041" href="Definition.Modality.Context.html#2011" class="Function">𝟘ᶜ</a> <a id="2044" class="Symbol">{</a><a id="2045" class="Argument">n</a> <a id="2047" class="Symbol">=</a> <a id="2049" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="2052" href="Definition.Modality.Context.html#2052" class="Bound">n</a><a id="2053" class="Symbol">}</a> <a id="2055" class="Symbol">=</a> <a id="2057" href="Definition.Modality.Context.html#2011" class="Function">𝟘ᶜ</a> <a id="2060" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="2062" href="Definition.Modality.html#807" class="Function">𝟘</a>

<a id="2065" class="Comment">-- Unit modality context</a>

<a id="𝟙ᶜ"></a><a id="2091" href="Definition.Modality.Context.html#2091" class="Function">𝟙ᶜ</a> <a id="2094" class="Symbol">:</a> <a id="2096" href="Definition.Modality.Context.html#627" class="Datatype">Conₘ</a> <a id="2101" href="Definition.Modality.Context.html#575" class="Generalizable">n</a>
<a id="2103" href="Definition.Modality.Context.html#2091" class="Function">𝟙ᶜ</a> <a id="2106" class="Symbol">{</a><a id="2107" class="Argument">n</a> <a id="2109" class="Symbol">=</a> <a id="2111" class="Number">0</a><a id="2112" class="Symbol">}</a>    <a id="2117" class="Symbol">=</a> <a id="2119" href="Definition.Modality.Context.html#654" class="InductiveConstructor">ε</a>
<a id="2121" href="Definition.Modality.Context.html#2091" class="Function">𝟙ᶜ</a> <a id="2124" class="Symbol">{</a><a id="2125" class="Argument">n</a> <a id="2127" class="Symbol">=</a> <a id="2129" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="2132" href="Definition.Modality.Context.html#2132" class="Bound">n</a><a id="2133" class="Symbol">}</a> <a id="2135" class="Symbol">=</a> <a id="2137" href="Definition.Modality.Context.html#2091" class="Function">𝟙ᶜ</a> <a id="2140" href="Definition.Modality.Context.html#669" class="InductiveConstructor Operator">∙</a> <a id="2142" href="Definition.Modality.html#817" class="Function">𝟙</a>
</pre></body></html>