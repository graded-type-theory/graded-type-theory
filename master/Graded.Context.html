<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Graded.Context</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Modality (grade) contexts.</a>
<a id="104" class="Comment">------------------------------------------------------------------------</a>

<a id="178" class="Keyword">import</a> <a id="185" href="Graded.Modality.html" class="Module">Graded.Modality</a>

<a id="202" class="Keyword">module</a> <a id="209" href="Graded.Context.html" class="Module">Graded.Context</a>
  <a id="226" class="Symbol">{</a><a id="227" href="Graded.Context.html#227" class="Bound">a</a><a id="228" class="Symbol">}</a> <a id="230" class="Symbol">{</a><a id="231" href="Graded.Context.html#231" class="Bound">M</a> <a id="233" class="Symbol">:</a> <a id="235" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="239" href="Graded.Context.html#227" class="Bound">a</a><a id="240" class="Symbol">}</a>
  <a id="244" class="Symbol">(</a><a id="245" class="Keyword">open</a> <a id="250" href="Graded.Modality.html" class="Module">Graded.Modality</a> <a id="266" href="Graded.Context.html#231" class="Bound">M</a><a id="267" class="Symbol">)</a>
  <a id="271" class="Symbol">(</a><a id="272" href="Graded.Context.html#272" class="Bound">𝕄</a> <a id="274" class="Symbol">:</a> <a id="276" href="Graded.Modality.html#5282" class="Record">Modality</a><a id="284" class="Symbol">)</a>
  <a id="288" class="Keyword">where</a>

<a id="295" class="Keyword">open</a> <a id="300" href="Graded.Modality.html#5282" class="Module">Modality</a> <a id="309" href="Graded.Context.html#272" class="Bound">𝕄</a>

<a id="312" class="Keyword">open</a> <a id="317" class="Keyword">import</a> <a id="324" href="Graded.Modality.Natrec-star-instances.html" class="Module">Graded.Modality.Natrec-star-instances</a>

<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Tools.Fin.html" class="Module">Tools.Fin</a>
<a id="385" class="Keyword">open</a> <a id="390" class="Keyword">import</a> <a id="397" href="Tools.Nat.html" class="Module">Tools.Nat</a> <a id="407" class="Keyword">using</a> <a id="413" class="Symbol">(</a><a id="414" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a><a id="417" class="Symbol">;</a> <a id="419" href="Tools.Nat.html#1071" class="InductiveConstructor">1+</a><a id="421" class="Symbol">)</a> <a id="423" class="Keyword">renaming</a> <a id="432" class="Symbol">(</a><a id="433" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+_</a> <a id="437" class="Symbol">to</a> <a id="440" class="Primitive Operator">_+ⁿ_</a><a id="444" class="Symbol">)</a>
<a id="446" class="Keyword">open</a> <a id="451" class="Keyword">import</a> <a id="458" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>

<a id="487" class="Keyword">infixl</a> <a id="494" class="Number">24</a> <a id="497" href="Graded.Context.html#743" class="InductiveConstructor Operator">_∙_</a>
<a id="501" class="Keyword">infixr</a> <a id="508" class="Number">40</a> <a id="511" href="Graded.Context.html#1510" class="Function Operator">_+ᶜ_</a>
<a id="516" class="Keyword">infixr</a> <a id="523" class="Number">40</a> <a id="526" href="Graded.Context.html#1630" class="Function Operator">_∧ᶜ_</a>
<a id="531" class="Keyword">infixr</a> <a id="538" class="Number">45</a> <a id="541" href="Graded.Context.html#1742" class="Function Operator">_·ᶜ_</a>
<a id="546" class="Keyword">infixr</a> <a id="553" class="Number">45</a> <a id="556" href="Graded.Context.html#1399" class="Function Operator">_*_</a>
<a id="560" class="Keyword">infix</a>  <a id="567" class="Number">50</a> <a id="570" href="Graded.Context.html#2022" class="Function Operator">_⊛ᶜ_▷_</a>
<a id="577" class="Keyword">infix</a>  <a id="584" class="Number">10</a> <a id="587" href="Graded.Context.html#1864" class="Function Operator">_≤ᶜ_</a>
<a id="592" class="Keyword">infix</a>  <a id="599" class="Number">35</a> <a id="602" href="Graded.Context.html#1116" class="Function Operator">_,_≔_</a>
<a id="608" class="Keyword">infix</a>  <a id="615" class="Number">60</a> <a id="618" href="Graded.Context.html#1271" class="Function Operator">_⟨_⟩</a>

<a id="624" class="Keyword">private</a>
  <a id="634" class="Keyword">variable</a>
    <a id="647" href="Graded.Context.html#647" class="Generalizable">m</a> <a id="649" href="Graded.Context.html#649" class="Generalizable">n</a> <a id="651" class="Symbol">:</a> <a id="653" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a>


<a id="659" class="Comment">-- Modality Contexts are snoc-lists</a>

<a id="696" class="Keyword">data</a> <a id="Conₘ"></a><a id="701" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="706" class="Symbol">:</a> <a id="708" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a> <a id="712" class="Symbol">→</a> <a id="714" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="718" href="Graded.Context.html#227" class="Bound">a</a> <a id="720" class="Keyword">where</a>
  <a id="Conₘ.ε"></a><a id="728" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>   <a id="732" class="Symbol">:</a> <a id="734" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="739" class="Number">0</a>
  <a id="Conₘ._∙_"></a><a id="743" href="Graded.Context.html#743" class="InductiveConstructor Operator">_∙_</a> <a id="747" class="Symbol">:</a> <a id="749" class="Symbol">(</a><a id="750" href="Graded.Context.html#750" class="Bound">γ</a> <a id="752" class="Symbol">:</a> <a id="754" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="759" href="Graded.Context.html#649" class="Generalizable">n</a><a id="760" class="Symbol">)</a> <a id="762" class="Symbol">→</a> <a id="764" class="Symbol">(</a><a id="765" href="Graded.Context.html#765" class="Bound">p</a> <a id="767" class="Symbol">:</a> <a id="769" href="Graded.Context.html#231" class="Bound">M</a><a id="770" class="Symbol">)</a> <a id="772" class="Symbol">→</a> <a id="774" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="779" class="Symbol">(</a><a id="780" href="Tools.Nat.html#1071" class="InductiveConstructor">1+</a> <a id="783" href="Graded.Context.html#649" class="Generalizable">n</a><a id="784" class="Symbol">)</a>

<a id="787" class="Comment">-- Modality equality lifted pointwise to contexts</a>

<a id="838" class="Keyword">data</a> <a id="_≈ᶜ_"></a><a id="843" href="Graded.Context.html#843" class="Datatype Operator">_≈ᶜ_</a> <a id="848" class="Symbol">:</a> <a id="850" class="Symbol">(</a><a id="851" href="Graded.Context.html#851" class="Bound">γ</a> <a id="853" href="Graded.Context.html#853" class="Bound">δ</a> <a id="855" class="Symbol">:</a> <a id="857" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="862" href="Graded.Context.html#649" class="Generalizable">n</a><a id="863" class="Symbol">)</a> <a id="865" class="Symbol">→</a> <a id="867" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="871" href="Graded.Context.html#227" class="Bound">a</a> <a id="873" class="Keyword">where</a>
  <a id="_≈ᶜ_.ε"></a><a id="881" href="Graded.Context.html#881" class="InductiveConstructor">ε</a> <a id="883" class="Symbol">:</a> <a id="885" href="Graded.Context.html#728" class="InductiveConstructor">ε</a> <a id="887" href="Graded.Context.html#843" class="Datatype Operator">≈ᶜ</a> <a id="890" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>
  <a id="_≈ᶜ_._∙_"></a><a id="894" href="Graded.Context.html#894" class="InductiveConstructor Operator">_∙_</a> <a id="898" class="Symbol">:</a> <a id="900" class="Symbol">{</a><a id="901" href="Graded.Context.html#901" class="Bound">γ</a> <a id="903" href="Graded.Context.html#903" class="Bound">δ</a> <a id="905" class="Symbol">:</a> <a id="907" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="912" href="Graded.Context.html#649" class="Generalizable">n</a><a id="913" class="Symbol">}</a> <a id="915" class="Symbol">{</a><a id="916" href="Graded.Context.html#916" class="Bound">p</a> <a id="918" href="Graded.Context.html#918" class="Bound">q</a> <a id="920" class="Symbol">:</a> <a id="922" href="Graded.Context.html#231" class="Bound">M</a><a id="923" class="Symbol">}</a> <a id="925" class="Symbol">→</a> <a id="927" href="Graded.Context.html#901" class="Bound">γ</a> <a id="929" href="Graded.Context.html#843" class="Datatype Operator">≈ᶜ</a> <a id="932" href="Graded.Context.html#903" class="Bound">δ</a> <a id="934" class="Symbol">→</a> <a id="936" href="Graded.Context.html#916" class="Bound">p</a> <a id="938" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="940" href="Graded.Context.html#918" class="Bound">q</a> <a id="942" class="Symbol">→</a> <a id="944" class="Symbol">(</a><a id="945" href="Graded.Context.html#901" class="Bound">γ</a> <a id="947" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="949" href="Graded.Context.html#916" class="Bound">p</a><a id="950" class="Symbol">)</a> <a id="952" href="Graded.Context.html#843" class="Datatype Operator">≈ᶜ</a> <a id="955" class="Symbol">(</a><a id="956" href="Graded.Context.html#903" class="Bound">δ</a> <a id="958" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="960" href="Graded.Context.html#918" class="Bound">q</a><a id="961" class="Symbol">)</a>


<a id="headₘ"></a><a id="965" href="Graded.Context.html#965" class="Function">headₘ</a> <a id="971" class="Symbol">:</a> <a id="973" class="Symbol">(</a><a id="974" href="Graded.Context.html#974" class="Bound">γ</a> <a id="976" class="Symbol">:</a> <a id="978" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="983" class="Symbol">(</a><a id="984" href="Tools.Nat.html#1071" class="InductiveConstructor">1+</a> <a id="987" href="Graded.Context.html#649" class="Generalizable">n</a><a id="988" class="Symbol">))</a> <a id="991" class="Symbol">→</a> <a id="993" href="Graded.Context.html#231" class="Bound">M</a>
<a id="995" href="Graded.Context.html#965" class="Function">headₘ</a> <a id="1001" class="Symbol">(</a><a id="1002" href="Graded.Context.html#1002" class="Bound">γ</a> <a id="1004" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1006" href="Graded.Context.html#1006" class="Bound">p</a><a id="1007" class="Symbol">)</a> <a id="1009" class="Symbol">=</a> <a id="1011" href="Graded.Context.html#1006" class="Bound">p</a>

<a id="tailₘ"></a><a id="1014" href="Graded.Context.html#1014" class="Function">tailₘ</a> <a id="1020" class="Symbol">:</a> <a id="1022" class="Symbol">(</a><a id="1023" href="Graded.Context.html#1023" class="Bound">γ</a> <a id="1025" class="Symbol">:</a> <a id="1027" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1032" class="Symbol">(</a><a id="1033" href="Tools.Nat.html#1071" class="InductiveConstructor">1+</a> <a id="1036" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1037" class="Symbol">))</a> <a id="1040" class="Symbol">→</a> <a id="1042" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1047" href="Graded.Context.html#649" class="Generalizable">n</a>
<a id="1049" href="Graded.Context.html#1014" class="Function">tailₘ</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Graded.Context.html#1056" class="Bound">γ</a> <a id="1058" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1060" href="Graded.Context.html#1060" class="Bound">p</a><a id="1061" class="Symbol">)</a> <a id="1063" class="Symbol">=</a> <a id="1065" href="Graded.Context.html#1056" class="Bound">γ</a>

<a id="1068" class="Comment">-- Update the value of an element in a context</a>

<a id="_,_≔_"></a><a id="1116" href="Graded.Context.html#1116" class="Function Operator">_,_≔_</a> <a id="1122" class="Symbol">:</a> <a id="1124" class="Symbol">(</a><a id="1125" href="Graded.Context.html#1125" class="Bound">γ</a> <a id="1127" class="Symbol">:</a> <a id="1129" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1134" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1135" class="Symbol">)</a> <a id="1137" class="Symbol">(</a><a id="1138" href="Graded.Context.html#1138" class="Bound">x</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1146" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1147" class="Symbol">)</a> <a id="1149" class="Symbol">(</a><a id="1150" href="Graded.Context.html#1150" class="Bound">p</a> <a id="1152" class="Symbol">:</a> <a id="1154" href="Graded.Context.html#231" class="Bound">M</a><a id="1155" class="Symbol">)</a> <a id="1157" class="Symbol">→</a> <a id="1159" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1164" href="Graded.Context.html#649" class="Generalizable">n</a>
<a id="1166" class="Symbol">(</a><a id="1167" href="Graded.Context.html#1167" class="Bound">γ</a> <a id="1169" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1171" href="Graded.Context.html#1171" class="Bound">q</a><a id="1172" class="Symbol">)</a> <a id="1174" href="Graded.Context.html#1116" class="Function Operator">,</a> <a id="1176" href="Data.Fin.Base.html#1148" class="InductiveConstructor">x0</a>     <a id="1183" href="Graded.Context.html#1116" class="Function Operator">≔</a> <a id="1185" href="Graded.Context.html#1185" class="Bound">p</a> <a id="1187" class="Symbol">=</a> <a id="1189" href="Graded.Context.html#1167" class="Bound">γ</a> <a id="1191" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1193" href="Graded.Context.html#1185" class="Bound">p</a>
<a id="1195" class="Symbol">(</a><a id="1196" href="Graded.Context.html#1196" class="Bound">γ</a> <a id="1198" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1200" href="Graded.Context.html#1200" class="Bound">q</a><a id="1201" class="Symbol">)</a> <a id="1203" href="Graded.Context.html#1116" class="Function Operator">,</a> <a id="1205" class="Symbol">(</a><a id="1206" href="Graded.Context.html#1206" class="Bound">x</a> <a id="1208" href="Data.Fin.Base.html#1179" class="InductiveConstructor Operator">+1</a><a id="1210" class="Symbol">)</a> <a id="1212" href="Graded.Context.html#1116" class="Function Operator">≔</a> <a id="1214" href="Graded.Context.html#1214" class="Bound">p</a> <a id="1216" class="Symbol">=</a> <a id="1218" class="Symbol">(</a><a id="1219" href="Graded.Context.html#1196" class="Bound">γ</a> <a id="1221" href="Graded.Context.html#1116" class="Function Operator">,</a> <a id="1223" href="Graded.Context.html#1206" class="Bound">x</a> <a id="1225" href="Graded.Context.html#1116" class="Function Operator">≔</a> <a id="1227" href="Graded.Context.html#1214" class="Bound">p</a><a id="1228" class="Symbol">)</a> <a id="1230" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1232" href="Graded.Context.html#1200" class="Bound">q</a>

<a id="1235" class="Comment">-- Look up an element in a context</a>

<a id="_⟨_⟩"></a><a id="1271" href="Graded.Context.html#1271" class="Function Operator">_⟨_⟩</a> <a id="1276" class="Symbol">:</a> <a id="1278" class="Symbol">(</a><a id="1279" href="Graded.Context.html#1279" class="Bound">γ</a> <a id="1281" class="Symbol">:</a> <a id="1283" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1288" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1289" class="Symbol">)</a> <a id="1291" class="Symbol">→</a> <a id="1293" class="Symbol">(</a><a id="1294" href="Graded.Context.html#1294" class="Bound">x</a> <a id="1296" class="Symbol">:</a> <a id="1298" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1302" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1303" class="Symbol">)</a> <a id="1305" class="Symbol">→</a> <a id="1307" href="Graded.Context.html#231" class="Bound">M</a>
<a id="1309" class="Symbol">(</a><a id="1310" href="Graded.Context.html#1310" class="Bound">γ</a> <a id="1312" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1314" href="Graded.Context.html#1314" class="Bound">p</a><a id="1315" class="Symbol">)</a> <a id="1317" href="Graded.Context.html#1271" class="Function Operator">⟨</a> <a id="1319" href="Data.Fin.Base.html#1148" class="InductiveConstructor">x0</a> <a id="1322" href="Graded.Context.html#1271" class="Function Operator">⟩</a>   <a id="1326" class="Symbol">=</a> <a id="1328" href="Graded.Context.html#1314" class="Bound">p</a>
<a id="1330" class="Symbol">(</a><a id="1331" href="Graded.Context.html#1331" class="Bound">γ</a> <a id="1333" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1335" href="Graded.Context.html#1335" class="Bound">p</a><a id="1336" class="Symbol">)</a> <a id="1338" href="Graded.Context.html#1271" class="Function Operator">⟨</a> <a id="1340" href="Graded.Context.html#1340" class="Bound">x</a> <a id="1342" href="Data.Fin.Base.html#1179" class="InductiveConstructor Operator">+1</a> <a id="1345" href="Graded.Context.html#1271" class="Function Operator">⟩</a> <a id="1347" class="Symbol">=</a> <a id="1349" href="Graded.Context.html#1331" class="Bound">γ</a> <a id="1351" href="Graded.Context.html#1271" class="Function Operator">⟨</a> <a id="1353" href="Graded.Context.html#1340" class="Bound">x</a> <a id="1355" href="Graded.Context.html#1271" class="Function Operator">⟩</a>


<a id="1359" class="Comment">-- Scalar product of modality contexts</a>

<a id="_*_"></a><a id="1399" href="Graded.Context.html#1399" class="Function Operator">_*_</a> <a id="1403" class="Symbol">:</a> <a id="1405" class="Symbol">(</a><a id="1406" href="Graded.Context.html#1406" class="Bound">γ</a> <a id="1408" href="Graded.Context.html#1408" class="Bound">δ</a> <a id="1410" class="Symbol">:</a> <a id="1412" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1417" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1418" class="Symbol">)</a> <a id="1420" class="Symbol">→</a> <a id="1422" href="Graded.Context.html#231" class="Bound">M</a>
<a id="1424" href="Graded.Context.html#728" class="InductiveConstructor">ε</a> <a id="1426" href="Graded.Context.html#1399" class="Function Operator">*</a> <a id="1428" href="Graded.Context.html#728" class="InductiveConstructor">ε</a> <a id="1430" class="Symbol">=</a> <a id="1432" href="Graded.Modality.html#836" class="Function">𝟘</a>
<a id="1434" class="Symbol">(</a><a id="1435" href="Graded.Context.html#1435" class="Bound">γ</a> <a id="1437" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1439" href="Graded.Context.html#1439" class="Bound">p</a><a id="1440" class="Symbol">)</a> <a id="1442" href="Graded.Context.html#1399" class="Function Operator">*</a> <a id="1444" class="Symbol">(</a><a id="1445" href="Graded.Context.html#1445" class="Bound">δ</a> <a id="1447" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1449" href="Graded.Context.html#1449" class="Bound">q</a><a id="1450" class="Symbol">)</a> <a id="1452" class="Symbol">=</a> <a id="1454" href="Graded.Context.html#1435" class="Bound">γ</a> <a id="1456" href="Graded.Context.html#1399" class="Function Operator">*</a> <a id="1458" href="Graded.Context.html#1445" class="Bound">δ</a> <a id="1460" href="Graded.Modality.html#713" class="Function Operator">+</a> <a id="1462" href="Graded.Context.html#1439" class="Bound">p</a> <a id="1464" href="Graded.Modality.html#741" class="Function Operator">·</a> <a id="1466" href="Graded.Context.html#1449" class="Bound">q</a>

<a id="1469" class="Comment">-- Addition lifted to modality contexts</a>

<a id="_+ᶜ_"></a><a id="1510" href="Graded.Context.html#1510" class="Function Operator">_+ᶜ_</a> <a id="1515" class="Symbol">:</a> <a id="1517" class="Symbol">(</a><a id="1518" href="Graded.Context.html#1518" class="Bound">γ</a> <a id="1520" href="Graded.Context.html#1520" class="Bound">δ</a> <a id="1522" class="Symbol">:</a> <a id="1524" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1529" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1530" class="Symbol">)</a> <a id="1532" class="Symbol">→</a> <a id="1534" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1539" href="Graded.Context.html#649" class="Generalizable">n</a>
<a id="1541" href="Graded.Context.html#728" class="InductiveConstructor">ε</a> <a id="1543" href="Graded.Context.html#1510" class="Function Operator">+ᶜ</a> <a id="1546" href="Graded.Context.html#728" class="InductiveConstructor">ε</a> <a id="1548" class="Symbol">=</a> <a id="1550" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>
<a id="1552" class="Symbol">(</a><a id="1553" href="Graded.Context.html#1553" class="Bound">γ</a> <a id="1555" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1557" href="Graded.Context.html#1557" class="Bound">p</a><a id="1558" class="Symbol">)</a> <a id="1560" href="Graded.Context.html#1510" class="Function Operator">+ᶜ</a> <a id="1563" class="Symbol">(</a><a id="1564" href="Graded.Context.html#1564" class="Bound">δ</a> <a id="1566" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1568" href="Graded.Context.html#1568" class="Bound">q</a><a id="1569" class="Symbol">)</a> <a id="1571" class="Symbol">=</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Graded.Context.html#1553" class="Bound">γ</a> <a id="1576" href="Graded.Context.html#1510" class="Function Operator">+ᶜ</a> <a id="1579" href="Graded.Context.html#1564" class="Bound">δ</a><a id="1580" class="Symbol">)</a> <a id="1582" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1584" class="Symbol">(</a><a id="1585" href="Graded.Context.html#1557" class="Bound">p</a> <a id="1587" href="Graded.Modality.html#713" class="Function Operator">+</a> <a id="1589" href="Graded.Context.html#1568" class="Bound">q</a><a id="1590" class="Symbol">)</a>

<a id="1593" class="Comment">-- Meet lifted to modality contexts</a>

<a id="_∧ᶜ_"></a><a id="1630" href="Graded.Context.html#1630" class="Function Operator">_∧ᶜ_</a> <a id="1635" class="Symbol">:</a> <a id="1637" class="Symbol">(</a><a id="1638" href="Graded.Context.html#1638" class="Bound">γ</a> <a id="1640" href="Graded.Context.html#1640" class="Bound">δ</a> <a id="1642" class="Symbol">:</a> <a id="1644" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1649" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1650" class="Symbol">)</a> <a id="1652" class="Symbol">→</a> <a id="1654" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1659" href="Graded.Context.html#649" class="Generalizable">n</a>
<a id="1661" href="Graded.Context.html#728" class="InductiveConstructor">ε</a> <a id="1663" href="Graded.Context.html#1630" class="Function Operator">∧ᶜ</a> <a id="1666" href="Graded.Context.html#728" class="InductiveConstructor">ε</a> <a id="1668" class="Symbol">=</a> <a id="1670" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>
<a id="1672" class="Symbol">(</a><a id="1673" href="Graded.Context.html#1673" class="Bound">γ</a> <a id="1675" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1677" href="Graded.Context.html#1677" class="Bound">p</a><a id="1678" class="Symbol">)</a> <a id="1680" href="Graded.Context.html#1630" class="Function Operator">∧ᶜ</a> <a id="1683" class="Symbol">(</a><a id="1684" href="Graded.Context.html#1684" class="Bound">δ</a> <a id="1686" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1688" href="Graded.Context.html#1688" class="Bound">q</a><a id="1689" class="Symbol">)</a> <a id="1691" class="Symbol">=</a> <a id="1693" class="Symbol">(</a><a id="1694" href="Graded.Context.html#1673" class="Bound">γ</a> <a id="1696" href="Graded.Context.html#1630" class="Function Operator">∧ᶜ</a> <a id="1699" href="Graded.Context.html#1684" class="Bound">δ</a><a id="1700" class="Symbol">)</a> <a id="1702" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1704" class="Symbol">(</a><a id="1705" href="Graded.Context.html#1677" class="Bound">p</a> <a id="1707" href="Graded.Modality.html#775" class="Function Operator">∧</a> <a id="1709" href="Graded.Context.html#1688" class="Bound">q</a><a id="1710" class="Symbol">)</a>

<a id="1713" class="Comment">-- Modality context scaling</a>

<a id="_·ᶜ_"></a><a id="1742" href="Graded.Context.html#1742" class="Function Operator">_·ᶜ_</a> <a id="1747" class="Symbol">:</a> <a id="1749" class="Symbol">(</a><a id="1750" href="Graded.Context.html#1750" class="Bound">p</a> <a id="1752" class="Symbol">:</a> <a id="1754" href="Graded.Context.html#231" class="Bound">M</a><a id="1755" class="Symbol">)</a> <a id="1757" class="Symbol">(</a><a id="1758" href="Graded.Context.html#1758" class="Bound">γ</a> <a id="1760" class="Symbol">:</a> <a id="1762" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1767" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1768" class="Symbol">)</a> <a id="1770" class="Symbol">→</a> <a id="1772" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1777" href="Graded.Context.html#649" class="Generalizable">n</a>
<a id="1779" href="Graded.Context.html#1779" class="Bound">p</a> <a id="1781" href="Graded.Context.html#1742" class="Function Operator">·ᶜ</a> <a id="1784" href="Graded.Context.html#728" class="InductiveConstructor">ε</a> <a id="1786" class="Symbol">=</a> <a id="1788" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>
<a id="1790" href="Graded.Context.html#1790" class="Bound">p</a> <a id="1792" href="Graded.Context.html#1742" class="Function Operator">·ᶜ</a> <a id="1795" class="Symbol">(</a><a id="1796" href="Graded.Context.html#1796" class="Bound">γ</a> <a id="1798" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1800" href="Graded.Context.html#1800" class="Bound">q</a><a id="1801" class="Symbol">)</a> <a id="1803" class="Symbol">=</a> <a id="1805" class="Symbol">(</a><a id="1806" href="Graded.Context.html#1790" class="Bound">p</a> <a id="1808" href="Graded.Context.html#1742" class="Function Operator">·ᶜ</a> <a id="1811" href="Graded.Context.html#1796" class="Bound">γ</a><a id="1812" class="Symbol">)</a> <a id="1814" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="1816" class="Symbol">(</a><a id="1817" href="Graded.Context.html#1790" class="Bound">p</a> <a id="1819" href="Graded.Modality.html#741" class="Function Operator">·</a> <a id="1821" href="Graded.Context.html#1800" class="Bound">q</a><a id="1822" class="Symbol">)</a>

<a id="1825" class="Comment">-- Partial order of modality contexts</a>

<a id="_≤ᶜ_"></a><a id="1864" href="Graded.Context.html#1864" class="Function Operator">_≤ᶜ_</a> <a id="1869" class="Symbol">:</a> <a id="1871" class="Symbol">(</a><a id="1872" href="Graded.Context.html#1872" class="Bound">γ</a> <a id="1874" href="Graded.Context.html#1874" class="Bound">δ</a> <a id="1876" class="Symbol">:</a> <a id="1878" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="1883" href="Graded.Context.html#649" class="Generalizable">n</a><a id="1884" class="Symbol">)</a> <a id="1886" class="Symbol">→</a> <a id="1888" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1892" href="Graded.Context.html#227" class="Bound">a</a>
<a id="1894" href="Graded.Context.html#1894" class="Bound">γ</a> <a id="1896" href="Graded.Context.html#1864" class="Function Operator">≤ᶜ</a> <a id="1899" href="Graded.Context.html#1899" class="Bound">δ</a> <a id="1901" class="Symbol">=</a> <a id="1903" href="Graded.Context.html#1894" class="Bound">γ</a> <a id="1905" href="Graded.Context.html#843" class="Datatype Operator">≈ᶜ</a> <a id="1908" href="Graded.Context.html#1894" class="Bound">γ</a> <a id="1910" href="Graded.Context.html#1630" class="Function Operator">∧ᶜ</a> <a id="1913" href="Graded.Context.html#1899" class="Bound">δ</a>

<a id="1916" class="Comment">-- Natrec-star operators can be lifted to usage contexts (the last</a>
<a id="1983" class="Comment">-- argument is still a single grade).</a>

<a id="_⊛ᶜ_▷_"></a><a id="2022" href="Graded.Context.html#2022" class="Function Operator">_⊛ᶜ_▷_</a> <a id="2029" class="Symbol">:</a>
  <a id="2033" class="Symbol">⦃</a> <a id="2035" href="Graded.Context.html#2035" class="Bound">has-star</a> <a id="2044" class="Symbol">:</a> <a id="2046" href="Graded.Modality.html#4079" class="Record">Has-star</a> <a id="2055" href="Graded.Modality.html#5395" class="Field">semiring-with-meet</a> <a id="2074" class="Symbol">⦄</a> <a id="2076" class="Symbol">→</a>
  <a id="2080" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="2085" href="Graded.Context.html#649" class="Generalizable">n</a> <a id="2087" class="Symbol">→</a> <a id="2089" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="2094" href="Graded.Context.html#649" class="Generalizable">n</a> <a id="2096" class="Symbol">→</a> <a id="2098" href="Graded.Context.html#231" class="Bound">M</a> <a id="2100" class="Symbol">→</a> <a id="2102" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="2107" href="Graded.Context.html#649" class="Generalizable">n</a>
<a id="2109" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>       <a id="2117" href="Graded.Context.html#2022" class="Function Operator">⊛ᶜ</a> <a id="2120" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>     <a id="2126" href="Graded.Context.html#2022" class="Function Operator">▷</a> <a id="2128" href="Graded.Context.html#2128" class="Bound">r</a> <a id="2130" class="Symbol">=</a> <a id="2132" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>
<a id="2134" class="Symbol">(</a><a id="2135" href="Graded.Context.html#2135" class="Bound">γ</a> <a id="2137" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="2139" href="Graded.Context.html#2139" class="Bound">p</a><a id="2140" class="Symbol">)</a> <a id="2142" href="Graded.Context.html#2022" class="Function Operator">⊛ᶜ</a> <a id="2145" href="Graded.Context.html#2145" class="Bound">δ</a> <a id="2147" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="2149" href="Graded.Context.html#2149" class="Bound">q</a> <a id="2151" href="Graded.Context.html#2022" class="Function Operator">▷</a> <a id="2153" href="Graded.Context.html#2153" class="Bound">r</a> <a id="2155" class="Symbol">=</a> <a id="2157" class="Symbol">(</a><a id="2158" href="Graded.Context.html#2135" class="Bound">γ</a> <a id="2160" href="Graded.Context.html#2022" class="Function Operator">⊛ᶜ</a> <a id="2163" href="Graded.Context.html#2145" class="Bound">δ</a> <a id="2165" href="Graded.Context.html#2022" class="Function Operator">▷</a> <a id="2167" href="Graded.Context.html#2153" class="Bound">r</a><a id="2168" class="Symbol">)</a> <a id="2170" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="2172" class="Symbol">(</a><a id="2173" href="Graded.Context.html#2139" class="Bound">p</a> <a id="2175" href="Graded.Modality.html#4219" class="Field Operator">⊛</a> <a id="2177" href="Graded.Context.html#2149" class="Bound">q</a> <a id="2179" href="Graded.Modality.html#4219" class="Field Operator">▷</a> <a id="2181" href="Graded.Context.html#2153" class="Bound">r</a><a id="2182" class="Symbol">)</a>

<a id="2185" class="Comment">-- Zero modality context</a>

<a id="𝟘ᶜ"></a><a id="2211" href="Graded.Context.html#2211" class="Function">𝟘ᶜ</a> <a id="2214" class="Symbol">:</a> <a id="2216" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="2221" href="Graded.Context.html#649" class="Generalizable">n</a>
<a id="2223" href="Graded.Context.html#2211" class="Function">𝟘ᶜ</a> <a id="2226" class="Symbol">{</a><a id="2227" class="Argument">n</a> <a id="2229" class="Symbol">=</a> <a id="2231" class="Number">0</a><a id="2232" class="Symbol">}</a>    <a id="2237" class="Symbol">=</a> <a id="2239" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>
<a id="2241" href="Graded.Context.html#2211" class="Function">𝟘ᶜ</a> <a id="2244" class="Symbol">{</a><a id="2245" class="Argument">n</a> <a id="2247" class="Symbol">=</a> <a id="2249" href="Tools.Nat.html#1071" class="InductiveConstructor">1+</a> <a id="2252" href="Graded.Context.html#2252" class="Bound">n</a><a id="2253" class="Symbol">}</a> <a id="2255" class="Symbol">=</a> <a id="2257" href="Graded.Context.html#2211" class="Function">𝟘ᶜ</a> <a id="2260" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="2262" href="Graded.Modality.html#836" class="Function">𝟘</a>

<a id="2265" class="Comment">-- Unit modality context</a>

<a id="𝟙ᶜ"></a><a id="2291" href="Graded.Context.html#2291" class="Function">𝟙ᶜ</a> <a id="2294" class="Symbol">:</a> <a id="2296" href="Graded.Context.html#701" class="Datatype">Conₘ</a> <a id="2301" href="Graded.Context.html#649" class="Generalizable">n</a>
<a id="2303" href="Graded.Context.html#2291" class="Function">𝟙ᶜ</a> <a id="2306" class="Symbol">{</a><a id="2307" class="Argument">n</a> <a id="2309" class="Symbol">=</a> <a id="2311" class="Number">0</a><a id="2312" class="Symbol">}</a>    <a id="2317" class="Symbol">=</a> <a id="2319" href="Graded.Context.html#728" class="InductiveConstructor">ε</a>
<a id="2321" href="Graded.Context.html#2291" class="Function">𝟙ᶜ</a> <a id="2324" class="Symbol">{</a><a id="2325" class="Argument">n</a> <a id="2327" class="Symbol">=</a> <a id="2329" href="Tools.Nat.html#1071" class="InductiveConstructor">1+</a> <a id="2332" href="Graded.Context.html#2332" class="Bound">n</a><a id="2333" class="Symbol">}</a> <a id="2335" class="Symbol">=</a> <a id="2337" href="Graded.Context.html#2291" class="Function">𝟙ᶜ</a> <a id="2340" href="Graded.Context.html#743" class="InductiveConstructor Operator">∙</a> <a id="2342" href="Graded.Modality.html#846" class="Function">𝟙</a>
</pre></body></html>