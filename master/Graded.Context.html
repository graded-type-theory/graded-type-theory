<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Graded.Context</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Modality (grade) contexts.</a>
<a id="104" class="Comment">------------------------------------------------------------------------</a>

<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Graded.Modality.html" class="Module">Graded.Modality</a>

<a id="207" class="Keyword">module</a> <a id="214" href="Graded.Context.html" class="Module">Graded.Context</a>
  <a id="231" class="Symbol">{</a><a id="232" href="Graded.Context.html#232" class="Bound">a</a><a id="233" class="Symbol">}</a> <a id="235" class="Symbol">{</a><a id="236" href="Graded.Context.html#236" class="Bound">M</a> <a id="238" class="Symbol">:</a> <a id="240" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="244" href="Graded.Context.html#232" class="Bound">a</a><a id="245" class="Symbol">}</a> <a id="247" class="Symbol">(</a><a id="248" href="Graded.Context.html#248" class="Bound">𝕄</a> <a id="250" class="Symbol">:</a> <a id="252" href="Graded.Modality.html#5274" class="Record">Modality</a> <a id="261" href="Graded.Context.html#236" class="Bound">M</a><a id="262" class="Symbol">)</a> <a id="264" class="Keyword">where</a>

<a id="271" class="Keyword">open</a> <a id="276" href="Graded.Modality.html#5274" class="Module">Modality</a> <a id="285" href="Graded.Context.html#248" class="Bound">𝕄</a>

<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Tools.Fin.html" class="Module">Tools.Fin</a>
<a id="310" class="Keyword">open</a> <a id="315" class="Keyword">import</a> <a id="322" href="Tools.Nat.html" class="Module">Tools.Nat</a> <a id="332" class="Keyword">using</a> <a id="338" class="Symbol">(</a><a id="339" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a><a id="342" class="Symbol">;</a> <a id="344" href="Tools.Nat.html#698" class="InductiveConstructor">1+</a><a id="346" class="Symbol">)</a> <a id="348" class="Keyword">renaming</a> <a id="357" class="Symbol">(</a><a id="358" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+_</a> <a id="362" class="Symbol">to</a> <a id="365" class="Primitive Operator">_+ⁿ_</a><a id="369" class="Symbol">)</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>

<a id="412" class="Keyword">infixl</a> <a id="419" class="Number">24</a> <a id="422" href="Graded.Context.html#668" class="InductiveConstructor Operator">_∙_</a>
<a id="426" class="Keyword">infixr</a> <a id="433" class="Number">40</a> <a id="436" href="Graded.Context.html#1435" class="Function Operator">_+ᶜ_</a>
<a id="441" class="Keyword">infixr</a> <a id="448" class="Number">40</a> <a id="451" href="Graded.Context.html#1555" class="Function Operator">_∧ᶜ_</a>
<a id="456" class="Keyword">infixr</a> <a id="463" class="Number">45</a> <a id="466" href="Graded.Context.html#1667" class="Function Operator">_·ᶜ_</a>
<a id="471" class="Keyword">infixr</a> <a id="478" class="Number">45</a> <a id="481" href="Graded.Context.html#1324" class="Function Operator">_*_</a>
<a id="485" class="Keyword">infix</a>  <a id="492" class="Number">50</a> <a id="495" href="Graded.Context.html#1875" class="Function Operator">_⊛ᶜ_▷_</a>
<a id="502" class="Keyword">infix</a>  <a id="509" class="Number">10</a> <a id="512" href="Graded.Context.html#1789" class="Function Operator">_≤ᶜ_</a>
<a id="517" class="Keyword">infix</a>  <a id="524" class="Number">35</a> <a id="527" href="Graded.Context.html#1041" class="Function Operator">_,_≔_</a>
<a id="533" class="Keyword">infix</a>  <a id="540" class="Number">60</a> <a id="543" href="Graded.Context.html#1196" class="Function Operator">_⟨_⟩</a>

<a id="549" class="Keyword">private</a>
  <a id="559" class="Keyword">variable</a>
    <a id="572" href="Graded.Context.html#572" class="Generalizable">m</a> <a id="574" href="Graded.Context.html#574" class="Generalizable">n</a> <a id="576" class="Symbol">:</a> <a id="578" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a>


<a id="584" class="Comment">-- Modality Contexts are snoc-lists</a>

<a id="621" class="Keyword">data</a> <a id="Conₘ"></a><a id="626" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="631" class="Symbol">:</a> <a id="633" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a> <a id="637" class="Symbol">→</a> <a id="639" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="643" href="Graded.Context.html#232" class="Bound">a</a> <a id="645" class="Keyword">where</a>
  <a id="Conₘ.ε"></a><a id="653" href="Graded.Context.html#653" class="InductiveConstructor">ε</a>   <a id="657" class="Symbol">:</a> <a id="659" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="664" class="Number">0</a>
  <a id="Conₘ._∙_"></a><a id="668" href="Graded.Context.html#668" class="InductiveConstructor Operator">_∙_</a> <a id="672" class="Symbol">:</a> <a id="674" class="Symbol">(</a><a id="675" href="Graded.Context.html#675" class="Bound">γ</a> <a id="677" class="Symbol">:</a> <a id="679" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="684" href="Graded.Context.html#574" class="Generalizable">n</a><a id="685" class="Symbol">)</a> <a id="687" class="Symbol">→</a> <a id="689" class="Symbol">(</a><a id="690" href="Graded.Context.html#690" class="Bound">p</a> <a id="692" class="Symbol">:</a> <a id="694" href="Graded.Context.html#236" class="Bound">M</a><a id="695" class="Symbol">)</a> <a id="697" class="Symbol">→</a> <a id="699" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="704" class="Symbol">(</a><a id="705" href="Tools.Nat.html#698" class="InductiveConstructor">1+</a> <a id="708" href="Graded.Context.html#574" class="Generalizable">n</a><a id="709" class="Symbol">)</a>

<a id="712" class="Comment">-- Modality equality lifted pointwise to contexts</a>

<a id="763" class="Keyword">data</a> <a id="_≈ᶜ_"></a><a id="768" href="Graded.Context.html#768" class="Datatype Operator">_≈ᶜ_</a> <a id="773" class="Symbol">:</a> <a id="775" class="Symbol">(</a><a id="776" href="Graded.Context.html#776" class="Bound">γ</a> <a id="778" href="Graded.Context.html#778" class="Bound">δ</a> <a id="780" class="Symbol">:</a> <a id="782" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="787" href="Graded.Context.html#574" class="Generalizable">n</a><a id="788" class="Symbol">)</a> <a id="790" class="Symbol">→</a> <a id="792" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="796" href="Graded.Context.html#232" class="Bound">a</a> <a id="798" class="Keyword">where</a>
  <a id="_≈ᶜ_.ε"></a><a id="806" href="Graded.Context.html#806" class="InductiveConstructor">ε</a> <a id="808" class="Symbol">:</a> <a id="810" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="812" href="Graded.Context.html#768" class="Datatype Operator">≈ᶜ</a> <a id="815" href="Graded.Context.html#653" class="InductiveConstructor">ε</a>
  <a id="_≈ᶜ_._∙_"></a><a id="819" href="Graded.Context.html#819" class="InductiveConstructor Operator">_∙_</a> <a id="823" class="Symbol">:</a> <a id="825" class="Symbol">{</a><a id="826" href="Graded.Context.html#826" class="Bound">γ</a> <a id="828" href="Graded.Context.html#828" class="Bound">δ</a> <a id="830" class="Symbol">:</a> <a id="832" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="837" href="Graded.Context.html#574" class="Generalizable">n</a><a id="838" class="Symbol">}</a> <a id="840" class="Symbol">{</a><a id="841" href="Graded.Context.html#841" class="Bound">p</a> <a id="843" href="Graded.Context.html#843" class="Bound">q</a> <a id="845" class="Symbol">:</a> <a id="847" href="Graded.Context.html#236" class="Bound">M</a><a id="848" class="Symbol">}</a> <a id="850" class="Symbol">→</a> <a id="852" href="Graded.Context.html#826" class="Bound">γ</a> <a id="854" href="Graded.Context.html#768" class="Datatype Operator">≈ᶜ</a> <a id="857" href="Graded.Context.html#828" class="Bound">δ</a> <a id="859" class="Symbol">→</a> <a id="861" href="Graded.Context.html#841" class="Bound">p</a> <a id="863" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="865" href="Graded.Context.html#843" class="Bound">q</a> <a id="867" class="Symbol">→</a> <a id="869" class="Symbol">(</a><a id="870" href="Graded.Context.html#826" class="Bound">γ</a> <a id="872" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="874" href="Graded.Context.html#841" class="Bound">p</a><a id="875" class="Symbol">)</a> <a id="877" href="Graded.Context.html#768" class="Datatype Operator">≈ᶜ</a> <a id="880" class="Symbol">(</a><a id="881" href="Graded.Context.html#828" class="Bound">δ</a> <a id="883" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="885" href="Graded.Context.html#843" class="Bound">q</a><a id="886" class="Symbol">)</a>


<a id="headₘ"></a><a id="890" href="Graded.Context.html#890" class="Function">headₘ</a> <a id="896" class="Symbol">:</a> <a id="898" class="Symbol">(</a><a id="899" href="Graded.Context.html#899" class="Bound">γ</a> <a id="901" class="Symbol">:</a> <a id="903" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="908" class="Symbol">(</a><a id="909" href="Tools.Nat.html#698" class="InductiveConstructor">1+</a> <a id="912" href="Graded.Context.html#574" class="Generalizable">n</a><a id="913" class="Symbol">))</a> <a id="916" class="Symbol">→</a> <a id="918" href="Graded.Context.html#236" class="Bound">M</a>
<a id="920" href="Graded.Context.html#890" class="Function">headₘ</a> <a id="926" class="Symbol">(</a><a id="927" href="Graded.Context.html#927" class="Bound">γ</a> <a id="929" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="931" href="Graded.Context.html#931" class="Bound">p</a><a id="932" class="Symbol">)</a> <a id="934" class="Symbol">=</a> <a id="936" href="Graded.Context.html#931" class="Bound">p</a>

<a id="tailₘ"></a><a id="939" href="Graded.Context.html#939" class="Function">tailₘ</a> <a id="945" class="Symbol">:</a> <a id="947" class="Symbol">(</a><a id="948" href="Graded.Context.html#948" class="Bound">γ</a> <a id="950" class="Symbol">:</a> <a id="952" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="957" class="Symbol">(</a><a id="958" href="Tools.Nat.html#698" class="InductiveConstructor">1+</a> <a id="961" href="Graded.Context.html#574" class="Generalizable">n</a><a id="962" class="Symbol">))</a> <a id="965" class="Symbol">→</a> <a id="967" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="972" href="Graded.Context.html#574" class="Generalizable">n</a>
<a id="974" href="Graded.Context.html#939" class="Function">tailₘ</a> <a id="980" class="Symbol">(</a><a id="981" href="Graded.Context.html#981" class="Bound">γ</a> <a id="983" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="985" href="Graded.Context.html#985" class="Bound">p</a><a id="986" class="Symbol">)</a> <a id="988" class="Symbol">=</a> <a id="990" href="Graded.Context.html#981" class="Bound">γ</a>

<a id="993" class="Comment">-- Update the value of an element in a context</a>

<a id="_,_≔_"></a><a id="1041" href="Graded.Context.html#1041" class="Function Operator">_,_≔_</a> <a id="1047" class="Symbol">:</a> <a id="1049" class="Symbol">(</a><a id="1050" href="Graded.Context.html#1050" class="Bound">γ</a> <a id="1052" class="Symbol">:</a> <a id="1054" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1059" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1060" class="Symbol">)</a> <a id="1062" class="Symbol">(</a><a id="1063" href="Graded.Context.html#1063" class="Bound">x</a> <a id="1065" class="Symbol">:</a> <a id="1067" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1071" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1072" class="Symbol">)</a> <a id="1074" class="Symbol">(</a><a id="1075" href="Graded.Context.html#1075" class="Bound">p</a> <a id="1077" class="Symbol">:</a> <a id="1079" href="Graded.Context.html#236" class="Bound">M</a><a id="1080" class="Symbol">)</a> <a id="1082" class="Symbol">→</a> <a id="1084" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1089" href="Graded.Context.html#574" class="Generalizable">n</a>
<a id="1091" class="Symbol">(</a><a id="1092" href="Graded.Context.html#1092" class="Bound">γ</a> <a id="1094" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1096" href="Graded.Context.html#1096" class="Bound">q</a><a id="1097" class="Symbol">)</a> <a id="1099" href="Graded.Context.html#1041" class="Function Operator">,</a> <a id="1101" href="Data.Fin.Base.html#1148" class="InductiveConstructor">x0</a>     <a id="1108" href="Graded.Context.html#1041" class="Function Operator">≔</a> <a id="1110" href="Graded.Context.html#1110" class="Bound">p</a> <a id="1112" class="Symbol">=</a> <a id="1114" href="Graded.Context.html#1092" class="Bound">γ</a> <a id="1116" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1118" href="Graded.Context.html#1110" class="Bound">p</a>
<a id="1120" class="Symbol">(</a><a id="1121" href="Graded.Context.html#1121" class="Bound">γ</a> <a id="1123" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1125" href="Graded.Context.html#1125" class="Bound">q</a><a id="1126" class="Symbol">)</a> <a id="1128" href="Graded.Context.html#1041" class="Function Operator">,</a> <a id="1130" class="Symbol">(</a><a id="1131" href="Graded.Context.html#1131" class="Bound">x</a> <a id="1133" href="Data.Fin.Base.html#1179" class="InductiveConstructor Operator">+1</a><a id="1135" class="Symbol">)</a> <a id="1137" href="Graded.Context.html#1041" class="Function Operator">≔</a> <a id="1139" href="Graded.Context.html#1139" class="Bound">p</a> <a id="1141" class="Symbol">=</a> <a id="1143" class="Symbol">(</a><a id="1144" href="Graded.Context.html#1121" class="Bound">γ</a> <a id="1146" href="Graded.Context.html#1041" class="Function Operator">,</a> <a id="1148" href="Graded.Context.html#1131" class="Bound">x</a> <a id="1150" href="Graded.Context.html#1041" class="Function Operator">≔</a> <a id="1152" href="Graded.Context.html#1139" class="Bound">p</a><a id="1153" class="Symbol">)</a> <a id="1155" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1157" href="Graded.Context.html#1125" class="Bound">q</a>

<a id="1160" class="Comment">-- Look up an element in a context</a>

<a id="_⟨_⟩"></a><a id="1196" href="Graded.Context.html#1196" class="Function Operator">_⟨_⟩</a> <a id="1201" class="Symbol">:</a> <a id="1203" class="Symbol">(</a><a id="1204" href="Graded.Context.html#1204" class="Bound">γ</a> <a id="1206" class="Symbol">:</a> <a id="1208" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1213" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1214" class="Symbol">)</a> <a id="1216" class="Symbol">→</a> <a id="1218" class="Symbol">(</a><a id="1219" href="Graded.Context.html#1219" class="Bound">x</a> <a id="1221" class="Symbol">:</a> <a id="1223" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a> <a id="1227" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1228" class="Symbol">)</a> <a id="1230" class="Symbol">→</a> <a id="1232" href="Graded.Context.html#236" class="Bound">M</a>
<a id="1234" class="Symbol">(</a><a id="1235" href="Graded.Context.html#1235" class="Bound">γ</a> <a id="1237" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1239" href="Graded.Context.html#1239" class="Bound">p</a><a id="1240" class="Symbol">)</a> <a id="1242" href="Graded.Context.html#1196" class="Function Operator">⟨</a> <a id="1244" href="Data.Fin.Base.html#1148" class="InductiveConstructor">x0</a> <a id="1247" href="Graded.Context.html#1196" class="Function Operator">⟩</a>   <a id="1251" class="Symbol">=</a> <a id="1253" href="Graded.Context.html#1239" class="Bound">p</a>
<a id="1255" class="Symbol">(</a><a id="1256" href="Graded.Context.html#1256" class="Bound">γ</a> <a id="1258" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1260" href="Graded.Context.html#1260" class="Bound">p</a><a id="1261" class="Symbol">)</a> <a id="1263" href="Graded.Context.html#1196" class="Function Operator">⟨</a> <a id="1265" href="Graded.Context.html#1265" class="Bound">x</a> <a id="1267" href="Data.Fin.Base.html#1179" class="InductiveConstructor Operator">+1</a> <a id="1270" href="Graded.Context.html#1196" class="Function Operator">⟩</a> <a id="1272" class="Symbol">=</a> <a id="1274" href="Graded.Context.html#1256" class="Bound">γ</a> <a id="1276" href="Graded.Context.html#1196" class="Function Operator">⟨</a> <a id="1278" href="Graded.Context.html#1265" class="Bound">x</a> <a id="1280" href="Graded.Context.html#1196" class="Function Operator">⟩</a>


<a id="1284" class="Comment">-- Scalar product of modality contexts</a>

<a id="_*_"></a><a id="1324" href="Graded.Context.html#1324" class="Function Operator">_*_</a> <a id="1328" class="Symbol">:</a> <a id="1330" class="Symbol">(</a><a id="1331" href="Graded.Context.html#1331" class="Bound">γ</a> <a id="1333" href="Graded.Context.html#1333" class="Bound">δ</a> <a id="1335" class="Symbol">:</a> <a id="1337" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1342" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1343" class="Symbol">)</a> <a id="1345" class="Symbol">→</a> <a id="1347" href="Graded.Context.html#236" class="Bound">M</a>
<a id="1349" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1351" href="Graded.Context.html#1324" class="Function Operator">*</a> <a id="1353" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1355" class="Symbol">=</a> <a id="1357" href="Graded.Modality.html#809" class="Function">𝟘</a>
<a id="1359" class="Symbol">(</a><a id="1360" href="Graded.Context.html#1360" class="Bound">γ</a> <a id="1362" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1364" href="Graded.Context.html#1364" class="Bound">p</a><a id="1365" class="Symbol">)</a> <a id="1367" href="Graded.Context.html#1324" class="Function Operator">*</a> <a id="1369" class="Symbol">(</a><a id="1370" href="Graded.Context.html#1370" class="Bound">δ</a> <a id="1372" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1374" href="Graded.Context.html#1374" class="Bound">q</a><a id="1375" class="Symbol">)</a> <a id="1377" class="Symbol">=</a> <a id="1379" href="Graded.Context.html#1360" class="Bound">γ</a> <a id="1381" href="Graded.Context.html#1324" class="Function Operator">*</a> <a id="1383" href="Graded.Context.html#1370" class="Bound">δ</a> <a id="1385" href="Graded.Modality.html#686" class="Function Operator">+</a> <a id="1387" href="Graded.Context.html#1364" class="Bound">p</a> <a id="1389" href="Graded.Modality.html#714" class="Function Operator">·</a> <a id="1391" href="Graded.Context.html#1374" class="Bound">q</a>

<a id="1394" class="Comment">-- Addition lifted to modality contexts</a>

<a id="_+ᶜ_"></a><a id="1435" href="Graded.Context.html#1435" class="Function Operator">_+ᶜ_</a> <a id="1440" class="Symbol">:</a> <a id="1442" class="Symbol">(</a><a id="1443" href="Graded.Context.html#1443" class="Bound">γ</a> <a id="1445" href="Graded.Context.html#1445" class="Bound">δ</a> <a id="1447" class="Symbol">:</a> <a id="1449" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1454" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1455" class="Symbol">)</a> <a id="1457" class="Symbol">→</a> <a id="1459" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1464" href="Graded.Context.html#574" class="Generalizable">n</a>
<a id="1466" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1468" href="Graded.Context.html#1435" class="Function Operator">+ᶜ</a> <a id="1471" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1473" class="Symbol">=</a> <a id="1475" href="Graded.Context.html#653" class="InductiveConstructor">ε</a>
<a id="1477" class="Symbol">(</a><a id="1478" href="Graded.Context.html#1478" class="Bound">γ</a> <a id="1480" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1482" href="Graded.Context.html#1482" class="Bound">p</a><a id="1483" class="Symbol">)</a> <a id="1485" href="Graded.Context.html#1435" class="Function Operator">+ᶜ</a> <a id="1488" class="Symbol">(</a><a id="1489" href="Graded.Context.html#1489" class="Bound">δ</a> <a id="1491" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1493" href="Graded.Context.html#1493" class="Bound">q</a><a id="1494" class="Symbol">)</a> <a id="1496" class="Symbol">=</a> <a id="1498" class="Symbol">(</a><a id="1499" href="Graded.Context.html#1478" class="Bound">γ</a> <a id="1501" href="Graded.Context.html#1435" class="Function Operator">+ᶜ</a> <a id="1504" href="Graded.Context.html#1489" class="Bound">δ</a><a id="1505" class="Symbol">)</a> <a id="1507" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1509" class="Symbol">(</a><a id="1510" href="Graded.Context.html#1482" class="Bound">p</a> <a id="1512" href="Graded.Modality.html#686" class="Function Operator">+</a> <a id="1514" href="Graded.Context.html#1493" class="Bound">q</a><a id="1515" class="Symbol">)</a>

<a id="1518" class="Comment">-- Meet lifted to modality contexts</a>

<a id="_∧ᶜ_"></a><a id="1555" href="Graded.Context.html#1555" class="Function Operator">_∧ᶜ_</a> <a id="1560" class="Symbol">:</a> <a id="1562" class="Symbol">(</a><a id="1563" href="Graded.Context.html#1563" class="Bound">γ</a> <a id="1565" href="Graded.Context.html#1565" class="Bound">δ</a> <a id="1567" class="Symbol">:</a> <a id="1569" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1574" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1575" class="Symbol">)</a> <a id="1577" class="Symbol">→</a> <a id="1579" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1584" href="Graded.Context.html#574" class="Generalizable">n</a>
<a id="1586" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1588" href="Graded.Context.html#1555" class="Function Operator">∧ᶜ</a> <a id="1591" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1593" class="Symbol">=</a> <a id="1595" href="Graded.Context.html#653" class="InductiveConstructor">ε</a>
<a id="1597" class="Symbol">(</a><a id="1598" href="Graded.Context.html#1598" class="Bound">γ</a> <a id="1600" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1602" href="Graded.Context.html#1602" class="Bound">p</a><a id="1603" class="Symbol">)</a> <a id="1605" href="Graded.Context.html#1555" class="Function Operator">∧ᶜ</a> <a id="1608" class="Symbol">(</a><a id="1609" href="Graded.Context.html#1609" class="Bound">δ</a> <a id="1611" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1613" href="Graded.Context.html#1613" class="Bound">q</a><a id="1614" class="Symbol">)</a> <a id="1616" class="Symbol">=</a> <a id="1618" class="Symbol">(</a><a id="1619" href="Graded.Context.html#1598" class="Bound">γ</a> <a id="1621" href="Graded.Context.html#1555" class="Function Operator">∧ᶜ</a> <a id="1624" href="Graded.Context.html#1609" class="Bound">δ</a><a id="1625" class="Symbol">)</a> <a id="1627" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1629" class="Symbol">(</a><a id="1630" href="Graded.Context.html#1602" class="Bound">p</a> <a id="1632" href="Graded.Modality.html#748" class="Function Operator">∧</a> <a id="1634" href="Graded.Context.html#1613" class="Bound">q</a><a id="1635" class="Symbol">)</a>

<a id="1638" class="Comment">-- Modality context scaling</a>

<a id="_·ᶜ_"></a><a id="1667" href="Graded.Context.html#1667" class="Function Operator">_·ᶜ_</a> <a id="1672" class="Symbol">:</a> <a id="1674" class="Symbol">(</a><a id="1675" href="Graded.Context.html#1675" class="Bound">p</a> <a id="1677" class="Symbol">:</a> <a id="1679" href="Graded.Context.html#236" class="Bound">M</a><a id="1680" class="Symbol">)</a> <a id="1682" class="Symbol">(</a><a id="1683" href="Graded.Context.html#1683" class="Bound">γ</a> <a id="1685" class="Symbol">:</a> <a id="1687" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1692" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1693" class="Symbol">)</a> <a id="1695" class="Symbol">→</a> <a id="1697" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1702" href="Graded.Context.html#574" class="Generalizable">n</a>
<a id="1704" href="Graded.Context.html#1704" class="Bound">p</a> <a id="1706" href="Graded.Context.html#1667" class="Function Operator">·ᶜ</a> <a id="1709" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1711" class="Symbol">=</a> <a id="1713" href="Graded.Context.html#653" class="InductiveConstructor">ε</a>
<a id="1715" href="Graded.Context.html#1715" class="Bound">p</a> <a id="1717" href="Graded.Context.html#1667" class="Function Operator">·ᶜ</a> <a id="1720" class="Symbol">(</a><a id="1721" href="Graded.Context.html#1721" class="Bound">γ</a> <a id="1723" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1725" href="Graded.Context.html#1725" class="Bound">q</a><a id="1726" class="Symbol">)</a> <a id="1728" class="Symbol">=</a> <a id="1730" class="Symbol">(</a><a id="1731" href="Graded.Context.html#1715" class="Bound">p</a> <a id="1733" href="Graded.Context.html#1667" class="Function Operator">·ᶜ</a> <a id="1736" href="Graded.Context.html#1721" class="Bound">γ</a><a id="1737" class="Symbol">)</a> <a id="1739" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1741" class="Symbol">(</a><a id="1742" href="Graded.Context.html#1715" class="Bound">p</a> <a id="1744" href="Graded.Modality.html#714" class="Function Operator">·</a> <a id="1746" href="Graded.Context.html#1725" class="Bound">q</a><a id="1747" class="Symbol">)</a>

<a id="1750" class="Comment">-- Partial order of modality contexts</a>

<a id="_≤ᶜ_"></a><a id="1789" href="Graded.Context.html#1789" class="Function Operator">_≤ᶜ_</a> <a id="1794" class="Symbol">:</a> <a id="1796" class="Symbol">(</a><a id="1797" href="Graded.Context.html#1797" class="Bound">γ</a> <a id="1799" href="Graded.Context.html#1799" class="Bound">δ</a> <a id="1801" class="Symbol">:</a> <a id="1803" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1808" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1809" class="Symbol">)</a> <a id="1811" class="Symbol">→</a> <a id="1813" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1817" href="Graded.Context.html#232" class="Bound">a</a>
<a id="1819" href="Graded.Context.html#1819" class="Bound">γ</a> <a id="1821" href="Graded.Context.html#1789" class="Function Operator">≤ᶜ</a> <a id="1824" href="Graded.Context.html#1824" class="Bound">δ</a> <a id="1826" class="Symbol">=</a> <a id="1828" href="Graded.Context.html#1819" class="Bound">γ</a> <a id="1830" href="Graded.Context.html#768" class="Datatype Operator">≈ᶜ</a> <a id="1833" href="Graded.Context.html#1819" class="Bound">γ</a> <a id="1835" href="Graded.Context.html#1555" class="Function Operator">∧ᶜ</a> <a id="1838" href="Graded.Context.html#1824" class="Bound">δ</a>

<a id="1841" class="Comment">-- ⊛ lifted to modality contexts</a>

<a id="_⊛ᶜ_▷_"></a><a id="1875" href="Graded.Context.html#1875" class="Function Operator">_⊛ᶜ_▷_</a> <a id="1882" class="Symbol">:</a> <a id="1884" class="Symbol">(</a><a id="1885" href="Graded.Context.html#1885" class="Bound">γ</a> <a id="1887" href="Graded.Context.html#1887" class="Bound">δ</a> <a id="1889" class="Symbol">:</a> <a id="1891" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1896" href="Graded.Context.html#574" class="Generalizable">n</a><a id="1897" class="Symbol">)</a> <a id="1899" class="Symbol">(</a><a id="1900" href="Graded.Context.html#1900" class="Bound">r</a> <a id="1902" class="Symbol">:</a> <a id="1904" href="Graded.Context.html#236" class="Bound">M</a><a id="1905" class="Symbol">)</a> <a id="1907" class="Symbol">→</a> <a id="1909" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="1914" href="Graded.Context.html#574" class="Generalizable">n</a>
<a id="1916" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1918" href="Graded.Context.html#1875" class="Function Operator">⊛ᶜ</a> <a id="1921" href="Graded.Context.html#653" class="InductiveConstructor">ε</a> <a id="1923" href="Graded.Context.html#1875" class="Function Operator">▷</a> <a id="1925" href="Graded.Context.html#1925" class="Bound">r</a> <a id="1927" class="Symbol">=</a> <a id="1929" href="Graded.Context.html#653" class="InductiveConstructor">ε</a>
<a id="1931" class="Symbol">(</a><a id="1932" href="Graded.Context.html#1932" class="Bound">γ</a> <a id="1934" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1936" href="Graded.Context.html#1936" class="Bound">p</a><a id="1937" class="Symbol">)</a> <a id="1939" href="Graded.Context.html#1875" class="Function Operator">⊛ᶜ</a> <a id="1942" class="Symbol">(</a><a id="1943" href="Graded.Context.html#1943" class="Bound">δ</a> <a id="1945" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1947" href="Graded.Context.html#1947" class="Bound">q</a><a id="1948" class="Symbol">)</a> <a id="1950" href="Graded.Context.html#1875" class="Function Operator">▷</a> <a id="1952" href="Graded.Context.html#1952" class="Bound">r</a> <a id="1954" class="Symbol">=</a> <a id="1956" class="Symbol">(</a><a id="1957" href="Graded.Context.html#1932" class="Bound">γ</a> <a id="1959" href="Graded.Context.html#1875" class="Function Operator">⊛ᶜ</a> <a id="1962" href="Graded.Context.html#1943" class="Bound">δ</a> <a id="1964" href="Graded.Context.html#1875" class="Function Operator">▷</a> <a id="1966" href="Graded.Context.html#1952" class="Bound">r</a><a id="1967" class="Symbol">)</a> <a id="1969" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="1971" class="Symbol">(</a><a id="1972" href="Graded.Context.html#1936" class="Bound">p</a> <a id="1974" href="Graded.Modality.html#4211" class="Function Operator">⊛</a> <a id="1976" href="Graded.Context.html#1947" class="Bound">q</a> <a id="1978" href="Graded.Modality.html#4211" class="Function Operator">▷</a> <a id="1980" href="Graded.Context.html#1952" class="Bound">r</a><a id="1981" class="Symbol">)</a>

<a id="1984" class="Comment">-- Zero modality context</a>

<a id="𝟘ᶜ"></a><a id="2010" href="Graded.Context.html#2010" class="Function">𝟘ᶜ</a> <a id="2013" class="Symbol">:</a> <a id="2015" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="2020" href="Graded.Context.html#574" class="Generalizable">n</a>
<a id="2022" href="Graded.Context.html#2010" class="Function">𝟘ᶜ</a> <a id="2025" class="Symbol">{</a><a id="2026" class="Argument">n</a> <a id="2028" class="Symbol">=</a> <a id="2030" class="Number">0</a><a id="2031" class="Symbol">}</a>    <a id="2036" class="Symbol">=</a> <a id="2038" href="Graded.Context.html#653" class="InductiveConstructor">ε</a>
<a id="2040" href="Graded.Context.html#2010" class="Function">𝟘ᶜ</a> <a id="2043" class="Symbol">{</a><a id="2044" class="Argument">n</a> <a id="2046" class="Symbol">=</a> <a id="2048" href="Tools.Nat.html#698" class="InductiveConstructor">1+</a> <a id="2051" href="Graded.Context.html#2051" class="Bound">n</a><a id="2052" class="Symbol">}</a> <a id="2054" class="Symbol">=</a> <a id="2056" href="Graded.Context.html#2010" class="Function">𝟘ᶜ</a> <a id="2059" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="2061" href="Graded.Modality.html#809" class="Function">𝟘</a>

<a id="2064" class="Comment">-- Unit modality context</a>

<a id="𝟙ᶜ"></a><a id="2090" href="Graded.Context.html#2090" class="Function">𝟙ᶜ</a> <a id="2093" class="Symbol">:</a> <a id="2095" href="Graded.Context.html#626" class="Datatype">Conₘ</a> <a id="2100" href="Graded.Context.html#574" class="Generalizable">n</a>
<a id="2102" href="Graded.Context.html#2090" class="Function">𝟙ᶜ</a> <a id="2105" class="Symbol">{</a><a id="2106" class="Argument">n</a> <a id="2108" class="Symbol">=</a> <a id="2110" class="Number">0</a><a id="2111" class="Symbol">}</a>    <a id="2116" class="Symbol">=</a> <a id="2118" href="Graded.Context.html#653" class="InductiveConstructor">ε</a>
<a id="2120" href="Graded.Context.html#2090" class="Function">𝟙ᶜ</a> <a id="2123" class="Symbol">{</a><a id="2124" class="Argument">n</a> <a id="2126" class="Symbol">=</a> <a id="2128" href="Tools.Nat.html#698" class="InductiveConstructor">1+</a> <a id="2131" href="Graded.Context.html#2131" class="Bound">n</a><a id="2132" class="Symbol">}</a> <a id="2134" class="Symbol">=</a> <a id="2136" href="Graded.Context.html#2090" class="Function">𝟙ᶜ</a> <a id="2139" href="Graded.Context.html#668" class="InductiveConstructor Operator">∙</a> <a id="2141" href="Graded.Modality.html#819" class="Function">𝟙</a>
</pre></body></html>