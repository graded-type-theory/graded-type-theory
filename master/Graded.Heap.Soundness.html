<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Graded.Heap.Soundness</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Resource-correctness of the heap semantics.</a>
<a id="121" class="Comment">------------------------------------------------------------------------</a>

<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Graded.Modality.html" class="Module">Graded.Modality</a>
<a id="223" class="Keyword">open</a> <a id="228" class="Keyword">import</a> <a id="235" href="Graded.Usage.Restrictions.html" class="Module">Graded.Usage.Restrictions</a>
<a id="261" class="Keyword">open</a> <a id="266" class="Keyword">import</a> <a id="273" href="Definition.Typed.Restrictions.html" class="Module">Definition.Typed.Restrictions</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Tools.Bool.html" class="Module">Tools.Bool</a>
<a id="326" class="Keyword">import</a> <a id="333" href="Graded.Heap.Bisimilarity.html" class="Module">Graded.Heap.Bisimilarity</a>

<a id="359" class="Keyword">module</a> <a id="366" href="Graded.Heap.Soundness.html" class="Module">Graded.Heap.Soundness</a>
  <a id="390" class="Symbol">{</a><a id="391" href="Graded.Heap.Soundness.html#391" class="Bound">a</a><a id="392" class="Symbol">}</a> <a id="394" class="Symbol">{</a><a id="395" href="Graded.Heap.Soundness.html#395" class="Bound">M</a> <a id="397" class="Symbol">:</a> <a id="399" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="403" href="Graded.Heap.Soundness.html#391" class="Bound">a</a><a id="404" class="Symbol">}</a> <a id="406" class="Symbol">{</a><a id="407" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a> <a id="409" class="Symbol">:</a> <a id="411" href="Graded.Modality.html#8058" class="Record">Modality</a> <a id="420" href="Graded.Heap.Soundness.html#395" class="Bound">M</a><a id="421" class="Symbol">}</a>
  <a id="425" class="Symbol">{</a><a id="426" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="429" class="Symbol">:</a> <a id="431" href="Graded.Usage.Restrictions.html#750" class="Record">Usage-restrictions</a> <a id="450" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a><a id="451" class="Symbol">}</a>
  <a id="455" class="Symbol">(</a><a id="456" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a> <a id="459" class="Symbol">:</a> <a id="461" href="Definition.Typed.Restrictions.html#752" class="Record">Type-restrictions</a> <a id="479" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a><a id="480" class="Symbol">)</a>
  <a id="484" class="Symbol">(</a><a id="485" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a> <a id="497" class="Symbol">:</a> <a id="499" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="503" class="Symbol">)</a>
  <a id="507" class="Symbol">(</a><a id="508" class="Keyword">open</a> <a id="513" href="Graded.Heap.Bisimilarity.html" class="Module">Graded.Heap.Bisimilarity</a> <a id="538" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="541" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a> <a id="544" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a><a id="555" class="Symbol">)</a>
  <a id="559" class="Symbol">(</a><a id="560" href="Graded.Heap.Soundness.html#560" class="Bound">As</a> <a id="563" class="Symbol">:</a> <a id="565" href="Graded.Heap.Bisimilarity.html#1861" class="Record">Assumptions</a><a id="576" class="Symbol">)</a>
  <a id="580" class="Keyword">where</a>

<a id="587" class="Keyword">open</a> <a id="592" href="Definition.Typed.Restrictions.html#752" class="Module">Type-restrictions</a> <a id="610" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>
<a id="613" class="Keyword">open</a> <a id="618" href="Graded.Usage.Restrictions.html#750" class="Module">Usage-restrictions</a> <a id="637" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a>
<a id="640" class="Keyword">open</a> <a id="645" href="Graded.Modality.html#8058" class="Module">Modality</a> <a id="654" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a>
<a id="656" class="Keyword">open</a> <a id="661" href="Graded.Heap.Bisimilarity.html#1861" class="Module">Assumptions</a> <a id="673" href="Graded.Heap.Soundness.html#560" class="Bound">As</a>

<a id="677" class="Keyword">open</a> <a id="682" class="Keyword">import</a> <a id="689" href="Tools.Empty.html" class="Module">Tools.Empty</a>
<a id="701" class="Keyword">open</a> <a id="706" class="Keyword">import</a> <a id="713" href="Tools.Function.html" class="Module">Tools.Function</a>
<a id="728" class="Keyword">open</a> <a id="733" class="Keyword">import</a> <a id="740" href="Tools.Nat.html" class="Module">Tools.Nat</a>
<a id="750" class="Keyword">open</a> <a id="755" class="Keyword">import</a> <a id="762" href="Tools.Product.html" class="Module">Tools.Product</a>
<a id="776" class="Keyword">import</a> <a id="783" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a> <a id="811" class="Symbol">as</a> <a id="814" class="Module">PE</a>
<a id="817" class="Keyword">open</a> <a id="822" class="Keyword">import</a> <a id="829" href="Tools.Relation.html" class="Module">Tools.Relation</a>
<a id="844" class="Keyword">import</a> <a id="851" href="Tools.Reasoning.PartialOrder.html" class="Module">Tools.Reasoning.PartialOrder</a> <a id="880" class="Symbol">as</a> <a id="883" class="Module">RPo</a>
<a id="887" class="Keyword">open</a> <a id="892" class="Keyword">import</a> <a id="899" href="Tools.Sum.html" class="Module">Tools.Sum</a> <a id="909" class="Keyword">hiding</a> <a id="916" class="Symbol">(</a><a id="917" href="Tools.Sum.html#315" class="Function">id</a><a id="919" class="Symbol">;</a> <a id="921" href="Tools.Sum.html#397" class="Function">sym</a><a id="924" class="Symbol">)</a>

<a id="927" class="Keyword">open</a> <a id="932" class="Keyword">import</a> <a id="939" href="Definition.Untyped.html" class="Module">Definition.Untyped</a> <a id="958" href="Graded.Heap.Soundness.html#395" class="Bound">M</a>
<a id="960" class="Keyword">open</a> <a id="965" class="Keyword">import</a> <a id="972" href="Definition.Untyped.Neutral.html" class="Module">Definition.Untyped.Neutral</a> <a id="999" href="Graded.Heap.Soundness.html#395" class="Bound">M</a> <a id="1001" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a>
<a id="1014" class="Keyword">open</a> <a id="1019" class="Keyword">import</a> <a id="1026" href="Definition.Untyped.Inversion.html" class="Module">Definition.Untyped.Inversion</a> <a id="1055" href="Graded.Heap.Soundness.html#395" class="Bound">M</a>
<a id="1057" class="Keyword">open</a> <a id="1062" class="Keyword">import</a> <a id="1069" href="Definition.Untyped.Properties.html" class="Module">Definition.Untyped.Properties</a> <a id="1099" href="Graded.Heap.Soundness.html#395" class="Bound">M</a>
<a id="1101" class="Keyword">open</a> <a id="1106" class="Keyword">import</a> <a id="1113" href="Definition.Typed.html" class="Module">Definition.Typed</a> <a id="1130" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>
<a id="1133" class="Keyword">open</a> <a id="1138" class="Keyword">import</a> <a id="1145" href="Definition.Typed.Consequences.Canonicity.html" class="Module">Definition.Typed.Consequences.Canonicity</a> <a id="1186" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>
<a id="1189" class="Keyword">open</a> <a id="1194" class="Keyword">import</a> <a id="1201" href="Definition.Typed.Consequences.Inversion.html" class="Module">Definition.Typed.Consequences.Inversion</a> <a id="1241" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>
<a id="1244" class="Keyword">open</a> <a id="1249" class="Keyword">import</a> <a id="1256" href="Definition.Typed.EqRelInstance.html" class="Module">Definition.Typed.EqRelInstance</a> <a id="1287" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>
<a id="1290" class="Keyword">open</a> <a id="1295" class="Keyword">import</a> <a id="1302" href="Definition.LogicalRelation.html" class="Module">Definition.LogicalRelation</a> <a id="1329" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>
<a id="1332" class="Keyword">open</a> <a id="1337" class="Keyword">import</a> <a id="1344" href="Definition.LogicalRelation.Fundamental.Reducibility.html" class="Module">Definition.LogicalRelation.Fundamental.Reducibility</a> <a id="1396" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>
<a id="1399" class="Keyword">open</a> <a id="1404" class="Keyword">import</a> <a id="1411" href="Definition.LogicalRelation.Substitution.Introductions.Nat.html" class="Module">Definition.LogicalRelation.Substitution.Introductions.Nat</a> <a id="1469" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>

<a id="1473" class="Keyword">open</a> <a id="1478" class="Keyword">import</a> <a id="1485" href="Graded.Context.html" class="Module">Graded.Context</a> <a id="1500" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a>
<a id="1502" class="Keyword">open</a> <a id="1507" class="Keyword">import</a> <a id="1514" href="Graded.Context.Properties.html" class="Module">Graded.Context.Properties</a> <a id="1540" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a>
<a id="1542" class="Keyword">open</a> <a id="1547" class="Keyword">import</a> <a id="1554" href="Graded.Context.Weakening.html" class="Module">Graded.Context.Weakening</a> <a id="1579" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a>
<a id="1581" class="Keyword">open</a> <a id="1586" class="Keyword">import</a> <a id="1593" href="Graded.Mode.html" class="Module">Graded.Mode</a> <a id="1605" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a>
<a id="1607" class="Keyword">open</a> <a id="1612" class="Keyword">import</a> <a id="1619" href="Graded.Usage.html" class="Module">Graded.Usage</a> <a id="1632" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a> <a id="1634" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a>
<a id="1637" class="Keyword">open</a> <a id="1642" class="Keyword">import</a> <a id="1649" href="Graded.Usage.Inversion.html" class="Module">Graded.Usage.Inversion</a> <a id="1672" href="Graded.Heap.Soundness.html#407" class="Bound">𝕄</a> <a id="1674" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a>

<a id="1678" class="Keyword">open</a> <a id="1683" class="Keyword">import</a> <a id="1690" href="Graded.Heap.Options.html" class="Module">Graded.Heap.Options</a>
<a id="1710" class="Keyword">open</a> <a id="1715" class="Keyword">import</a> <a id="1722" href="Graded.Heap.Untyped.html" class="Module">Graded.Heap.Untyped</a> <a id="1742" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a> <a id="1755" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a>
<a id="1758" class="Keyword">open</a> <a id="1763" class="Keyword">import</a> <a id="1770" href="Graded.Heap.Untyped.Properties.html" class="Module">Graded.Heap.Untyped.Properties</a> <a id="1801" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a> <a id="1814" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a>
<a id="1817" class="Keyword">open</a> <a id="1822" class="Keyword">import</a> <a id="1829" href="Graded.Heap.Usage.html" class="Module">Graded.Heap.Usage</a> <a id="1847" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a> <a id="1860" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="1863" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a>
<a id="1875" class="Keyword">open</a> <a id="1880" class="Keyword">import</a> <a id="1887" href="Graded.Heap.Usage.Properties.html" class="Module">Graded.Heap.Usage.Properties</a> <a id="1916" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a> <a id="1929" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="1932" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a>
<a id="1944" class="Keyword">import</a> <a id="1951" href="Graded.Heap.Usage.Reduction.html" class="Module">Graded.Heap.Usage.Reduction</a> <a id="1979" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a> <a id="1992" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="1995" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a> <a id="2007" class="Symbol">(</a><a id="2008" href="Graded.Heap.Options.html#1439" class="Function">tracking-and-ℕ-fullred-if</a> <a id="2034" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="2039" class="Symbol">)</a> <a id="2041" href="Graded.Heap.Bisimilarity.html#2022" class="Field">Unitʷ-η→</a> <a id="2050" class="Symbol">as</a> <a id="URᶠ"></a><a id="2053" href="Graded.Heap.Soundness.html#2053" class="Module">URᶠ</a>
<a id="2057" class="Keyword">import</a> <a id="2064" href="Graded.Heap.Usage.Reduction.html" class="Module">Graded.Heap.Usage.Reduction</a> <a id="2092" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a> <a id="2105" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2108" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a> <a id="2120" class="Symbol">(</a><a id="2121" href="Graded.Heap.Options.html#1439" class="Function">tracking-and-ℕ-fullred-if</a> <a id="2147" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="2151" class="Symbol">)</a> <a id="2153" href="Graded.Heap.Bisimilarity.html#2022" class="Field">Unitʷ-η→</a> <a id="2162" class="Symbol">as</a> <a id="URᵗ"></a><a id="2165" href="Graded.Heap.Soundness.html#2165" class="Module">URᵗ</a>
<a id="2169" class="Keyword">open</a> <a id="2174" class="Keyword">import</a> <a id="2181" href="Graded.Heap.Termination.html" class="Module">Graded.Heap.Termination</a> <a id="2205" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2208" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a> <a id="2211" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a> <a id="2223" href="Graded.Heap.Soundness.html#560" class="Bound">As</a>
<a id="2226" class="Keyword">open</a> <a id="2231" class="Keyword">import</a> <a id="2238" href="Graded.Heap.Typed.html" class="Module">Graded.Heap.Typed</a> <a id="2256" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2259" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a> <a id="2262" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="2268" class="Keyword">import</a> <a id="2275" href="Graded.Heap.Typed.html" class="Module">Graded.Heap.Typed</a> <a id="2293" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2296" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a> <a id="2299" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="2304" class="Symbol">as</a> <a id="HTₜ"></a><a id="2307" href="Graded.Heap.Soundness.html#2307" class="Module">HTₜ</a>
<a id="2311" class="Keyword">open</a> <a id="2316" class="Keyword">import</a> <a id="2323" href="Graded.Heap.Typed.Reduction.html" class="Module">Graded.Heap.Typed.Reduction</a> <a id="2351" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2354" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a> <a id="2357" class="Symbol">(</a><a id="2358" href="Graded.Heap.Options.html#1439" class="Function">tracking-and-ℕ-fullred-if</a> <a id="2384" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="2389" class="Symbol">)</a> <a id="2391" class="Keyword">hiding</a> <a id="2398" class="Symbol">(</a><a id="2399" href="Graded.Heap.Typed.Reduction.html#28320" class="Function">⇒*→≡</a><a id="2403" class="Symbol">)</a>
<a id="2405" class="Keyword">open</a> <a id="2410" class="Keyword">import</a> <a id="2417" href="Graded.Heap.Typed.Reduction.html" class="Module">Graded.Heap.Typed.Reduction</a> <a id="2445" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2448" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a> <a id="2451" class="Symbol">(</a><a id="2452" href="Graded.Heap.Options.html#1439" class="Function">tracking-and-ℕ-fullred-if</a> <a id="2478" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="2482" class="Symbol">)</a> <a id="2484" class="Keyword">using</a> <a id="2490" class="Symbol">(</a><a id="2491" href="Graded.Heap.Typed.Reduction.html#28320" class="Function">⇒*→≡</a><a id="2495" class="Symbol">)</a>
<a id="2497" class="Keyword">open</a> <a id="2502" class="Keyword">import</a> <a id="2509" href="Graded.Heap.Typed.Properties.html" class="Module">Graded.Heap.Typed.Properties</a> <a id="2538" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2541" href="Graded.Heap.Soundness.html#456" class="Bound">TR</a>
<a id="2544" class="Keyword">open</a> <a id="2549" class="Keyword">import</a> <a id="2556" href="Graded.Heap.Reduction.html" class="Module">Graded.Heap.Reduction</a> <a id="2578" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a> <a id="2591" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2594" class="Symbol">(</a><a id="2595" href="Graded.Heap.Options.html#1439" class="Function">tracking-and-ℕ-fullred-if</a> <a id="2621" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="2625" class="Symbol">)</a>
<a id="2627" class="Keyword">open</a> <a id="2632" class="Keyword">import</a> <a id="2639" href="Graded.Heap.Reduction.Properties.html" class="Module">Graded.Heap.Reduction.Properties</a> <a id="2672" href="Definition.Typed.Restrictions.html#876" class="Function">type-variant</a> <a id="2685" href="Graded.Heap.Soundness.html#426" class="Bound">UR</a> <a id="2688" class="Symbol">(</a><a id="2689" href="Graded.Heap.Options.html#1439" class="Function">tracking-and-ℕ-fullred-if</a> <a id="2715" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="2719" class="Symbol">)</a>
  <a id="2723" class="Keyword">using</a> <a id="2729" class="Symbol">(</a><a id="2730" href="Graded.Heap.Reduction.Properties.html#1410" class="Function Operator">_⇨*_</a><a id="2734" class="Symbol">;</a> <a id="2736" href="Graded.Heap.Reduction.Properties.html#12793" class="Function">++sucₛ-⇒*</a><a id="2745" class="Symbol">)</a>


<a id="2749" class="Keyword">private</a> <a id="2757" class="Keyword">variable</a>
  <a id="2768" href="Graded.Heap.Soundness.html#2768" class="Generalizable">k</a> <a id="2770" class="Symbol">:</a> <a id="2772" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
  <a id="2778" href="Graded.Heap.Soundness.html#2778" class="Generalizable">n</a> <a id="2780" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="2782" href="Graded.Heap.Soundness.html#2782" class="Generalizable">A</a> <a id="2784" class="Symbol">:</a> <a id="2786" href="Definition.Untyped.html#1160" class="Datatype">Term</a> <a id="2791" class="Symbol">_</a>
  <a id="2795" href="Graded.Heap.Soundness.html#2795" class="Generalizable">s</a> <a id="2797" class="Symbol">:</a> <a id="2799" href="Graded.Heap.Untyped.html#8799" class="Record">State</a> <a id="2805" class="Symbol">_</a> <a id="2807" class="Symbol">_</a> <a id="2809" class="Symbol">_</a>
  <a id="2813" href="Graded.Heap.Soundness.html#2813" class="Generalizable">γ</a> <a id="2815" href="Graded.Heap.Soundness.html#2815" class="Generalizable">δ</a> <a id="2817" href="Graded.Heap.Soundness.html#2817" class="Generalizable">η</a> <a id="2819" class="Symbol">:</a> <a id="2821" href="Graded.Context.html#692" class="Datatype">Conₘ</a> <a id="2826" class="Symbol">_</a>
  <a id="2830" href="Graded.Heap.Soundness.html#2830" class="Generalizable">Γ</a> <a id="2832" href="Graded.Heap.Soundness.html#2832" class="Generalizable">Δ</a> <a id="2834" class="Symbol">:</a> <a id="2836" href="Definition.Untyped.NotParametrised.html#882" class="Datatype">Con</a> <a id="2840" href="Definition.Untyped.html#1160" class="Datatype">Term</a> <a id="2845" class="Symbol">_</a>
  <a id="2849" href="Graded.Heap.Soundness.html#2849" class="Generalizable">H</a> <a id="2851" class="Symbol">:</a> <a id="2853" href="Graded.Heap.Untyped.html#5863" class="Datatype">Heap</a> <a id="2858" class="Symbol">_</a> <a id="2860" class="Symbol">_</a>
  <a id="2864" href="Graded.Heap.Soundness.html#2864" class="Generalizable">ρ</a> <a id="2866" class="Symbol">:</a> <a id="2868" href="Definition.Untyped.NotParametrised.html#2601" class="Datatype">Wk</a> <a id="2871" class="Symbol">_</a> <a id="2873" class="Symbol">_</a>
  <a id="2877" href="Graded.Heap.Soundness.html#2877" class="Generalizable">S</a> <a id="2879" class="Symbol">:</a> <a id="2881" href="Graded.Heap.Untyped.html#4594" class="Datatype">Stack</a> <a id="2887" class="Symbol">_</a>
  <a id="2891" href="Graded.Heap.Soundness.html#2891" class="Generalizable">m</a> <a id="2893" class="Symbol">:</a> <a id="2895" href="Graded.Mode.html#1062" class="Datatype">Mode</a>

<a id="2901" class="Keyword">opaque</a>

  <a id="2911" class="Comment">-- All well-typed and well-resourced states of type ℕ reduce to numerals</a>

  <a id="redNumeral"></a><a id="2987" href="Graded.Heap.Soundness.html#2987" class="Function">redNumeral</a> <a id="2998" class="Symbol">:</a> <a id="3000" class="Symbol">(</a><a id="3001" href="Graded.Usage.Restrictions.html#1638" class="Function">Emptyrec-allowed</a> <a id="3018" class="InductiveConstructor">𝟙ᵐ</a> <a id="3021" href="Graded.Modality.html#897" class="Function">𝟘</a> <a id="3023" class="Symbol">→</a> <a id="3025" href="Definition.Typed.html#21867" class="Function">Consistent</a> <a id="3036" href="Graded.Heap.Soundness.html#2832" class="Generalizable">Δ</a><a id="3037" class="Symbol">)</a>
             <a id="3052" class="Symbol">→</a> <a id="3054" href="Graded.Heap.Soundness.html#2832" class="Generalizable">Δ</a> <a id="3056" href="Definition.LogicalRelation.html#2903" class="Record Operator">⊩ℕ</a> <a id="3059" href="Graded.Heap.Soundness.html#2778" class="Generalizable">n</a> <a id="3061" href="Definition.LogicalRelation.html#2903" class="Record Operator">∷ℕ</a> <a id="3064" class="Symbol">→</a> <a id="3066" href="Graded.Heap.Soundness.html#2778" class="Generalizable">n</a> <a id="3068" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">PE.≡</a> <a id="3073" href="Graded.Heap.Untyped.html#9856" class="Function Operator">⦅</a> <a id="3075" href="Graded.Heap.Soundness.html#2795" class="Generalizable">s</a> <a id="3077" href="Graded.Heap.Untyped.html#9856" class="Function Operator">⦆</a> <a id="3079" class="Symbol">→</a> <a id="3081" href="Graded.Heap.Soundness.html#2832" class="Generalizable">Δ</a> <a id="3083" href="Graded.Heap.Typed.html#3888" class="Function Operator">⨾</a> <a id="3085" href="Graded.Heap.Soundness.html#2830" class="Generalizable">Γ</a> <a id="3087" href="Graded.Heap.Typed.html#3888" class="Function Operator">⊢</a> <a id="3089" href="Graded.Heap.Soundness.html#2795" class="Generalizable">s</a> <a id="3091" href="Graded.Heap.Typed.html#3888" class="Function Operator">∷</a> <a id="3093" href="Definition.Untyped.html#1668" class="InductiveConstructor">ℕ</a> <a id="3095" class="Symbol">→</a> <a id="3097" href="Graded.Heap.Soundness.html#2813" class="Generalizable">γ</a> <a id="3099" href="Graded.Heap.Usage.html#3287" class="Function Operator">⨾</a> <a id="3101" href="Graded.Heap.Soundness.html#2815" class="Generalizable">δ</a> <a id="3103" href="Graded.Heap.Usage.html#3287" class="Function Operator">⨾</a> <a id="3105" href="Graded.Heap.Soundness.html#2817" class="Generalizable">η</a> <a id="3107" href="Graded.Heap.Usage.html#3287" class="Function Operator">▸</a> <a id="3109" href="Graded.Heap.Soundness.html#2795" class="Generalizable">s</a>
             <a id="3124" class="Symbol">→</a> <a id="3126" href="Tools.Product.html#1014" class="Function">∃₅</a> <a id="3129" class="Symbol">λ</a> <a id="3131" href="Graded.Heap.Soundness.html#3131" class="Bound">m</a> <a id="3133" href="Graded.Heap.Soundness.html#3133" class="Bound">n</a> <a id="3135" href="Graded.Heap.Soundness.html#3135" class="Bound">H</a> <a id="3137" class="Symbol">(</a><a id="3138" href="Graded.Heap.Soundness.html#3138" class="Bound">ρ</a> <a id="3140" class="Symbol">:</a> <a id="3142" href="Definition.Untyped.NotParametrised.html#2601" class="Datatype">Wk</a> <a id="3145" href="Graded.Heap.Soundness.html#3131" class="Bound">m</a> <a id="3147" href="Graded.Heap.Soundness.html#3133" class="Bound">n</a><a id="3148" class="Symbol">)</a> <a id="3150" href="Graded.Heap.Soundness.html#3150" class="Bound">t</a> <a id="3152" class="Symbol">→</a> <a id="3154" href="Graded.Heap.Soundness.html#2795" class="Generalizable">s</a> <a id="3156" href="Graded.Heap.Reduction.html#5867" class="Datatype Operator">⇒*</a> <a id="3159" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟨</a> <a id="3161" href="Graded.Heap.Soundness.html#3135" class="Bound">H</a> <a id="3163" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="3165" href="Graded.Heap.Soundness.html#3150" class="Bound">t</a> <a id="3167" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="3169" href="Graded.Heap.Soundness.html#3138" class="Bound">ρ</a> <a id="3171" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="3173" class="InductiveConstructor">ε</a> <a id="3175" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟩</a> <a id="3177" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3179" href="Definition.Untyped.html#3454" class="Datatype">Numeral</a> <a id="3187" href="Graded.Heap.Soundness.html#3150" class="Bound">t</a>
  <a id="3191" href="Graded.Heap.Soundness.html#2987" class="Function">redNumeral</a> <a id="3202" href="Graded.Heap.Soundness.html#3202" class="Bound">consistent</a> <a id="3213" class="Symbol">(</a><a id="3214" href="Definition.LogicalRelation.html#2984" class="InductiveConstructor">ℕₜ</a> <a id="3217" class="Symbol">_</a> <a id="3219" href="Graded.Heap.Soundness.html#3219" class="Bound">d</a> <a id="3221" href="Graded.Heap.Soundness.html#3221" class="Bound">n≡n</a> <a id="3225" class="Symbol">(</a><a id="3226" href="Definition.LogicalRelation.html#3211" class="InductiveConstructor">sucᵣ</a> <a id="3231" href="Graded.Heap.Soundness.html#3231" class="Bound">x</a><a id="3232" class="Symbol">))</a> <a id="3235" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a> <a id="3243" href="Graded.Heap.Soundness.html#3243" class="Bound">⊢s</a> <a id="3246" href="Graded.Heap.Soundness.html#3246" class="Bound">▸s</a> <a id="3249" class="Symbol">=</a>
    <a id="3255" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3260" href="Graded.Heap.Termination.html#2637" class="Function">whBisim</a> <a id="3268" href="Graded.Heap.Soundness.html#3202" class="Bound">consistent</a> <a id="3279" class="Symbol">(</a><a id="3280" href="Definition.Typed.html#20750" class="Field">redₜ</a> <a id="3285" href="Graded.Heap.Soundness.html#3219" class="Bound">d</a> <a id="3287" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3289" href="Definition.Untyped.Neutral.html#2535" class="InductiveConstructor">sucₙ</a><a id="3293" class="Symbol">)</a> <a id="3295" href="Graded.Heap.Soundness.html#3243" class="Bound">⊢s</a> <a id="3298" href="Graded.Heap.Soundness.html#3246" class="Bound">▸s</a> <a id="3301" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3304" class="Symbol">λ</a>
      <a id="3312" class="Symbol">(_</a> <a id="3315" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3317" class="Symbol">_</a> <a id="3319" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3321" href="Graded.Heap.Soundness.html#3321" class="Bound">H</a> <a id="3323" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3325" href="Graded.Heap.Soundness.html#3325" class="Bound">t</a> <a id="3327" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3329" href="Graded.Heap.Soundness.html#3329" class="Bound">ρ</a> <a id="3331" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3333" href="Graded.Heap.Soundness.html#3333" class="Bound">d′</a> <a id="3336" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3338" href="Graded.Heap.Soundness.html#3338" class="Bound">≡u</a> <a id="3341" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3343" href="Graded.Heap.Soundness.html#3343" class="Bound">v</a><a id="3344" class="Symbol">)</a> <a id="3346" class="Symbol">→</a>
    <a id="3352" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3357" href="Definition.Untyped.Inversion.html#6493" class="Function">subst-suc</a> <a id="3367" class="Symbol">{</a><a id="3368" class="Argument">t</a> <a id="3370" class="Symbol">=</a> <a id="3372" href="Definition.Untyped.html#9219" class="Function">wk</a> <a id="3375" href="Graded.Heap.Soundness.html#3329" class="Bound">ρ</a> <a id="3377" href="Graded.Heap.Soundness.html#3325" class="Bound">t</a><a id="3378" class="Symbol">}</a> <a id="3380" href="Graded.Heap.Soundness.html#3338" class="Bound">≡u</a> <a id="3383" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3386" class="Symbol">λ</a> <a id="3388" class="Symbol">{</a>
      <a id="3396" class="Symbol">(</a><a id="3397" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3402" class="Symbol">(</a><a id="3403" href="Graded.Heap.Soundness.html#3403" class="Bound">x</a> <a id="3405" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3407" href="Graded.Heap.Soundness.html#3407" class="Bound">≡x</a><a id="3409" class="Symbol">))</a> <a id="3412" class="Symbol">→</a>
    <a id="3418" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3423" href="Definition.Untyped.Inversion.html#674" class="Function">wk-var</a> <a id="3430" href="Graded.Heap.Soundness.html#3407" class="Bound">≡x</a> <a id="3433" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3436" class="Symbol">λ</a> <a id="3438" class="Symbol">{</a>
      <a id="3446" class="Symbol">(_</a> <a id="3449" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3451" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a> <a id="3459" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3461" class="Symbol">_)</a> <a id="3464" class="Symbol">→</a>
    <a id="3470" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3475" href="Graded.Heap.Soundness.html#3343" class="Bound">v</a> <a id="3477" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3480" class="Symbol">λ</a> <a id="3482" class="Symbol">()};</a>
      <a id="3493" class="Symbol">(</a><a id="3494" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3499" class="Symbol">(</a><a id="3500" href="Graded.Heap.Soundness.html#3500" class="Bound">n′</a> <a id="3503" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3505" href="Graded.Heap.Soundness.html#3505" class="Bound">≡suc</a> <a id="3510" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3512" href="Graded.Heap.Soundness.html#3512" class="Bound">≡n</a><a id="3514" class="Symbol">))</a> <a id="3517" class="Symbol">→</a>
    <a id="3523" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3528" href="Definition.Untyped.Inversion.html#6386" class="Function">wk-suc</a> <a id="3535" href="Graded.Heap.Soundness.html#3505" class="Bound">≡suc</a> <a id="3540" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3543" class="Symbol">λ</a> <a id="3545" class="Symbol">{</a>
      <a id="3553" class="Symbol">(</a><a id="3554" href="Graded.Heap.Soundness.html#3554" class="Bound">n″</a> <a id="3557" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3559" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a> <a id="3567" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3569" href="Graded.Heap.Soundness.html#3569" class="Bound">≡n′</a><a id="3572" class="Symbol">)</a> <a id="3574" class="Symbol">→</a>
    <a id="3580" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3585" href="Definition.Untyped.Properties.html#71572" class="Function">isNumeral?</a> <a id="3596" href="Graded.Heap.Soundness.html#3554" class="Bound">n″</a> <a id="3599" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3602" class="Symbol">λ</a> <a id="3604" class="Symbol">{</a>
      <a id="3612" class="Symbol">(</a><a id="3613" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="3617" href="Graded.Heap.Soundness.html#3617" class="Bound">num</a><a id="3620" class="Symbol">)</a> <a id="3622" class="Symbol">→</a>
    <a id="3628" class="Symbol">_</a> <a id="3630" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3632" class="Symbol">_</a> <a id="3634" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3636" class="Symbol">_</a> <a id="3638" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3640" class="Symbol">_</a> <a id="3642" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3644" class="Symbol">_</a> <a id="3646" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3648" href="Graded.Heap.Bisimilarity.html#14688" class="Function">bisim₇*</a> <a id="3656" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="3661" href="Graded.Heap.Soundness.html#3333" class="Bound">d′</a> <a id="3664" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3666" href="Definition.Untyped.html#3520" class="InductiveConstructor">sucₙ</a> <a id="3671" href="Graded.Heap.Soundness.html#3617" class="Bound">num</a> <a id="3675" class="Symbol">;</a>
      <a id="3683" class="Symbol">(</a><a id="3684" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="3687" href="Graded.Heap.Soundness.html#3687" class="Bound">¬num</a><a id="3691" class="Symbol">)</a> <a id="3693" class="Symbol">→</a>
    <a id="3699" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3704" href="Graded.Heap.Typed.Reduction.html#19414" class="Function">⊢ₛ-⇒*</a> <a id="3710" href="Graded.Heap.Soundness.html#3243" class="Bound">⊢s</a> <a id="3713" href="Graded.Heap.Soundness.html#3333" class="Bound">d′</a> <a id="3716" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3719" class="Symbol">λ</a>
      <a id="3727" class="Symbol">(_</a> <a id="3730" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3732" class="Symbol">_</a> <a id="3734" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3736" class="Symbol">_</a> <a id="3738" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3740" class="Symbol">_</a> <a id="3742" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3744" href="Graded.Heap.Soundness.html#3744" class="Bound">⊢H</a> <a id="3747" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3749" href="Graded.Heap.Soundness.html#3749" class="Bound">⊢t</a> <a id="3752" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3754" href="Graded.Heap.Soundness.html#3754" class="Bound">⊢S</a><a id="3756" class="Symbol">)</a> <a id="3758" class="Symbol">→</a>
    <a id="3764" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3769" href="Definition.Typed.Consequences.Inversion.html#4035" class="Function">inversion-suc</a> <a id="3783" href="Graded.Heap.Soundness.html#3749" class="Bound">⊢t</a> <a id="3786" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3789" class="Symbol">λ</a>
      <a id="3797" class="Symbol">(</a><a id="3798" href="Graded.Heap.Soundness.html#3798" class="Bound">⊢n″</a> <a id="3802" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3804" href="Graded.Heap.Soundness.html#3804" class="Bound">≡ℕ</a><a id="3806" class="Symbol">)</a> <a id="3808" class="Symbol">→</a>
    <a id="3814" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3819" href="Graded.Heap.Usage.Reduction.html#47450" class="Function">URᶠ.▸-⇒*</a> <a id="3828" href="Graded.Heap.Soundness.html#3246" class="Bound">▸s</a> <a id="3831" href="Graded.Heap.Soundness.html#3333" class="Bound">d′</a> <a id="3834" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3837" class="Symbol">λ</a>
      <a id="3845" class="Symbol">(_</a> <a id="3848" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3850" class="Symbol">_</a> <a id="3852" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3854" class="Symbol">_</a> <a id="3856" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3858" href="Graded.Heap.Soundness.html#3858" class="Bound">▸H</a> <a id="3861" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3863" href="Graded.Heap.Soundness.html#3863" class="Bound">▸t</a> <a id="3866" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3868" href="Graded.Heap.Soundness.html#3868" class="Bound">▸ε</a> <a id="3871" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3873" href="Graded.Heap.Soundness.html#3873" class="Bound">γ≤</a><a id="3875" class="Symbol">)</a> <a id="3877" class="Symbol">→</a>
    <a id="3883" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3888" href="Graded.Usage.Inversion.html#8154" class="Function">inv-usage-suc</a> <a id="3902" href="Graded.Heap.Soundness.html#3863" class="Bound">▸t</a> <a id="3905" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3908" class="Symbol">λ</a>
      <a id="3916" class="Symbol">(</a><a id="3917" href="Graded.Usage.Inversion.html#8028" class="InductiveConstructor">invUsageSuc</a> <a id="3929" href="Graded.Heap.Soundness.html#3929" class="Bound">▸n″</a> <a id="3933" href="Graded.Heap.Soundness.html#3933" class="Bound">δ≤</a><a id="3935" class="Symbol">)</a>  <a id="3938" class="Symbol">→</a>
    <a id="3944" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3949" href="Graded.Heap.Soundness.html#2987" class="Function">redNumeral</a> <a id="3960" class="Symbol">{</a><a id="3961" class="Argument">s</a> <a id="3963" class="Symbol">=</a> <a id="3965" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟨</a> <a id="3967" href="Graded.Heap.Soundness.html#3321" class="Bound">H</a> <a id="3969" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="3971" href="Graded.Heap.Soundness.html#3554" class="Bound">n″</a> <a id="3974" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="3976" href="Graded.Heap.Soundness.html#3329" class="Bound">ρ</a> <a id="3978" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="3980" href="Graded.Heap.Untyped.html#4626" class="InductiveConstructor">ε</a> <a id="3982" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟩</a><a id="3983" class="Symbol">}</a> <a id="3985" href="Graded.Heap.Soundness.html#3202" class="Bound">consistent</a> <a id="3996" href="Graded.Heap.Soundness.html#3231" class="Bound">x</a>
          <a id="4008" class="Symbol">(</a><a id="4009" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">PE.sym</a> <a id="4016" class="Symbol">(</a><a id="4017" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">PE.trans</a> <a id="4026" class="Symbol">(</a><a id="4027" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">PE.cong</a> <a id="4035" class="Symbol">(</a><a id="4036" href="Graded.Heap.Untyped.html#7956" class="Function Operator">_[</a> <a id="4039" href="Graded.Heap.Soundness.html#3321" class="Bound">H</a> <a id="4041" href="Graded.Heap.Untyped.html#7956" class="Function Operator">]ₕ</a><a id="4043" class="Symbol">)</a> <a id="4045" href="Graded.Heap.Soundness.html#3569" class="Bound">≡n′</a><a id="4048" class="Symbol">)</a> <a id="4050" href="Graded.Heap.Soundness.html#3512" class="Bound">≡n</a><a id="4052" class="Symbol">))</a>
          <a id="4065" class="Symbol">(_</a> <a id="4068" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4070" href="Graded.Heap.Soundness.html#3744" class="Bound">⊢H</a> <a id="4073" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4075" href="Graded.Heap.Soundness.html#3798" class="Bound">⊢n″</a> <a id="4079" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4081" href="Graded.Heap.Typed.html#3707" class="InductiveConstructor">ε</a><a id="4082" class="Symbol">)</a>
          <a id="4094" class="Symbol">(</a><a id="4095" href="Graded.Heap.Soundness.html#3858" class="Bound">▸H</a> <a id="4098" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4100" href="Graded.Heap.Soundness.html#3929" class="Bound">▸n″</a> <a id="4104" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4106" href="Graded.Heap.Soundness.html#3868" class="Bound">▸ε</a> <a id="4109" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4111" href="Graded.Context.Properties.PartialOrder.html#790" class="Function">≤ᶜ-trans</a> <a id="4120" href="Graded.Heap.Soundness.html#3873" class="Bound">γ≤</a> <a id="4123" class="Symbol">(</a><a id="4124" href="Graded.Context.Properties.Addition.html#2897" class="Function">+ᶜ-monotoneˡ</a> <a id="4137" class="Symbol">(</a><a id="4138" href="Graded.Context.Properties.Multiplication.html#3380" class="Function">·ᶜ-monotoneʳ</a> <a id="4151" class="Symbol">(</a><a id="4152" href="Graded.Context.Weakening.html#3188" class="Function">wk-≤ᶜ</a> <a id="4158" href="Graded.Heap.Soundness.html#3329" class="Bound">ρ</a> <a id="4160" href="Graded.Heap.Soundness.html#3933" class="Bound">δ≤</a><a id="4162" class="Symbol">))))</a> <a id="4167" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4170" class="Symbol">λ</a>
      <a id="4178" class="Symbol">(_</a> <a id="4181" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4183" class="Symbol">_</a> <a id="4185" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4187" href="Graded.Heap.Soundness.html#4187" class="Bound">H′</a> <a id="4190" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4192" href="Graded.Heap.Soundness.html#4192" class="Bound">ρ′</a> <a id="4195" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4197" href="Graded.Heap.Soundness.html#4197" class="Bound">t′</a> <a id="4200" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4202" href="Graded.Heap.Soundness.html#4202" class="Bound">d₀</a> <a id="4205" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4207" href="Graded.Heap.Soundness.html#4207" class="Bound">n</a><a id="4208" class="Symbol">)</a> <a id="4210" class="Symbol">→</a>
    <a id="4216" class="Symbol">_</a> <a id="4218" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4220" class="Symbol">_</a> <a id="4222" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4224" class="Symbol">_</a> <a id="4226" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4228" class="Symbol">_</a> <a id="4230" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4232" class="Symbol">_</a>
      <a id="4240" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4242" class="Symbol">(</a><a id="4243" href="Graded.Heap.Bisimilarity.html#14688" class="Function">bisim₇*</a> <a id="4251" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="4256" href="Graded.Heap.Soundness.html#3333" class="Bound">d′</a> <a id="4259" href="Graded.Heap.Reduction.Properties.html#1410" class="Function Operator">⇨*</a> <a id="4262" class="Symbol">((</a><a id="4264" href="Graded.Heap.Reduction.html#5711" class="InductiveConstructor Operator">⇒ₛ</a> <a id="4267" class="Symbol">(</a><a id="4268" href="Graded.Heap.Reduction.html#5136" class="InductiveConstructor">sucₕ</a> <a id="4273" href="Graded.Heap.Soundness.html#3687" class="Bound">¬num</a><a id="4277" class="Symbol">))</a> <a id="4280" href="Graded.Heap.Reduction.html#5943" class="InductiveConstructor Operator">⇨</a>
          <a id="4292" class="Symbol">(</a><a id="4293" href="Graded.Heap.Reduction.Properties.html#12793" class="Function">++sucₛ-⇒*</a> <a id="4303" class="Symbol">{</a><a id="4304" class="Argument">k</a> <a id="4306" class="Symbol">=</a> <a id="4308" class="Number">1</a><a id="4309" class="Symbol">}</a> <a id="4311" href="Graded.Heap.Soundness.html#4202" class="Bound">d₀</a> <a id="4314" href="Graded.Heap.Reduction.Properties.html#1410" class="Function Operator">⇨*</a> <a id="4317" class="Symbol">((</a><a id="4319" href="Graded.Heap.Reduction.html#5711" class="InductiveConstructor Operator">⇒ₛ</a> <a id="4322" class="Symbol">(</a><a id="4323" href="Graded.Heap.Reduction.html#5226" class="InductiveConstructor">numₕ</a> <a id="4328" href="Graded.Heap.Soundness.html#4207" class="Bound">n</a><a id="4329" class="Symbol">))</a> <a id="4332" href="Graded.Heap.Reduction.html#5943" class="InductiveConstructor Operator">⇨</a> <a id="4334" href="Graded.Heap.Reduction.html#5929" class="InductiveConstructor">id</a><a id="4336" class="Symbol">))))</a>
      <a id="4347" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4349" href="Definition.Untyped.html#3520" class="InductiveConstructor">sucₙ</a> <a id="4354" href="Graded.Heap.Soundness.html#4207" class="Bound">n</a> <a id="4356" class="Symbol">}}}</a>

  <a id="4363" href="Graded.Heap.Soundness.html#2987" class="Function">redNumeral</a> <a id="4374" href="Graded.Heap.Soundness.html#4374" class="Bound">consistent</a> <a id="4385" class="Symbol">(</a><a id="4386" href="Definition.LogicalRelation.html#2984" class="InductiveConstructor">ℕₜ</a> <a id="4389" class="Symbol">_</a> <a id="4391" href="Graded.Heap.Soundness.html#4391" class="Bound">d</a> <a id="4393" href="Graded.Heap.Soundness.html#4393" class="Bound">n≡n</a> <a id="4397" href="Definition.LogicalRelation.html#3266" class="InductiveConstructor">zeroᵣ</a><a id="4402" class="Symbol">)</a> <a id="4404" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a> <a id="4412" href="Graded.Heap.Soundness.html#4412" class="Bound">⊢s</a> <a id="4415" href="Graded.Heap.Soundness.html#4415" class="Bound">▸s</a> <a id="4418" class="Symbol">=</a>
    <a id="4424" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4429" href="Graded.Heap.Termination.html#2637" class="Function">whBisim</a> <a id="4437" href="Graded.Heap.Soundness.html#4374" class="Bound">consistent</a> <a id="4448" class="Symbol">(</a><a id="4449" href="Definition.Typed.html#20750" class="Field">redₜ</a> <a id="4454" href="Graded.Heap.Soundness.html#4391" class="Bound">d</a> <a id="4456" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4458" href="Definition.Untyped.Neutral.html#2515" class="InductiveConstructor">zeroₙ</a><a id="4463" class="Symbol">)</a> <a id="4465" href="Graded.Heap.Soundness.html#4412" class="Bound">⊢s</a> <a id="4468" href="Graded.Heap.Soundness.html#4415" class="Bound">▸s</a> <a id="4471" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4474" class="Symbol">λ</a>
      <a id="4482" class="Symbol">(_</a> <a id="4485" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4487" class="Symbol">_</a> <a id="4489" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4491" href="Graded.Heap.Soundness.html#4491" class="Bound">H</a> <a id="4493" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4495" href="Graded.Heap.Soundness.html#4495" class="Bound">t</a> <a id="4497" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4499" href="Graded.Heap.Soundness.html#4499" class="Bound">ρ</a> <a id="4501" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4503" href="Graded.Heap.Soundness.html#4503" class="Bound">d′</a> <a id="4506" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4508" href="Graded.Heap.Soundness.html#4508" class="Bound">≡u</a> <a id="4511" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4513" href="Graded.Heap.Soundness.html#4513" class="Bound">v</a><a id="4514" class="Symbol">)</a> <a id="4516" class="Symbol">→</a>
    <a id="4522" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4527" href="Definition.Untyped.Inversion.html#6219" class="Function">subst-zero</a> <a id="4538" class="Symbol">{</a><a id="4539" class="Argument">t</a> <a id="4541" class="Symbol">=</a> <a id="4543" href="Definition.Untyped.html#9219" class="Function">wk</a> <a id="4546" href="Graded.Heap.Soundness.html#4499" class="Bound">ρ</a> <a id="4548" href="Graded.Heap.Soundness.html#4495" class="Bound">t</a><a id="4549" class="Symbol">}</a> <a id="4551" href="Graded.Heap.Soundness.html#4508" class="Bound">≡u</a> <a id="4554" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4557" class="Symbol">λ</a> <a id="4559" class="Symbol">{</a>
      <a id="4567" class="Symbol">(</a><a id="4568" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="4573" class="Symbol">(</a><a id="4574" href="Graded.Heap.Soundness.html#4574" class="Bound">x</a> <a id="4576" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4578" href="Graded.Heap.Soundness.html#4578" class="Bound">≡x</a><a id="4580" class="Symbol">))</a> <a id="4583" class="Symbol">→</a>
    <a id="4589" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4594" href="Definition.Untyped.Inversion.html#674" class="Function">wk-var</a> <a id="4601" href="Graded.Heap.Soundness.html#4578" class="Bound">≡x</a> <a id="4604" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4607" class="Symbol">λ</a> <a id="4609" class="Symbol">{</a>
      <a id="4617" class="Symbol">(_</a> <a id="4620" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4622" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a> <a id="4630" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4632" href="Graded.Heap.Soundness.html#4632" class="Bound">w</a><a id="4633" class="Symbol">)</a> <a id="4635" class="Symbol">→</a>
    <a id="4641" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4646" href="Graded.Heap.Soundness.html#4513" class="Bound">v</a> <a id="4648" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4651" class="Symbol">λ</a> <a id="4653" class="Symbol">()}</a> <a id="4657" class="Symbol">;</a>
      <a id="4665" class="Symbol">(</a><a id="4666" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="4671" href="Graded.Heap.Soundness.html#4671" class="Bound">≡zero</a><a id="4676" class="Symbol">)</a> <a id="4678" class="Symbol">→</a>
    <a id="4684" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4689" href="Definition.Untyped.Inversion.html#6152" class="Function">wk-zero</a> <a id="4697" href="Graded.Heap.Soundness.html#4671" class="Bound">≡zero</a> <a id="4703" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4706" class="Symbol">λ</a> <a id="4708" class="Symbol">{</a>
      <a id="4716" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a> <a id="4724" class="Symbol">→</a>
    <a id="4730" class="Symbol">_</a> <a id="4732" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4734" class="Symbol">_</a> <a id="4736" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4738" class="Symbol">_</a> <a id="4740" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4742" class="Symbol">_</a> <a id="4744" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4746" class="Symbol">_</a> <a id="4748" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4750" href="Graded.Heap.Bisimilarity.html#14688" class="Function">bisim₇*</a> <a id="4758" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="4763" href="Graded.Heap.Soundness.html#4503" class="Bound">d′</a> <a id="4766" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4768" href="Definition.Untyped.html#3497" class="InductiveConstructor">zeroₙ</a> <a id="4774" class="Symbol">}}</a>

  <a id="4780" href="Graded.Heap.Soundness.html#2987" class="Function">redNumeral</a> <a id="4791" href="Graded.Heap.Soundness.html#4791" class="Bound">consistent</a> <a id="4802" class="Symbol">(</a><a id="4803" href="Definition.LogicalRelation.html#2984" class="InductiveConstructor">ℕₜ</a> <a id="4806" class="Symbol">_</a> <a id="4808" href="Graded.Heap.Soundness.html#4808" class="Bound">d</a> <a id="4810" href="Graded.Heap.Soundness.html#4810" class="Bound">n≡n</a> <a id="4814" class="Symbol">(</a><a id="4815" href="Definition.LogicalRelation.html#3298" class="InductiveConstructor">ne</a> <a id="4818" class="Symbol">(</a><a id="4819" href="Definition.LogicalRelation.html#1866" class="InductiveConstructor">neNfₜ</a> <a id="4825" href="Graded.Heap.Soundness.html#4825" class="Bound">neK</a> <a id="4829" href="Graded.Heap.Soundness.html#4829" class="Bound">⊢k</a> <a id="4832" href="Graded.Heap.Soundness.html#4832" class="Bound">k≡k</a><a id="4835" class="Symbol">)))</a> <a id="4839" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a> <a id="4847" href="Graded.Heap.Soundness.html#4847" class="Bound">⊢s</a> <a id="4850" href="Graded.Heap.Soundness.html#4850" class="Bound">▸s</a> <a id="4853" class="Symbol">=</a>
    <a id="4859" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4864" href="Graded.Heap.Termination.html#2637" class="Function">whBisim</a> <a id="4872" href="Graded.Heap.Soundness.html#4791" class="Bound">consistent</a> <a id="4883" class="Symbol">(</a><a id="4884" href="Definition.Typed.html#20750" class="Field">redₜ</a> <a id="4889" href="Graded.Heap.Soundness.html#4808" class="Bound">d</a> <a id="4891" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4893" href="Definition.Untyped.Neutral.html#2659" class="InductiveConstructor">ne</a> <a id="4896" href="Graded.Heap.Soundness.html#4825" class="Bound">neK</a><a id="4899" class="Symbol">)</a> <a id="4901" href="Graded.Heap.Soundness.html#4847" class="Bound">⊢s</a> <a id="4904" href="Graded.Heap.Soundness.html#4850" class="Bound">▸s</a> <a id="4907" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4910" class="Symbol">λ</a> <a id="4912" class="Symbol">{</a>
      <a id="4920" class="Symbol">(_</a> <a id="4923" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4925" class="Symbol">_</a> <a id="4927" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4929" href="Graded.Heap.Soundness.html#4929" class="Bound">H</a> <a id="4931" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4933" href="Graded.Heap.Soundness.html#4933" class="Bound">t</a> <a id="4935" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4937" href="Graded.Heap.Soundness.html#4937" class="Bound">ρ</a> <a id="4939" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4941" href="Graded.Heap.Soundness.html#4941" class="Bound">d′</a> <a id="4944" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4946" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a> <a id="4954" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4956" href="Graded.Heap.Soundness.html#4956" class="Bound">v</a><a id="4957" class="Symbol">)</a> <a id="4959" class="Symbol">→</a>
    <a id="4965" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="4972" class="Symbol">(</a><a id="4973" href="Graded.Heap.Untyped.Properties.html#2725" class="Function">Value→¬Neutral</a> <a id="4988" class="Symbol">(</a><a id="4989" href="Graded.Heap.Untyped.Properties.html#2258" class="Function">substValue</a> <a id="5000" class="Symbol">(</a><a id="5001" href="Graded.Heap.Untyped.html#7729" class="Function">toSubstₕ</a> <a id="5010" href="Graded.Heap.Soundness.html#4929" class="Bound">H</a><a id="5011" class="Symbol">)</a> <a id="5013" class="Symbol">(</a><a id="5014" href="Graded.Heap.Untyped.Properties.html#1818" class="Function">wkValue</a> <a id="5022" href="Graded.Heap.Soundness.html#4937" class="Bound">ρ</a> <a id="5024" href="Graded.Heap.Soundness.html#4956" class="Bound">v</a><a id="5025" class="Symbol">))</a> <a id="5028" href="Graded.Heap.Soundness.html#4825" class="Bound">neK</a><a id="5031" class="Symbol">)</a> <a id="5033" class="Symbol">}</a>

<a id="5036" class="Keyword">opaque</a>

  <a id="5046" class="Comment">-- Given some assumptions, all well-typed and erased terms of type ℕ reduce to some</a>
  <a id="5132" class="Comment">-- numeral and the resulting heap has all grades less than or equal to 𝟘.</a>

  <a id="5209" class="Comment">-- Note that some assumptions to this theorem are given as a module parameter.</a>

  <a id="soundness"></a><a id="5291" href="Graded.Heap.Soundness.html#5291" class="Function">soundness</a> <a id="5301" class="Symbol">:</a> <a id="5303" class="Symbol">{</a><a id="5304" href="Graded.Heap.Soundness.html#5304" class="Bound">Δ</a> <a id="5306" class="Symbol">:</a> <a id="5308" href="Definition.Untyped.NotParametrised.html#882" class="Datatype">Con</a> <a id="5312" href="Definition.Untyped.html#1160" class="Datatype">Term</a> <a id="5317" href="Graded.Heap.Soundness.html#2768" class="Generalizable">k</a><a id="5318" class="Symbol">}</a>
            <a id="5332" class="Symbol">→</a> <a id="5334" class="Symbol">(</a><a id="5335" href="Graded.Heap.Soundness.html#2768" class="Generalizable">k</a> <a id="5337" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">PE.≡</a> <a id="5342" class="Number">0</a> <a id="5344" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="5346" class="Symbol">(</a><a id="5347" href="Graded.Usage.Restrictions.html#1638" class="Function">Emptyrec-allowed</a> <a id="5364" class="InductiveConstructor">𝟙ᵐ</a> <a id="5367" href="Graded.Modality.html#897" class="Function">𝟘</a> <a id="5369" class="Symbol">→</a> <a id="5371" href="Definition.Typed.html#21867" class="Function">Consistent</a> <a id="5382" href="Graded.Heap.Soundness.html#5304" class="Bound">Δ</a><a id="5383" class="Symbol">)</a> <a id="5385" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5387" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="5389" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a><a id="5400" class="Symbol">)</a>
            <a id="5414" class="Symbol">→</a> <a id="5416" href="Graded.Heap.Soundness.html#5304" class="Bound">Δ</a> <a id="5418" href="Definition.Typed.html#1755" class="Datatype Operator">⊢</a> <a id="5420" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="5422" href="Definition.Typed.html#1755" class="Datatype Operator">∷</a> <a id="5424" href="Definition.Untyped.html#1668" class="InductiveConstructor">ℕ</a> <a id="5426" class="Symbol">→</a> <a id="5428" href="Graded.Context.html#2498" class="Function">𝟘ᶜ</a> <a id="5431" href="Graded.Usage.html#14460" class="Function Operator">▸</a> <a id="5433" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a>
            <a id="5447" class="Symbol">→</a> <a id="5449" href="Tools.Product.html#1014" class="Function">∃₅</a> <a id="5452" class="Symbol">λ</a> <a id="5454" href="Graded.Heap.Soundness.html#5454" class="Bound">m</a> <a id="5456" href="Graded.Heap.Soundness.html#5456" class="Bound">n</a> <a id="5458" href="Graded.Heap.Soundness.html#5458" class="Bound">H</a> <a id="5460" href="Graded.Heap.Soundness.html#5460" class="Bound">k</a> <a id="5462" class="Symbol">(</a><a id="5463" href="Graded.Heap.Soundness.html#5463" class="Bound">ρ</a> <a id="5465" class="Symbol">:</a> <a id="5467" href="Definition.Untyped.NotParametrised.html#2601" class="Datatype">Wk</a> <a id="5470" href="Graded.Heap.Soundness.html#5454" class="Bound">m</a> <a id="5472" href="Graded.Heap.Soundness.html#5456" class="Bound">n</a><a id="5473" class="Symbol">)</a> <a id="5475" class="Symbol">→</a>
              <a id="5491" href="Graded.Heap.Untyped.html#10028" class="Function">initial</a> <a id="5499" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="5501" href="Graded.Heap.Reduction.html#5867" class="Datatype Operator">⇒*</a> <a id="5504" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟨</a> <a id="5506" href="Graded.Heap.Soundness.html#5458" class="Bound">H</a> <a id="5508" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="5510" href="Definition.Untyped.html#3622" class="Function">sucᵏ</a> <a id="5515" href="Graded.Heap.Soundness.html#5460" class="Bound">k</a> <a id="5517" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="5519" href="Graded.Heap.Soundness.html#5463" class="Bound">ρ</a> <a id="5521" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="5523" class="InductiveConstructor">ε</a> <a id="5525" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟩</a> <a id="5527" href="Data.Product.Base.html#1618" class="Function Operator">×</a>
              <a id="5543" class="Symbol">(</a><a id="5544" href="Graded.Heap.Soundness.html#5304" class="Bound">Δ</a> <a id="5546" href="Definition.Typed.html#5482" class="Datatype Operator">⊢</a> <a id="5548" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="5550" href="Definition.Typed.html#5482" class="Datatype Operator">≡</a> <a id="5552" href="Definition.Untyped.html#3622" class="Function">sucᵏ</a> <a id="5557" href="Graded.Heap.Soundness.html#5460" class="Bound">k</a> <a id="5559" href="Definition.Typed.html#5482" class="Datatype Operator">∷</a> <a id="5561" href="Definition.Untyped.html#1668" class="InductiveConstructor">ℕ</a><a id="5562" class="Symbol">)</a> <a id="5564" href="Data.Product.Base.html#1618" class="Function Operator">×</a>
              <a id="5580" href="Graded.Heap.Soundness.html#5458" class="Bound">H</a> <a id="5582" href="Graded.Heap.Usage.html#1317" class="Datatype Operator">≤ʰ</a> <a id="5585" href="Graded.Modality.html#897" class="Function">𝟘</a>
  <a id="5589" href="Graded.Heap.Soundness.html#5291" class="Function">soundness</a> <a id="5599" class="Symbol">{</a><a id="5600" href="Graded.Heap.Soundness.html#5600" class="Bound">k</a><a id="5601" class="Symbol">}</a> <a id="5603" class="Symbol">{</a><a id="5604" href="Graded.Heap.Soundness.html#5604" class="Bound">t</a><a id="5605" class="Symbol">}</a> <a id="5607" class="Symbol">{</a><a id="5608" href="Graded.Heap.Soundness.html#5608" class="Bound">Δ</a><a id="5609" class="Symbol">}</a> <a id="5611" href="Graded.Heap.Soundness.html#5611" class="Bound">as</a> <a id="5614" href="Graded.Heap.Soundness.html#5614" class="Bound">⊢t</a> <a id="5617" href="Graded.Heap.Soundness.html#5617" class="Bound">▸t</a> <a id="5620" class="Symbol">=</a>
    <a id="5626" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="5631" href="Graded.Heap.Usage.Properties.html#1908" class="Function">▸initial</a> <a id="5640" href="Graded.Heap.Soundness.html#6942" class="Function">k≡0⊎erased-heap</a> <a id="5656" href="Graded.Heap.Soundness.html#5617" class="Bound">▸t</a> <a id="5659" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="5662" class="Symbol">λ</a>
      <a id="5670" href="Graded.Heap.Soundness.html#5670" class="Bound">▸s</a> <a id="5673" class="Symbol">→</a>
    <a id="5679" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="5684" href="Definition.LogicalRelation.Substitution.Introductions.Nat.html#2491" class="Function">⊩∷ℕ⇔</a> <a id="5689" class="Symbol">.</a><a id="5690" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5696" class="Symbol">(</a><a id="5697" href="Definition.LogicalRelation.Fundamental.Reducibility.html#1446" class="Function">reducible-⊩∷</a> <a id="5710" href="Graded.Heap.Soundness.html#5614" class="Bound">⊢t</a> <a id="5713" class="Symbol">.</a><a id="5714" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="5719" class="Symbol">)</a> <a id="5721" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="5724" class="Symbol">λ</a>
      <a id="5732" href="Graded.Heap.Soundness.html#5732" class="Bound">[t]</a> <a id="5736" class="Symbol">→</a>
    <a id="5742" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="5747" href="Graded.Heap.Soundness.html#2987" class="Function">redNumeral</a> <a id="5758" href="Graded.Heap.Soundness.html#6706" class="Function">consistent</a> <a id="5769" href="Graded.Heap.Soundness.html#5732" class="Bound">[t]</a> <a id="5773" class="Symbol">(</a><a id="5774" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">PE.sym</a> <a id="5781" class="Symbol">(</a><a id="5782" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">PE.trans</a> <a id="5791" class="Symbol">(</a><a id="5792" href="Graded.Heap.Untyped.Properties.html#21613" class="Function">erasedHeap-subst</a> <a id="5809" class="Symbol">(</a><a id="5810" href="Definition.Untyped.html#9219" class="Function">wk</a> <a id="5813" href="Definition.Untyped.NotParametrised.html#2630" class="InductiveConstructor">id</a> <a id="5816" href="Graded.Heap.Soundness.html#5604" class="Bound">t</a><a id="5817" class="Symbol">))</a> <a id="5820" class="Symbol">(</a><a id="5821" href="Definition.Untyped.Properties.html#9557" class="Function">wk-id</a> <a id="5827" href="Graded.Heap.Soundness.html#5604" class="Bound">t</a><a id="5828" class="Symbol">)))</a>
           <a id="5843" class="Symbol">(</a><a id="5844" href="Graded.Heap.Typed.Properties.html#1894" class="Function">⊢initial</a> <a id="5853" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="5859" href="Graded.Heap.Soundness.html#5614" class="Bound">⊢t</a><a id="5861" class="Symbol">)</a> <a id="5863" href="Graded.Heap.Soundness.html#5670" class="Bound">▸s</a> <a id="5866" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="5869" class="Symbol">λ</a>
      <a id="5877" class="Symbol">(_</a> <a id="5880" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5882" class="Symbol">_</a> <a id="5884" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5886" href="Graded.Heap.Soundness.html#5886" class="Bound">H</a> <a id="5888" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5890" href="Graded.Heap.Soundness.html#5890" class="Bound">ρ</a> <a id="5892" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5894" href="Graded.Heap.Soundness.html#5894" class="Bound">t</a> <a id="5896" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5898" href="Graded.Heap.Soundness.html#5898" class="Bound">d</a> <a id="5900" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5902" href="Graded.Heap.Soundness.html#5902" class="Bound">num</a><a id="5905" class="Symbol">)</a> <a id="5907" class="Symbol">→</a>
    <a id="5913" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="5918" href="Graded.Heap.Usage.Reduction.html#47450" class="Function">URᵗ.▸-⇒*</a> <a id="5927" href="Graded.Heap.Soundness.html#5670" class="Bound">▸s</a> <a id="5930" href="Graded.Heap.Soundness.html#5898" class="Bound">d</a> <a id="5932" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="5935" class="Symbol">λ</a> <a id="5937" class="Symbol">{</a>
      <a id="5945" class="Symbol">(</a><a id="5946" href="Graded.Heap.Soundness.html#5946" class="Bound">γ</a> <a id="5948" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5950" href="Graded.Heap.Soundness.html#5950" class="Bound">δ</a> <a id="5952" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5954" class="Symbol">_</a> <a id="5956" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5958" href="Graded.Heap.Soundness.html#5958" class="Bound">▸H</a> <a id="5961" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5963" href="Graded.Heap.Soundness.html#5963" class="Bound">▸n</a> <a id="5966" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5968" href="Graded.Heap.Usage.html#3105" class="InductiveConstructor">ε</a> <a id="5970" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5972" href="Graded.Heap.Soundness.html#5972" class="Bound">γ≤</a><a id="5974" class="Symbol">)</a> <a id="5976" class="Symbol">→</a>
    <a id="5982" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="5987" href="Definition.Untyped.Properties.html#72944" class="Function">Numeral→sucᵏ</a> <a id="6000" href="Graded.Heap.Soundness.html#5902" class="Bound">num</a> <a id="6004" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="6007" class="Symbol">λ</a>
      <a id="6015" class="Symbol">(</a><a id="6016" href="Graded.Heap.Soundness.html#6016" class="Bound">k</a> <a id="6018" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6020" href="Graded.Heap.Soundness.html#6020" class="Bound">≡sucᵏ</a><a id="6025" class="Symbol">)</a> <a id="6027" class="Symbol">→</a>
    <a id="6033" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="6038" href="Relation.Binary.PropositionalEquality.Core.html#1989" class="Function">PE.subst</a> <a id="6047" class="Symbol">(λ</a> <a id="6050" href="Graded.Heap.Soundness.html#6050" class="Bound">x</a> <a id="6052" class="Symbol">→</a> <a id="6054" class="Symbol">_</a> <a id="6056" href="Graded.Heap.Reduction.html#5867" class="Datatype Operator">⇒*</a> <a id="6059" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟨</a> <a id="6061" class="Symbol">_</a> <a id="6063" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="6065" href="Graded.Heap.Soundness.html#6050" class="Bound">x</a> <a id="6067" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="6069" class="Symbol">_</a> <a id="6071" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="6073" class="Symbol">_</a> <a id="6075" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟩</a><a id="6076" class="Symbol">)</a> <a id="6078" href="Graded.Heap.Soundness.html#6020" class="Bound">≡sucᵏ</a> <a id="6084" href="Graded.Heap.Soundness.html#5898" class="Bound">d</a> <a id="6086" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="6089" class="Symbol">λ</a>
      <a id="6097" href="Graded.Heap.Soundness.html#6097" class="Bound">d′</a> <a id="6100" class="Symbol">→</a>
    <a id="6106" class="Keyword">let</a> <a id="6110" class="Keyword">open</a> <a id="6115" href="Tools.Reasoning.PartialOrder.html" class="Module">RPo</a> <a id="6119" href="Graded.Context.Properties.PartialOrder.html#1875" class="Function">≤ᶜ-poset</a> <a id="6128" class="Keyword">in</a>
    <a id="6135" class="Symbol">_</a> <a id="6137" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6139" class="Symbol">_</a> <a id="6141" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6143" class="Symbol">_</a> <a id="6145" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6147" class="Symbol">_</a> <a id="6149" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6151" class="Symbol">_</a>
      <a id="6159" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6161" href="Graded.Heap.Soundness.html#6097" class="Bound">d′</a>
      <a id="6170" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6172" href="Relation.Binary.PropositionalEquality.Core.html#2044" class="Function">PE.subst₂</a> <a id="6182" class="Symbol">(_</a> <a id="6185" href="Definition.Typed.html#5482" class="Datatype Operator">⊢_≡_∷</a> <a id="6191" href="Definition.Untyped.html#1668" class="InductiveConstructor">ℕ</a><a id="6192" class="Symbol">)</a>
          <a id="6204" class="Symbol">(</a><a id="6205" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">PE.trans</a> <a id="6214" class="Symbol">(</a><a id="6215" href="Graded.Heap.Untyped.Properties.html#21613" class="Function">erasedHeap-subst</a> <a id="6232" class="Symbol">(</a><a id="6233" href="Definition.Untyped.html#9219" class="Function">wk</a> <a id="6236" href="Definition.Untyped.NotParametrised.html#2630" class="InductiveConstructor">id</a> <a id="6239" class="Symbol">_))</a> <a id="6243" class="Symbol">(</a><a id="6244" href="Definition.Untyped.Properties.html#9557" class="Function">wk-id</a> <a id="6250" class="Symbol">_))</a>
          <a id="6264" class="Symbol">(</a><a id="6265" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">PE.trans</a> <a id="6274" class="Symbol">(</a><a id="6275" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">PE.cong</a> <a id="6283" class="Symbol">(</a><a id="6284" href="Graded.Heap.Untyped.html#7956" class="Function Operator">_[</a> <a id="6287" href="Graded.Heap.Soundness.html#5886" class="Bound">H</a> <a id="6289" href="Graded.Heap.Untyped.html#7956" class="Function Operator">]ₕ</a><a id="6291" class="Symbol">)</a> <a id="6293" class="Symbol">(</a><a id="6294" href="Definition.Untyped.Properties.html#73355" class="Function">wk-sucᵏ</a> <a id="6302" href="Graded.Heap.Soundness.html#6016" class="Bound">k</a><a id="6303" class="Symbol">))</a> <a id="6306" class="Symbol">(</a><a id="6307" href="Definition.Untyped.Properties.html#73184" class="Function">subst-sucᵏ</a> <a id="6318" href="Graded.Heap.Soundness.html#6016" class="Bound">k</a><a id="6319" class="Symbol">))</a>
          <a id="6332" class="Symbol">(</a><a id="6333" href="Graded.Heap.Typed.Reduction.html#28320" class="Function">⇒*→≡</a> <a id="6338" class="Symbol">(</a><a id="6339" href="Graded.Heap.Typed.Properties.html#1894" class="Function">⊢initial</a> <a id="6348" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="6353" href="Graded.Heap.Soundness.html#5614" class="Bound">⊢t</a><a id="6355" class="Symbol">)</a> <a id="6357" href="Graded.Heap.Soundness.html#6097" class="Bound">d′</a><a id="6359" class="Symbol">)</a>
      <a id="6367" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6369" href="Graded.Heap.Usage.Properties.html#4676" class="Function">𝟘▸H→H≤𝟘</a> <a id="6377" class="Symbol">(</a><a id="6378" href="Graded.Heap.Usage.Properties.html#3795" class="Function">subₕ</a> <a id="6383" href="Graded.Heap.Soundness.html#5958" class="Bound">▸H</a> <a id="6386" class="Symbol">(</a><a id="6387" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
          <a id="6403" href="Graded.Heap.Soundness.html#5946" class="Bound">γ</a>                     <a id="6425" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="6428" href="Graded.Heap.Soundness.html#5972" class="Bound">γ≤</a> <a id="6431" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
          <a id="6443" href="Graded.Modality.html#899" class="Function">𝟙</a> <a id="6445" href="Graded.Context.html#1733" class="Function Operator">·ᶜ</a> <a id="6448" href="Graded.Context.Weakening.html#958" class="Function">wkConₘ</a> <a id="6455" href="Graded.Heap.Soundness.html#5890" class="Bound">ρ</a> <a id="6457" href="Graded.Heap.Soundness.html#5950" class="Bound">δ</a> <a id="6459" href="Graded.Context.html#1501" class="Function Operator">+ᶜ</a> <a id="6462" href="Graded.Context.html#2498" class="Function">𝟘ᶜ</a> <a id="6465" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="6468" href="Graded.Context.Properties.Addition.html#926" class="Function">+ᶜ-identityʳ</a> <a id="6481" class="Symbol">_</a> <a id="6483" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
          <a id="6495" href="Graded.Modality.html#899" class="Function">𝟙</a> <a id="6497" href="Graded.Context.html#1733" class="Function Operator">·ᶜ</a> <a id="6500" href="Graded.Context.Weakening.html#958" class="Function">wkConₘ</a> <a id="6507" href="Graded.Heap.Soundness.html#5890" class="Bound">ρ</a> <a id="6509" href="Graded.Heap.Soundness.html#5950" class="Bound">δ</a>       <a id="6517" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="6520" href="Graded.Context.Properties.Multiplication.html#701" class="Function">·ᶜ-identityˡ</a> <a id="6533" class="Symbol">_</a> <a id="6535" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
          <a id="6547" href="Graded.Context.Weakening.html#958" class="Function">wkConₘ</a> <a id="6554" href="Graded.Heap.Soundness.html#5890" class="Bound">ρ</a> <a id="6556" href="Graded.Heap.Soundness.html#5950" class="Bound">δ</a>            <a id="6569" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="6572" href="Graded.Context.Weakening.html#3188" class="Function">wk-≤ᶜ</a> <a id="6578" href="Graded.Heap.Soundness.html#5890" class="Bound">ρ</a> <a id="6580" class="Symbol">(</a><a id="6581" href="Graded.Usage.Inversion.html#8425" class="Function">inv-usage-numeral</a> <a id="6599" href="Graded.Heap.Soundness.html#5963" class="Bound">▸n</a> <a id="6602" href="Graded.Heap.Soundness.html#5902" class="Bound">num</a><a id="6605" class="Symbol">)</a> <a id="6607" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
          <a id="6619" href="Graded.Context.Weakening.html#958" class="Function">wkConₘ</a> <a id="6626" href="Graded.Heap.Soundness.html#5890" class="Bound">ρ</a> <a id="6628" href="Graded.Context.html#2498" class="Function">𝟘ᶜ</a>           <a id="6641" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="6644" href="Graded.Context.Weakening.html#1158" class="Function">wk-𝟘ᶜ</a> <a id="6650" href="Graded.Heap.Soundness.html#5890" class="Bound">ρ</a> <a id="6652" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
          <a id="6664" href="Graded.Context.html#2498" class="Function">𝟘ᶜ</a>                    <a id="6686" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a> <a id="6688" class="Symbol">))}</a>
    <a id="6696" class="Keyword">where</a>
    <a id="6706" href="Graded.Heap.Soundness.html#6706" class="Function">consistent</a> <a id="6717" class="Symbol">:</a> <a id="6719" href="Graded.Usage.Restrictions.html#1638" class="Function">Emptyrec-allowed</a> <a id="6736" href="Graded.Mode.html#1117" class="InductiveConstructor">𝟙ᵐ</a> <a id="6739" href="Graded.Modality.html#897" class="Function">𝟘</a> <a id="6741" class="Symbol">→</a> <a id="6743" href="Definition.Typed.html#21867" class="Function">Consistent</a> <a id="6754" href="Graded.Heap.Soundness.html#5608" class="Bound">Δ</a>
    <a id="6760" href="Graded.Heap.Soundness.html#6706" class="Function">consistent</a> <a id="6771" href="Graded.Heap.Soundness.html#6771" class="Bound">ok</a> <a id="6774" class="Symbol">=</a>
      <a id="6782" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="6787" href="Graded.Heap.Soundness.html#5611" class="Bound">as</a> <a id="6790" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="6793" class="Symbol">λ</a> <a id="6795" class="Keyword">where</a>
        <a id="6809" class="Symbol">(</a><a id="6810" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="6815" class="Symbol">(</a><a id="6816" href="Graded.Heap.Soundness.html#6816" class="Bound">c</a> <a id="6818" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6820" class="Symbol">_))</a> <a id="6824" class="Symbol">→</a> <a id="6826" href="Graded.Heap.Soundness.html#6816" class="Bound">c</a> <a id="6828" href="Graded.Heap.Soundness.html#6771" class="Bound">ok</a>
        <a id="6839" class="Symbol">(</a><a id="6840" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="6845" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a><a id="6852" class="Symbol">)</a> <a id="6854" class="Symbol">→</a>
          <a id="6866" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="6871" href="Tools.PropositionalEquality.html#2252" class="Function">PE.singleton</a> <a id="6884" href="Graded.Heap.Soundness.html#5608" class="Bound">Δ</a> <a id="6886" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="6889" class="Symbol">λ</a> <a id="6891" class="Keyword">where</a>
            <a id="6909" class="Symbol">(</a><a id="6910" href="Definition.Untyped.NotParametrised.html#926" class="InductiveConstructor">ε</a> <a id="6912" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6914" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a><a id="6921" class="Symbol">)</a> <a id="6923" class="Symbol">→</a> <a id="6925" class="Symbol">λ</a> <a id="6927" href="Graded.Heap.Soundness.html#6927" class="Bound">_</a> <a id="6929" class="Symbol">→</a> <a id="6931" href="Definition.Typed.Consequences.Canonicity.html#1915" class="Function">¬Empty</a>
    <a id="6942" href="Graded.Heap.Soundness.html#6942" class="Function">k≡0⊎erased-heap</a> <a id="6958" class="Symbol">:</a> <a id="6960" href="Graded.Heap.Soundness.html#5600" class="Bound">k</a> <a id="6962" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">PE.≡</a> <a id="6967" class="Number">0</a> <a id="6969" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="6971" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="6973" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a>
    <a id="6989" href="Graded.Heap.Soundness.html#6942" class="Function">k≡0⊎erased-heap</a> <a id="7005" class="Symbol">=</a>
      <a id="7013" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="7018" href="Graded.Heap.Soundness.html#5611" class="Bound">as</a> <a id="7021" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="7024" class="Symbol">λ</a> <a id="7026" class="Keyword">where</a>
        <a id="7040" class="Symbol">(</a><a id="7041" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="7046" href="Graded.Heap.Soundness.html#7046" class="Bound">x</a><a id="7047" class="Symbol">)</a> <a id="7049" class="Symbol">→</a> <a id="7051" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="7056" href="Graded.Heap.Soundness.html#7046" class="Bound">x</a>
        <a id="7066" class="Symbol">(</a><a id="7067" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="7072" class="Symbol">(_</a> <a id="7075" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7077" href="Graded.Heap.Soundness.html#7077" class="Bound">x</a><a id="7078" class="Symbol">))</a> <a id="7081" class="Symbol">→</a> <a id="7083" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="7088" href="Graded.Heap.Soundness.html#7077" class="Bound">x</a>

<a id="7091" class="Keyword">opaque</a>

  <a id="7101" class="Comment">-- The soundness property above specialized to closed terms</a>
  <a id="7163" class="Comment">-- All closed, well-typed and well-resourced terms of type ℕ reduce to some</a>
  <a id="7241" class="Comment">-- numeral and the resulting heap has all grades less than or equal to 𝟘.</a>

  <a id="7318" class="Comment">-- Note that some assumptions to this theorem are given as a module parameter.</a>

  <a id="soundness-closed"></a><a id="7400" href="Graded.Heap.Soundness.html#7400" class="Function">soundness-closed</a> <a id="7417" class="Symbol">:</a> <a id="7419" class="InductiveConstructor">ε</a> <a id="7421" href="Definition.Typed.html#1755" class="Datatype Operator">⊢</a> <a id="7423" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="7425" href="Definition.Typed.html#1755" class="Datatype Operator">∷</a> <a id="7427" href="Definition.Untyped.html#1668" class="InductiveConstructor">ℕ</a> <a id="7429" class="Symbol">→</a> <a id="7431" class="InductiveConstructor">ε</a> <a id="7433" href="Graded.Usage.html#14460" class="Function Operator">▸</a> <a id="7435" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a>
                   <a id="7456" class="Symbol">→</a> <a id="7458" href="Tools.Product.html#1014" class="Function">∃₅</a> <a id="7461" class="Symbol">λ</a> <a id="7463" href="Graded.Heap.Soundness.html#7463" class="Bound">m</a> <a id="7465" href="Graded.Heap.Soundness.html#7465" class="Bound">n</a> <a id="7467" href="Graded.Heap.Soundness.html#7467" class="Bound">H</a> <a id="7469" href="Graded.Heap.Soundness.html#7469" class="Bound">k</a> <a id="7471" class="Symbol">(</a><a id="7472" href="Graded.Heap.Soundness.html#7472" class="Bound">ρ</a> <a id="7474" class="Symbol">:</a> <a id="7476" href="Definition.Untyped.NotParametrised.html#2601" class="Datatype">Wk</a> <a id="7479" href="Graded.Heap.Soundness.html#7463" class="Bound">m</a> <a id="7481" href="Graded.Heap.Soundness.html#7465" class="Bound">n</a><a id="7482" class="Symbol">)</a> <a id="7484" class="Symbol">→</a>
                   <a id="7505" href="Graded.Heap.Untyped.html#10028" class="Function">initial</a> <a id="7513" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="7515" href="Graded.Heap.Reduction.html#5867" class="Datatype Operator">⇒*</a> <a id="7518" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟨</a> <a id="7520" href="Graded.Heap.Soundness.html#7467" class="Bound">H</a> <a id="7522" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="7524" href="Definition.Untyped.html#3622" class="Function">sucᵏ</a> <a id="7529" href="Graded.Heap.Soundness.html#7469" class="Bound">k</a> <a id="7531" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="7533" href="Graded.Heap.Soundness.html#7472" class="Bound">ρ</a> <a id="7535" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="7537" class="InductiveConstructor">ε</a> <a id="7539" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟩</a> <a id="7541" href="Data.Product.Base.html#1618" class="Function Operator">×</a>
                   <a id="7562" class="Symbol">(</a><a id="7563" class="InductiveConstructor">ε</a> <a id="7565" href="Definition.Typed.html#5482" class="Datatype Operator">⊢</a> <a id="7567" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="7569" href="Definition.Typed.html#5482" class="Datatype Operator">≡</a> <a id="7571" href="Definition.Untyped.html#3622" class="Function">sucᵏ</a> <a id="7576" href="Graded.Heap.Soundness.html#7469" class="Bound">k</a> <a id="7578" href="Definition.Typed.html#5482" class="Datatype Operator">∷</a> <a id="7580" href="Definition.Untyped.html#1668" class="InductiveConstructor">ℕ</a><a id="7581" class="Symbol">)</a> <a id="7583" href="Data.Product.Base.html#1618" class="Function Operator">×</a>
                   <a id="7604" href="Graded.Heap.Soundness.html#7467" class="Bound">H</a> <a id="7606" href="Graded.Heap.Usage.html#1317" class="Datatype Operator">≤ʰ</a> <a id="7609" href="Graded.Modality.html#897" class="Function">𝟘</a>
  <a id="7613" href="Graded.Heap.Soundness.html#7400" class="Function">soundness-closed</a> <a id="7630" class="Symbol">=</a> <a id="7632" href="Graded.Heap.Soundness.html#5291" class="Function">soundness</a> <a id="7642" class="Symbol">(</a><a id="7643" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="7648" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">PE.refl</a><a id="7655" class="Symbol">)</a>

<a id="7658" class="Keyword">opaque</a>

  <a id="7668" class="Comment">-- The soundness property above specialized to open terms</a>
  <a id="7728" class="Comment">-- Given some assumptions, all well-typed and erased types of type ℕ reduce to some</a>
  <a id="7814" class="Comment">-- numeral and the resulting heap has all grades less than or equal to 𝟘</a>

  <a id="7890" class="Comment">-- Note that some assumptions to this theorem are given as a module parameter.</a>

  <a id="soundness-open"></a><a id="7972" href="Graded.Heap.Soundness.html#7972" class="Function">soundness-open</a> <a id="7987" class="Symbol">:</a> <a id="7989" class="Symbol">(</a><a id="7990" href="Graded.Usage.Restrictions.html#1638" class="Function">Emptyrec-allowed</a> <a id="8007" class="InductiveConstructor">𝟙ᵐ</a> <a id="8010" href="Graded.Modality.html#897" class="Function">𝟘</a> <a id="8012" class="Symbol">→</a> <a id="8014" href="Definition.Typed.html#21867" class="Function">Consistent</a> <a id="8025" href="Graded.Heap.Soundness.html#2832" class="Generalizable">Δ</a><a id="8026" class="Symbol">)</a>
                   <a id="8047" class="Symbol">→</a> <a id="8049" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="8051" href="Graded.Heap.Soundness.html#485" class="Bound">erased-heap</a>
                   <a id="8082" class="Symbol">→</a> <a id="8084" href="Graded.Heap.Soundness.html#2832" class="Generalizable">Δ</a> <a id="8086" href="Definition.Typed.html#1755" class="Datatype Operator">⊢</a> <a id="8088" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="8090" href="Definition.Typed.html#1755" class="Datatype Operator">∷</a> <a id="8092" href="Definition.Untyped.html#1668" class="InductiveConstructor">ℕ</a> <a id="8094" class="Symbol">→</a> <a id="8096" href="Graded.Context.html#2498" class="Function">𝟘ᶜ</a> <a id="8099" href="Graded.Usage.html#14460" class="Function Operator">▸</a> <a id="8101" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a>
                   <a id="8122" class="Symbol">→</a> <a id="8124" href="Tools.Product.html#1014" class="Function">∃₅</a> <a id="8127" class="Symbol">λ</a> <a id="8129" href="Graded.Heap.Soundness.html#8129" class="Bound">m</a> <a id="8131" href="Graded.Heap.Soundness.html#8131" class="Bound">n</a> <a id="8133" href="Graded.Heap.Soundness.html#8133" class="Bound">H</a> <a id="8135" href="Graded.Heap.Soundness.html#8135" class="Bound">k</a> <a id="8137" class="Symbol">(</a><a id="8138" href="Graded.Heap.Soundness.html#8138" class="Bound">ρ</a> <a id="8140" class="Symbol">:</a> <a id="8142" href="Definition.Untyped.NotParametrised.html#2601" class="Datatype">Wk</a> <a id="8145" href="Graded.Heap.Soundness.html#8129" class="Bound">m</a> <a id="8147" href="Graded.Heap.Soundness.html#8131" class="Bound">n</a><a id="8148" class="Symbol">)</a> <a id="8150" class="Symbol">→</a>
                   <a id="8171" href="Graded.Heap.Untyped.html#10028" class="Function">initial</a> <a id="8179" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="8181" href="Graded.Heap.Reduction.html#5867" class="Datatype Operator">⇒*</a> <a id="8184" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟨</a> <a id="8186" href="Graded.Heap.Soundness.html#8133" class="Bound">H</a> <a id="8188" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="8190" href="Definition.Untyped.html#3622" class="Function">sucᵏ</a> <a id="8195" href="Graded.Heap.Soundness.html#8135" class="Bound">k</a> <a id="8197" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="8199" href="Graded.Heap.Soundness.html#8138" class="Bound">ρ</a> <a id="8201" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">,</a> <a id="8203" class="InductiveConstructor">ε</a> <a id="8205" href="Graded.Heap.Untyped.html#8847" class="InductiveConstructor Operator">⟩</a> <a id="8207" href="Data.Product.Base.html#1618" class="Function Operator">×</a>
                   <a id="8228" class="Symbol">(</a><a id="8229" href="Graded.Heap.Soundness.html#2832" class="Generalizable">Δ</a> <a id="8231" href="Definition.Typed.html#5482" class="Datatype Operator">⊢</a> <a id="8233" href="Graded.Heap.Soundness.html#2780" class="Generalizable">t</a> <a id="8235" href="Definition.Typed.html#5482" class="Datatype Operator">≡</a> <a id="8237" href="Definition.Untyped.html#3622" class="Function">sucᵏ</a> <a id="8242" href="Graded.Heap.Soundness.html#8135" class="Bound">k</a> <a id="8244" href="Definition.Typed.html#5482" class="Datatype Operator">∷</a> <a id="8246" href="Definition.Untyped.html#1668" class="InductiveConstructor">ℕ</a><a id="8247" class="Symbol">)</a> <a id="8249" href="Data.Product.Base.html#1618" class="Function Operator">×</a>
                   <a id="8270" href="Graded.Heap.Soundness.html#8133" class="Bound">H</a> <a id="8272" href="Graded.Heap.Usage.html#1317" class="Datatype Operator">≤ʰ</a> <a id="8275" href="Graded.Modality.html#897" class="Function">𝟘</a>
  <a id="8279" href="Graded.Heap.Soundness.html#7972" class="Function">soundness-open</a> <a id="8294" href="Graded.Heap.Soundness.html#8294" class="Bound">consistent</a> <a id="8305" href="Graded.Heap.Soundness.html#8305" class="Bound">erased</a> <a id="8312" class="Symbol">=</a> <a id="8314" href="Graded.Heap.Soundness.html#5291" class="Function">soundness</a> <a id="8324" class="Symbol">(</a><a id="8325" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="8330" class="Symbol">(</a><a id="8331" href="Graded.Heap.Soundness.html#8294" class="Bound">consistent</a> <a id="8342" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8344" href="Graded.Heap.Soundness.html#8305" class="Bound">erased</a><a id="8350" class="Symbol">))</a>
</pre></body></html>