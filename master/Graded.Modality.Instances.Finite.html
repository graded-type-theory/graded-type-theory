<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Graded.Modality.Instances.Finite</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- A finite semiring is a modality instance.</a>
<a id="119" class="Comment">------------------------------------------------------------------------</a>

<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Tools.Bool.html" class="Module">Tools.Bool</a> <a id="216" class="Keyword">hiding</a> <a id="223" class="Symbol">(</a><a id="224" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a><a id="227" class="Symbol">;</a> <a id="229" href="Tools.Bool.html#3136" class="Function">∧-decreasingˡ</a><a id="242" class="Symbol">;</a> <a id="244" href="Tools.Bool.html#3322" class="Function">∧-decreasingʳ</a><a id="257" class="Symbol">)</a>
<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Tools.Fin.html" class="Module">Tools.Fin</a>
<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Tools.Nat.html" class="Module">Tools.Nat</a> <a id="303" class="Keyword">using</a> <a id="309" class="Symbol">(</a><a id="310" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a><a id="313" class="Symbol">;</a> <a id="315" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a><a id="317" class="Symbol">)</a>
<a id="319" class="Keyword">open</a> <a id="324" class="Keyword">import</a> <a id="331" href="Tools.Product.html" class="Module">Tools.Product</a>
<a id="345" class="Keyword">open</a> <a id="350" class="Keyword">import</a> <a id="357" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>
<a id="385" class="Keyword">import</a> <a id="392" href="Graded.Modality.html" class="Module">Graded.Modality</a>

<a id="409" class="Keyword">module</a> <a id="416" href="Graded.Modality.Instances.Finite.html" class="Module">Graded.Modality.Instances.Finite</a>
  <a id="451" class="Symbol">{</a><a id="452" href="Graded.Modality.Instances.Finite.html#452" class="Bound">a</a><a id="453" class="Symbol">}</a> <a id="455" class="Symbol">{</a><a id="456" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a> <a id="458" class="Symbol">:</a> <a id="460" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="464" href="Graded.Modality.Instances.Finite.html#452" class="Bound">a</a><a id="465" class="Symbol">}</a>
  <a id="469" class="Symbol">(</a><a id="470" class="Keyword">open</a> <a id="475" href="Graded.Modality.html" class="Module">Graded.Modality</a> <a id="491" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="492" class="Symbol">)</a>
  <a id="496" class="Symbol">(</a><a id="497" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a> <a id="499" class="Symbol">:</a> <a id="501" href="Graded.Modality.html#620" class="Record">Semiring-with-meet</a><a id="519" class="Symbol">)</a>
  <a id="523" class="Symbol">(</a><a id="524" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a> <a id="528" class="Symbol">:</a> <a id="530" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="532" class="Symbol">λ</a> <a id="534" href="Graded.Modality.Instances.Finite.html#534" class="Bound">n</a> <a id="536" class="Symbol">→</a> <a id="538" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a> <a id="540" class="Symbol">(</a><a id="541" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="545" class="Symbol">(</a><a id="546" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="549" href="Graded.Modality.Instances.Finite.html#534" class="Bound">n</a><a id="550" class="Symbol">)</a> <a id="552" class="Symbol">→</a> <a id="554" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="555" class="Symbol">)</a>
                 <a id="574" class="Symbol">λ</a> <a id="576" href="Graded.Modality.Instances.Finite.html#576" class="Bound">f</a> <a id="578" class="Symbol">→</a> <a id="580" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a> <a id="582" class="Symbol">(</a><a id="583" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a> <a id="585" class="Symbol">→</a> <a id="587" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="591" class="Symbol">(</a><a id="592" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="595" href="Graded.Modality.Instances.Finite.html#534" class="Bound">n</a><a id="596" class="Symbol">))</a>
                 <a id="616" class="Symbol">λ</a> <a id="618" href="Graded.Modality.Instances.Finite.html#618" class="Bound">f⁻¹</a> <a id="622" class="Symbol">→</a> <a id="624" class="Symbol">((</a><a id="626" href="Graded.Modality.Instances.Finite.html#626" class="Bound">p</a> <a id="628" class="Symbol">:</a> <a id="630" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="631" class="Symbol">)</a> <a id="633" class="Symbol">→</a> <a id="635" href="Graded.Modality.Instances.Finite.html#576" class="Bound">f</a> <a id="637" class="Symbol">(</a><a id="638" href="Graded.Modality.Instances.Finite.html#618" class="Bound">f⁻¹</a> <a id="642" href="Graded.Modality.Instances.Finite.html#626" class="Bound">p</a><a id="643" class="Symbol">)</a> <a id="645" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="647" href="Graded.Modality.Instances.Finite.html#626" class="Bound">p</a><a id="648" class="Symbol">))</a>
  <a id="653" class="Keyword">where</a>

<a id="660" class="Keyword">private</a>
  <a id="670" class="Keyword">variable</a>
    <a id="683" href="Graded.Modality.Instances.Finite.html#683" class="Generalizable">n</a> <a id="685" class="Symbol">:</a> <a id="687" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>

<a id="692" class="Keyword">open</a> <a id="697" href="Graded.Modality.html#620" class="Module">Semiring-with-meet</a> <a id="716" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a>

<a id="719" class="Keyword">import</a> <a id="726" href="Graded.Modality.Instances.LowerBounded.html" class="Module">Graded.Modality.Instances.LowerBounded</a> <a id="765" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a> <a id="767" class="Symbol">as</a> <a id="LB"></a><a id="770" href="Graded.Modality.Instances.Finite.html#770" class="Module">LB</a>
<a id="773" class="Keyword">open</a> <a id="778" class="Keyword">import</a> <a id="785" href="Graded.Modality.Variant.html" class="Module">Graded.Modality.Variant</a> <a id="809" href="Graded.Modality.Instances.Finite.html#452" class="Bound">a</a>
<a id="811" class="Keyword">open</a> <a id="816" class="Keyword">import</a> <a id="823" href="Graded.Modality.Properties.Meet.html" class="Module">Graded.Modality.Properties.Meet</a> <a id="855" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a>
<a id="857" class="Keyword">open</a> <a id="862" class="Keyword">import</a> <a id="869" href="Graded.Modality.Properties.PartialOrder.html" class="Module">Graded.Modality.Properties.PartialOrder</a> <a id="909" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a>

<a id="912" class="Keyword">open</a> <a id="917" class="Keyword">import</a> <a id="924" href="Tools.Reasoning.PropositionalEquality.html" class="Module">Tools.Reasoning.PropositionalEquality</a>
<a id="962" class="Keyword">open</a> <a id="967" class="Keyword">import</a> <a id="974" href="Tools.Relation.html" class="Module">Tools.Relation</a> <a id="989" class="Symbol">as</a> <a id="992" class="Module">Dec</a>

<a id="|M|"></a><a id="997" href="Graded.Modality.Instances.Finite.html#997" class="Function">|M|</a> <a id="1001" class="Symbol">:</a> <a id="1003" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
<a id="1007" href="Graded.Modality.Instances.Finite.html#997" class="Function">|M|</a> <a id="1011" class="Symbol">=</a> <a id="1013" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="1016" class="Symbol">(</a><a id="1017" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1023" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a><a id="1026" class="Symbol">)</a>

<a id="f"></a><a id="1029" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="1031" class="Symbol">:</a> <a id="1033" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1037" href="Graded.Modality.Instances.Finite.html#997" class="Function">|M|</a> <a id="1041" class="Symbol">→</a> <a id="1043" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a>
<a id="1045" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="1047" class="Symbol">=</a> <a id="1049" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1062" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a><a id="1065" class="Symbol">)</a>

<a id="f⁻¹"></a><a id="1068" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="1072" class="Symbol">:</a> <a id="1074" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a> <a id="1076" class="Symbol">→</a> <a id="1078" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1082" href="Graded.Modality.Instances.Finite.html#997" class="Function">|M|</a>
<a id="1086" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="1090" class="Symbol">=</a> <a id="1092" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1098" class="Symbol">(</a><a id="1099" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1105" class="Symbol">(</a><a id="1106" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1112" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a><a id="1115" class="Symbol">))</a>

<a id="f-f⁻¹"></a><a id="1119" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="1125" class="Symbol">:</a> <a id="1127" class="Symbol">(</a><a id="1128" href="Graded.Modality.Instances.Finite.html#1128" class="Bound">p</a> <a id="1130" class="Symbol">:</a> <a id="1132" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1133" class="Symbol">)</a> <a id="1135" class="Symbol">→</a> <a id="1137" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="1139" class="Symbol">(</a><a id="1140" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="1144" href="Graded.Modality.Instances.Finite.html#1128" class="Bound">p</a><a id="1145" class="Symbol">)</a> <a id="1147" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1149" href="Graded.Modality.Instances.Finite.html#1128" class="Bound">p</a>
<a id="1151" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="1157" class="Symbol">=</a> <a id="1159" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1165" class="Symbol">(</a><a id="1166" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1172" class="Symbol">(</a><a id="1173" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1179" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a><a id="1182" class="Symbol">))</a>

<a id="1186" class="Comment">-- n-ary meet</a>

<a id="⋀"></a><a id="1201" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1203" class="Symbol">:</a> <a id="1205" class="Symbol">(</a><a id="1206" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1210" class="Symbol">(</a><a id="1211" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="1214" href="Graded.Modality.Instances.Finite.html#683" class="Generalizable">n</a><a id="1215" class="Symbol">)</a> <a id="1217" class="Symbol">→</a> <a id="1219" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1220" class="Symbol">)</a> <a id="1222" class="Symbol">→</a> <a id="1224" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a>
<a id="1226" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1228" class="Symbol">{</a><a id="1229" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">Nat.zero</a><a id="1237" class="Symbol">}</a> <a id="1239" href="Graded.Modality.Instances.Finite.html#1239" class="Bound">aₙ</a> <a id="1242" class="Symbol">=</a> <a id="1244" href="Graded.Modality.Instances.Finite.html#1239" class="Bound">aₙ</a> <a id="1247" href="Data.Fin.Base.html#1181" class="InductiveConstructor">x0</a>
<a id="1250" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1252" class="Symbol">{</a><a id="1253" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="1256" href="Graded.Modality.Instances.Finite.html#1256" class="Bound">n</a><a id="1257" class="Symbol">}</a> <a id="1259" href="Graded.Modality.Instances.Finite.html#1259" class="Bound">aₙ</a> <a id="1262" class="Symbol">=</a> <a id="1264" class="Symbol">(</a><a id="1265" href="Graded.Modality.Instances.Finite.html#1259" class="Bound">aₙ</a> <a id="1268" href="Data.Fin.Base.html#1181" class="InductiveConstructor">x0</a><a id="1270" class="Symbol">)</a> <a id="1272" href="Graded.Modality.html#929" class="Function Operator">∧</a> <a id="1274" class="Symbol">(</a><a id="1275" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1277" class="Symbol">(λ</a> <a id="1280" href="Graded.Modality.Instances.Finite.html#1280" class="Bound">x</a> <a id="1282" class="Symbol">→</a> <a id="1284" href="Graded.Modality.Instances.Finite.html#1259" class="Bound">aₙ</a> <a id="1287" class="Symbol">(</a><a id="1288" href="Graded.Modality.Instances.Finite.html#1280" class="Bound">x</a> <a id="1290" href="Data.Fin.Base.html#1202" class="InductiveConstructor Operator">+1</a><a id="1292" class="Symbol">)))</a>

<a id="1297" class="Comment">-- ∞ is the meet of all elements</a>

<a id="∞"></a><a id="1331" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="1333" class="Symbol">:</a> <a id="1335" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a>
<a id="1337" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="1339" class="Symbol">=</a> <a id="1341" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1343" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a>

<a id="1346" class="Comment">-- ⋀ is decreasing (i.e. smaller than all its arguments)</a>

<a id="⋀-decr"></a><a id="1404" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1411" class="Symbol">:</a> <a id="1413" class="Symbol">(</a><a id="1414" href="Graded.Modality.Instances.Finite.html#1414" class="Bound">f</a> <a id="1416" class="Symbol">:</a> <a id="1418" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1422" class="Symbol">(</a><a id="1423" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="1426" href="Graded.Modality.Instances.Finite.html#683" class="Generalizable">n</a><a id="1427" class="Symbol">)</a> <a id="1429" class="Symbol">→</a> <a id="1431" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1432" class="Symbol">)</a> <a id="1434" class="Symbol">→</a> <a id="1436" class="Symbol">(</a><a id="1437" href="Graded.Modality.Instances.Finite.html#1437" class="Bound">x</a> <a id="1439" class="Symbol">:</a> <a id="1441" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1445" class="Symbol">(</a><a id="1446" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="1449" href="Graded.Modality.Instances.Finite.html#683" class="Generalizable">n</a><a id="1450" class="Symbol">))</a> <a id="1453" class="Symbol">→</a> <a id="1455" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1457" href="Graded.Modality.Instances.Finite.html#1414" class="Bound">f</a> <a id="1459" href="Graded.Modality.html#1384" class="Function Operator">≤</a> <a id="1461" href="Graded.Modality.Instances.Finite.html#1414" class="Bound">f</a> <a id="1463" href="Graded.Modality.Instances.Finite.html#1437" class="Bound">x</a>
<a id="1465" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1472" class="Symbol">{</a><a id="1473" class="Argument">n</a> <a id="1475" class="Symbol">=</a> <a id="1477" class="Number">0</a><a id="1478" class="Symbol">}</a>    <a id="1483" class="Symbol">_</a> <a id="1485" class="Symbol">(()</a> <a id="1489" href="Data.Fin.Base.html#1202" class="InductiveConstructor Operator">+1</a><a id="1491" class="Symbol">)</a>
<a id="1493" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1500" class="Symbol">{</a><a id="1501" class="Argument">n</a> <a id="1503" class="Symbol">=</a> <a id="1505" class="Number">0</a><a id="1506" class="Symbol">}</a>    <a id="1511" class="Symbol">_</a> <a id="1513" href="Data.Fin.Base.html#1181" class="InductiveConstructor">x0</a>      <a id="1521" class="Symbol">=</a> <a id="1523" href="Graded.Modality.Properties.PartialOrder.html#571" class="Function">≤-refl</a>
<a id="1530" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1537" class="Symbol">{</a><a id="1538" class="Argument">n</a> <a id="1540" class="Symbol">=</a> <a id="1542" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="1545" class="Symbol">_}</a> <a id="1548" class="Symbol">_</a> <a id="1550" href="Data.Fin.Base.html#1181" class="InductiveConstructor">x0</a>      <a id="1558" class="Symbol">=</a> <a id="1560" href="Graded.Modality.Properties.Meet.html#1916" class="Function">∧-decreasingˡ</a> <a id="1574" class="Symbol">_</a> <a id="1576" class="Symbol">_</a>
<a id="1578" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1585" class="Symbol">{</a><a id="1586" class="Argument">n</a> <a id="1588" class="Symbol">=</a> <a id="1590" href="Tools.Nat.html#2170" class="InductiveConstructor">1+</a> <a id="1593" class="Symbol">_}</a> <a id="1596" href="Graded.Modality.Instances.Finite.html#1596" class="Bound">f</a> <a id="1598" class="Symbol">(</a><a id="1599" href="Graded.Modality.Instances.Finite.html#1599" class="Bound">x</a> <a id="1601" href="Data.Fin.Base.html#1202" class="InductiveConstructor Operator">+1</a><a id="1603" class="Symbol">)</a>  <a id="1606" class="Symbol">=</a>
  <a id="1610" href="Graded.Modality.Properties.PartialOrder.html#668" class="Function">≤-trans</a> <a id="1618" class="Symbol">(</a><a id="1619" href="Graded.Modality.Properties.Meet.html#2216" class="Function">∧-decreasingʳ</a> <a id="1633" class="Symbol">_</a> <a id="1635" class="Symbol">_)</a> <a id="1638" class="Symbol">(</a><a id="1639" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1646" class="Symbol">(λ</a> <a id="1649" href="Graded.Modality.Instances.Finite.html#1649" class="Bound">x</a> <a id="1651" class="Symbol">→</a> <a id="1653" href="Graded.Modality.Instances.Finite.html#1596" class="Bound">f</a> <a id="1655" class="Symbol">(</a><a id="1656" href="Graded.Modality.Instances.Finite.html#1649" class="Bound">x</a> <a id="1658" href="Data.Fin.Base.html#1202" class="InductiveConstructor Operator">+1</a><a id="1660" class="Symbol">))</a> <a id="1663" href="Graded.Modality.Instances.Finite.html#1599" class="Bound">x</a><a id="1664" class="Symbol">)</a>

<a id="1667" class="Comment">-- ∞ is the least element</a>

<a id="∞-min"></a><a id="1694" href="Graded.Modality.Instances.Finite.html#1694" class="Function">∞-min</a> <a id="1700" class="Symbol">:</a> <a id="1702" class="Symbol">(</a><a id="1703" href="Graded.Modality.Instances.Finite.html#1703" class="Bound">p</a> <a id="1705" class="Symbol">:</a> <a id="1707" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1708" class="Symbol">)</a> <a id="1710" class="Symbol">→</a> <a id="1712" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="1714" href="Graded.Modality.html#1384" class="Function Operator">≤</a> <a id="1716" href="Graded.Modality.Instances.Finite.html#1703" class="Bound">p</a>
<a id="1718" href="Graded.Modality.Instances.Finite.html#1694" class="Function">∞-min</a> <a id="1724" href="Graded.Modality.Instances.Finite.html#1724" class="Bound">p</a> <a id="1726" class="Symbol">=</a> <a id="1728" href="Graded.Modality.Properties.PartialOrder.html#668" class="Function">≤-trans</a> <a id="1736" class="Symbol">(</a><a id="1737" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1744" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="1746" class="Symbol">(</a><a id="1747" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="1751" href="Graded.Modality.Instances.Finite.html#1724" class="Bound">p</a><a id="1752" class="Symbol">))</a> <a id="1755" class="Symbol">(</a><a id="1756" href="Graded.Modality.Properties.PartialOrder.html#1013" class="Function">≤-reflexive</a> <a id="1768" class="Symbol">(</a><a id="1769" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="1775" href="Graded.Modality.Instances.Finite.html#1724" class="Bound">p</a><a id="1776" class="Symbol">))</a>

<a id="1780" class="Comment">-- The least element can be used to define a natrec-star operator.</a>

<a id="has-star"></a><a id="1848" href="Graded.Modality.Instances.Finite.html#1848" class="Function">has-star</a> <a id="1857" class="Symbol">:</a> <a id="1859" href="Graded.Modality.html#8342" class="Record">Has-star</a> <a id="1868" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a>
<a id="1870" href="Graded.Modality.Instances.Finite.html#1848" class="Function">has-star</a> <a id="1879" class="Symbol">=</a> <a id="1881" href="Graded.Modality.Instances.LowerBounded.html#4308" class="Function">LB.has-star</a> <a id="1893" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="1895" href="Graded.Modality.Instances.Finite.html#1694" class="Function">∞-min</a>

<a id="1902" class="Keyword">opaque</a>

  <a id="1912" class="Comment">-- Equality is decidable for M.</a>

  <a id="1947" class="Keyword">infix</a> <a id="1953" class="Number">10</a> <a id="1956" href="Graded.Modality.Instances.Finite.html#1963" class="Function Operator">_≟_</a>

  <a id="_≟_"></a><a id="1963" href="Graded.Modality.Instances.Finite.html#1963" class="Function Operator">_≟_</a> <a id="1967" class="Symbol">:</a> <a id="1969" href="Relation.Binary.Definitions.html#6713" class="Function">Decidable</a> <a id="1979" class="Symbol">(</a><a id="1980" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a> <a id="1984" class="Symbol">{</a><a id="1985" class="Argument">A</a> <a id="1987" class="Symbol">=</a> <a id="1989" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1990" class="Symbol">})</a>
  <a id="1995" href="Graded.Modality.Instances.Finite.html#1995" class="Bound">p</a> <a id="1997" href="Graded.Modality.Instances.Finite.html#1963" class="Function Operator">≟</a> <a id="1999" href="Graded.Modality.Instances.Finite.html#1999" class="Bound">q</a> <a id="2001" class="Symbol">=</a>
    <a id="2007" href="Tools.Relation.html#700" class="Function">Dec.map</a>
      <a id="2021" class="Symbol">(λ</a> <a id="2024" href="Graded.Modality.Instances.Finite.html#2024" class="Bound">f⁻¹p≡f⁻¹q</a> <a id="2034" class="Symbol">→</a>
         <a id="2045" href="Graded.Modality.Instances.Finite.html#1995" class="Bound">p</a>          <a id="2056" href="Relation.Binary.Reasoning.Syntax.html#11539" class="Function">≡˘⟨</a> <a id="2060" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="2066" class="Symbol">_</a> <a id="2068" href="Relation.Binary.Reasoning.Syntax.html#11539" class="Function">⟩</a>
         <a id="2079" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="2081" class="Symbol">(</a><a id="2082" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="2086" href="Graded.Modality.Instances.Finite.html#1995" class="Bound">p</a><a id="2087" class="Symbol">)</a>  <a id="2090" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="2093" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="2098" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="2100" href="Graded.Modality.Instances.Finite.html#2024" class="Bound">f⁻¹p≡f⁻¹q</a> <a id="2110" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
         <a id="2121" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="2123" class="Symbol">(</a><a id="2124" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="2128" href="Graded.Modality.Instances.Finite.html#1999" class="Bound">q</a><a id="2129" class="Symbol">)</a>  <a id="2132" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="2135" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="2141" class="Symbol">_</a> <a id="2143" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
         <a id="2154" href="Graded.Modality.Instances.Finite.html#1999" class="Bound">q</a>          <a id="2165" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a><a id="2166" class="Symbol">)</a>
      <a id="2174" class="Symbol">(</a><a id="2175" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="2180" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a><a id="2183" class="Symbol">)</a>
      <a id="2191" class="Symbol">(</a><a id="2192" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="2196" href="Graded.Modality.Instances.Finite.html#1995" class="Bound">p</a> <a id="2198" href="Tools.Fin.html#267" class="Function Operator">≟ⱽ</a> <a id="2201" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="2205" href="Graded.Modality.Instances.Finite.html#1999" class="Bound">q</a><a id="2206" class="Symbol">)</a>

<a id="2209" class="Comment">-- If certain properties hold, then 𝕄 can be turned into a certain</a>
<a id="2276" class="Comment">-- kind of modality.</a>

<a id="isModality"></a><a id="2298" href="Graded.Modality.Instances.Finite.html#2298" class="Function">isModality</a> <a id="2309" class="Symbol">:</a>
  <a id="2313" class="Symbol">(</a><a id="2314" href="Graded.Modality.Instances.Finite.html#2314" class="Bound">variant</a> <a id="2322" class="Symbol">:</a> <a id="2324" href="Graded.Modality.Variant.html#362" class="Record">Modality-variant</a><a id="2340" class="Symbol">)</a> <a id="2342" class="Symbol">→</a>
  <a id="2346" class="Keyword">let</a> <a id="2350" class="Keyword">open</a> <a id="2355" href="Graded.Modality.Variant.html#362" class="Module">Modality-variant</a> <a id="2372" href="Graded.Modality.Instances.Finite.html#2314" class="Bound">variant</a> <a id="2380" class="Keyword">in</a>
  <a id="2385" class="Symbol">(</a><a id="2386" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="2388" href="Graded.Modality.Variant.html#472" class="Field">𝟘ᵐ-allowed</a> <a id="2399" class="Symbol">→</a> <a id="2401" href="Graded.Modality.html#4341" class="Record">Has-well-behaved-zero</a> <a id="2423" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a><a id="2424" class="Symbol">)</a> <a id="2426" class="Symbol">→</a>
  <a id="2430" href="Graded.Modality.html#9574" class="Record">Modality</a>
<a id="2439" href="Graded.Modality.Instances.Finite.html#2298" class="Function">isModality</a> <a id="2450" class="Symbol">=</a> <a id="2452" href="Graded.Modality.Instances.LowerBounded.html#4744" class="Function">LB.isModality</a> <a id="2466" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="2468" href="Graded.Modality.Instances.Finite.html#1694" class="Function">∞-min</a>
</pre></body></html>