<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Graded.Erasure.Consequences.Soundness</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Soundness of the extraction function.</a>
<a id="115" class="Comment">------------------------------------------------------------------------</a>

<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Graded.Modality.html" class="Module">Graded.Modality</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Graded.Restrictions.html" class="Module">Graded.Restrictions</a>
  <a id="251" class="Keyword">using</a> <a id="257" class="Symbol">(</a><a id="258" href="Graded.Restrictions.html#2209" class="Function">No-erased-matches</a><a id="275" class="Symbol">)</a>
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Graded.Usage.Restrictions.html" class="Module">Graded.Usage.Restrictions</a>
<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Definition.Typed.EqualityRelation.html" class="Module">Definition.Typed.EqualityRelation</a>
<a id="361" class="Keyword">import</a> <a id="368" href="Definition.Untyped.html" class="Module">Definition.Untyped</a> <a id="387" class="Keyword">hiding</a> <a id="394" class="Symbol">(</a><a id="395" href="Definition.Untyped.NotParametrised.html#1138" class="InductiveConstructor Operator">_∷_</a><a id="398" class="Symbol">)</a>
<a id="400" class="Keyword">open</a> <a id="405" class="Keyword">import</a> <a id="412" href="Definition.Typed.Restrictions.html" class="Module">Definition.Typed.Restrictions</a>
<a id="442" class="Keyword">import</a> <a id="449" href="Definition.Typed.html" class="Module">Definition.Typed</a>
<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Tools.Empty.html" class="Module">Tools.Empty</a>
<a id="490" class="Keyword">open</a> <a id="495" class="Keyword">import</a> <a id="502" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>
<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="Tools.Sum.html" class="Module">Tools.Sum</a>

<a id="553" class="Keyword">module</a> <a id="560" href="Graded.Erasure.Consequences.Soundness.html" class="Module">Graded.Erasure.Consequences.Soundness</a>
  <a id="600" class="Symbol">{</a><a id="601" href="Graded.Erasure.Consequences.Soundness.html#601" class="Bound">a</a> <a id="603" href="Graded.Erasure.Consequences.Soundness.html#603" class="Bound">k</a><a id="604" class="Symbol">}</a> <a id="606" class="Symbol">{</a><a id="607" href="Graded.Erasure.Consequences.Soundness.html#607" class="Bound">M</a> <a id="609" class="Symbol">:</a> <a id="611" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="615" href="Graded.Erasure.Consequences.Soundness.html#601" class="Bound">a</a><a id="616" class="Symbol">}</a>
  <a id="620" class="Symbol">(</a><a id="621" class="Keyword">open</a> <a id="626" href="Definition.Untyped.html" class="Module">Definition.Untyped</a> <a id="645" href="Graded.Erasure.Consequences.Soundness.html#607" class="Bound">M</a><a id="646" class="Symbol">)</a>
  <a id="650" class="Symbol">(</a><a id="651" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a> <a id="653" class="Symbol">:</a> <a id="655" href="Graded.Modality.html#5150" class="Record">Modality</a> <a id="664" href="Graded.Erasure.Consequences.Soundness.html#607" class="Bound">M</a><a id="665" class="Symbol">)</a>
  <a id="669" class="Symbol">(</a><a id="670" class="Keyword">open</a> <a id="675" href="Graded.Modality.html#5150" class="Module">Modality</a> <a id="684" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a><a id="685" class="Symbol">)</a>
  <a id="689" class="Symbol">(</a><a id="690" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a> <a id="693" class="Symbol">:</a> <a id="695" href="Definition.Typed.Restrictions.html#406" class="Record">Type-restrictions</a> <a id="713" href="Graded.Erasure.Consequences.Soundness.html#607" class="Bound">M</a><a id="714" class="Symbol">)</a>
  <a id="718" class="Symbol">(</a><a id="719" class="Keyword">open</a> <a id="724" href="Definition.Typed.html" class="Module">Definition.Typed</a> <a id="741" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a><a id="743" class="Symbol">)</a>
  <a id="747" class="Symbol">(</a><a id="748" href="Graded.Erasure.Consequences.Soundness.html#748" class="Bound">UR</a> <a id="751" class="Symbol">:</a> <a id="753" href="Graded.Usage.Restrictions.html#316" class="Record">Usage-restrictions</a> <a id="772" href="Graded.Erasure.Consequences.Soundness.html#607" class="Bound">M</a><a id="773" class="Symbol">)</a>
  <a id="777" class="Symbol">{</a><a id="778" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="780" class="Symbol">:</a> <a id="782" href="Definition.Untyped.NotParametrised.html#781" class="Datatype">Con</a> <a id="786" href="Definition.Untyped.html#1988" class="Datatype">Term</a> <a id="791" href="Graded.Erasure.Consequences.Soundness.html#603" class="Bound">k</a><a id="792" class="Symbol">}</a> <a id="794" class="Symbol">(</a><a id="795" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a> <a id="798" class="Symbol">:</a> <a id="800" href="Definition.Typed.html#964" class="Datatype Operator">⊢</a> <a id="802" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a><a id="803" class="Symbol">)</a>
  <a id="807" class="Symbol">(</a><a id="808" href="Graded.Erasure.Consequences.Soundness.html#808" class="Bound">𝟘-well-behaved</a> <a id="823" class="Symbol">:</a> <a id="825" href="Graded.Modality.html#2702" class="Record">Has-well-behaved-zero</a> <a id="847" href="Graded.Erasure.Consequences.Soundness.html#607" class="Bound">M</a> <a id="849" href="Graded.Modality.html#3946" class="Function">semiring-with-meet</a><a id="867" class="Symbol">)</a>
  <a id="871" class="Symbol">(</a><a id="872" href="Graded.Erasure.Consequences.Soundness.html#872" class="Bound">consistent</a> <a id="883" class="Symbol">:</a> <a id="885" class="Symbol">∀</a> <a id="887" class="Symbol">{</a><a id="888" href="Graded.Erasure.Consequences.Soundness.html#888" class="Bound">t</a><a id="889" class="Symbol">}</a> <a id="891" class="Symbol">→</a> <a id="893" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="895" href="Definition.Typed.html#1461" class="Datatype Operator">⊢</a> <a id="897" href="Graded.Erasure.Consequences.Soundness.html#888" class="Bound">t</a> <a id="899" href="Definition.Typed.html#1461" class="Datatype Operator">∷</a> <a id="901" href="Definition.Untyped.html#2521" class="InductiveConstructor">Empty</a> <a id="907" class="Symbol">→</a> <a id="909" href="Data.Empty.html#526" class="Datatype">⊥</a><a id="910" class="Symbol">)</a>
  <a id="914" class="Comment">-- Erased matches are not allowed unless the context</a>
  <a id="969" class="Comment">-- is empty</a>
  <a id="983" class="Symbol">(</a><a id="984" href="Graded.Erasure.Consequences.Soundness.html#984" class="Bound">no-erased-matches</a> <a id="1002" class="Symbol">:</a> <a id="1004" href="Graded.Restrictions.html#2209" class="Function">No-erased-matches</a> <a id="1022" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a> <a id="1024" href="Graded.Erasure.Consequences.Soundness.html#748" class="Bound">UR</a> <a id="1027" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1029" href="Graded.Erasure.Consequences.Soundness.html#603" class="Bound">k</a> <a id="1031" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1033" class="Number">0</a><a id="1034" class="Symbol">)</a>
  <a id="1038" class="Symbol">{{</a><a id="1040" href="Graded.Erasure.Consequences.Soundness.html#1040" class="Bound">eqrel</a> <a id="1046" class="Symbol">:</a> <a id="1048" href="Definition.Typed.EqualityRelation.html#964" class="Record">EqRelSet</a> <a id="1057" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a><a id="1059" class="Symbol">}}</a>
  <a id="1064" class="Keyword">where</a>

<a id="1071" class="Keyword">open</a> <a id="1076" href="Definition.Typed.EqualityRelation.html#964" class="Module">EqRelSet</a> <a id="1085" class="Symbol">{{...}}</a>

<a id="1094" class="Keyword">open</a> <a id="1099" class="Keyword">import</a> <a id="1106" href="Definition.Typed.Consequences.Inversion.html" class="Module">Definition.Typed.Consequences.Inversion</a> <a id="1146" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a>
<a id="1149" class="Keyword">open</a> <a id="1154" class="Keyword">import</a> <a id="1161" href="Definition.Typed.Consequences.Syntactic.html" class="Module">Definition.Typed.Consequences.Syntactic</a> <a id="1201" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a>
<a id="1204" class="Keyword">open</a> <a id="1209" class="Keyword">import</a> <a id="1216" href="Definition.Typed.Properties.html" class="Module">Definition.Typed.Properties</a> <a id="1244" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a>
<a id="1247" class="Keyword">open</a> <a id="1252" class="Keyword">import</a> <a id="1259" href="Definition.LogicalRelation.html" class="Module">Definition.LogicalRelation</a> <a id="1286" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a>

<a id="1290" class="Keyword">open</a> <a id="1295" class="Keyword">import</a> <a id="1302" href="Graded.Context.html" class="Module">Graded.Context</a> <a id="1317" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a>
<a id="1319" class="Keyword">open</a> <a id="1324" class="Keyword">import</a> <a id="1331" href="Graded.Usage.html" class="Module">Graded.Usage</a> <a id="1344" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a> <a id="1346" href="Graded.Erasure.Consequences.Soundness.html#748" class="Bound">UR</a>
<a id="1349" class="Keyword">open</a> <a id="1354" class="Keyword">import</a> <a id="1361" href="Graded.Modality.Properties.Has-well-behaved-zero.html" class="Module">Graded.Modality.Properties.Has-well-behaved-zero</a>
  <a id="1412" href="Graded.Modality.html#5192" class="Field">semiring-with-meet-and-star</a> <a id="1440" href="Graded.Erasure.Consequences.Soundness.html#808" class="Bound">𝟘-well-behaved</a>
<a id="1455" class="Keyword">open</a> <a id="1460" class="Keyword">import</a> <a id="1467" href="Graded.Mode.html" class="Module">Graded.Mode</a> <a id="1479" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a>

<a id="1482" class="Keyword">import</a> <a id="1489" href="Graded.Erasure.Target.html" class="Module">Graded.Erasure.Target</a> <a id="1511" class="Symbol">as</a> <a id="1514" class="Module">T</a>
<a id="1516" class="Keyword">open</a> <a id="1521" class="Keyword">import</a> <a id="1528" href="Graded.Erasure.Extraction.html" class="Module">Graded.Erasure.Extraction</a> <a id="1554" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a> <a id="1556" href="Graded.Modality.html#2912" class="Function">is-𝟘?</a>
<a id="1562" class="Keyword">open</a> <a id="1567" class="Keyword">import</a> <a id="1574" href="Graded.Erasure.SucRed.html" class="Module">Graded.Erasure.SucRed</a> <a id="1596" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a>
<a id="1599" class="Keyword">open</a> <a id="1604" class="Keyword">import</a> <a id="1611" href="Graded.Erasure.LogicalRelation.html" class="Module">Graded.Erasure.LogicalRelation</a> <a id="1642" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a> <a id="1644" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a> <a id="1647" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a> <a id="1650" href="Graded.Modality.html#2912" class="Function">is-𝟘?</a>
<a id="1656" class="Keyword">open</a> <a id="1661" class="Keyword">import</a> <a id="1668" href="Graded.Erasure.LogicalRelation.Fundamental.html" class="Module">Graded.Erasure.LogicalRelation.Fundamental</a>
  <a id="1713" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a> <a id="1715" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a> <a id="1718" href="Graded.Erasure.Consequences.Soundness.html#748" class="Bound">UR</a> <a id="1721" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a> <a id="1724" href="Graded.Erasure.Consequences.Soundness.html#808" class="Bound">𝟘-well-behaved</a> <a id="1739" href="Graded.Erasure.Consequences.Soundness.html#872" class="Bound">consistent</a> <a id="1750" href="Graded.Erasure.Consequences.Soundness.html#984" class="Bound">no-erased-matches</a>
<a id="1768" class="Keyword">open</a> <a id="1773" class="Keyword">import</a> <a id="1780" href="Graded.Erasure.LogicalRelation.Irrelevance.html" class="Module">Graded.Erasure.LogicalRelation.Irrelevance</a> <a id="1823" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a> <a id="1825" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a> <a id="1828" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a> <a id="1831" href="Graded.Modality.html#2912" class="Function">is-𝟘?</a>
<a id="1837" class="Keyword">open</a> <a id="1842" class="Keyword">import</a> <a id="1849" href="Graded.Erasure.LogicalRelation.Subsumption.html" class="Module">Graded.Erasure.LogicalRelation.Subsumption</a> <a id="1892" href="Graded.Erasure.Consequences.Soundness.html#651" class="Bound">𝕄</a> <a id="1894" href="Graded.Erasure.Consequences.Soundness.html#690" class="Bound">TR</a> <a id="1897" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a> <a id="1900" href="Graded.Modality.html#2912" class="Function">is-𝟘?</a>

<a id="1907" class="Keyword">open</a> <a id="1912" class="Keyword">import</a> <a id="1919" href="Tools.Nat.html" class="Module">Tools.Nat</a>
<a id="1929" class="Keyword">open</a> <a id="1934" class="Keyword">import</a> <a id="1941" href="Tools.Product.html" class="Module">Tools.Product</a>


<a id="1957" class="Keyword">private</a>
  <a id="1967" class="Keyword">variable</a>
    <a id="1980" href="Graded.Erasure.Consequences.Soundness.html#1980" class="Generalizable">n</a> <a id="1982" class="Symbol">:</a> <a id="1984" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a>
    <a id="1992" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="1994" href="Graded.Erasure.Consequences.Soundness.html#1994" class="Generalizable">t′</a> <a id="1997" href="Graded.Erasure.Consequences.Soundness.html#1997" class="Generalizable">u</a> <a id="1999" href="Graded.Erasure.Consequences.Soundness.html#1999" class="Generalizable">F</a> <a id="2001" class="Symbol">:</a> <a id="2003" href="Definition.Untyped.html#1988" class="Datatype">Term</a> <a id="2008" href="Graded.Erasure.Consequences.Soundness.html#1980" class="Generalizable">n</a>
    <a id="2014" href="Graded.Erasure.Consequences.Soundness.html#2014" class="Generalizable">G</a> <a id="2016" class="Symbol">:</a> <a id="2018" href="Definition.Untyped.html#1988" class="Datatype">Term</a> <a id="2023" class="Symbol">(</a><a id="2024" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="2027" href="Graded.Erasure.Consequences.Soundness.html#1980" class="Generalizable">n</a><a id="2028" class="Symbol">)</a>
    <a id="2034" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="2036" href="Graded.Erasure.Consequences.Soundness.html#2036" class="Generalizable">v′</a> <a id="2039" href="Graded.Erasure.Consequences.Soundness.html#2039" class="Generalizable">w</a> <a id="2041" class="Symbol">:</a> <a id="2043" href="Graded.Erasure.Target.html#517" class="Datatype">T.Term</a> <a id="2050" href="Graded.Erasure.Consequences.Soundness.html#1980" class="Generalizable">n</a>

<a id="2053" class="Comment">-- WH reduction soundness of natural numbers</a>

<a id="2099" class="Comment">-- Canonical representation of natural numbers</a>

<a id="sucᵏ"></a><a id="2147" href="Graded.Erasure.Consequences.Soundness.html#2147" class="Function">sucᵏ</a> <a id="2152" class="Symbol">:</a> <a id="2154" class="Symbol">(</a><a id="2155" href="Graded.Erasure.Consequences.Soundness.html#2155" class="Bound">k</a> <a id="2157" class="Symbol">:</a> <a id="2159" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a><a id="2162" class="Symbol">)</a> <a id="2164" class="Symbol">→</a> <a id="2166" href="Definition.Untyped.html#1988" class="Datatype">Term</a> <a id="2171" href="Graded.Erasure.Consequences.Soundness.html#1980" class="Generalizable">n</a>
<a id="2173" href="Graded.Erasure.Consequences.Soundness.html#2147" class="Function">sucᵏ</a> <a id="2178" class="Number">0</a>      <a id="2185" class="Symbol">=</a> <a id="2187" href="Definition.Untyped.html#3526" class="InductiveConstructor">zero</a>
<a id="2192" href="Graded.Erasure.Consequences.Soundness.html#2147" class="Function">sucᵏ</a> <a id="2197" class="Symbol">(</a><a id="2198" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="2201" href="Graded.Erasure.Consequences.Soundness.html#2201" class="Bound">n</a><a id="2202" class="Symbol">)</a> <a id="2204" class="Symbol">=</a> <a id="2206" href="Definition.Untyped.html#3557" class="InductiveConstructor">suc</a> <a id="2210" class="Symbol">(</a><a id="2211" href="Graded.Erasure.Consequences.Soundness.html#2147" class="Function">sucᵏ</a> <a id="2216" href="Graded.Erasure.Consequences.Soundness.html#2201" class="Bound">n</a><a id="2217" class="Symbol">)</a>

<a id="sucᵏ′"></a><a id="2220" href="Graded.Erasure.Consequences.Soundness.html#2220" class="Function">sucᵏ′</a> <a id="2226" class="Symbol">:</a> <a id="2228" class="Symbol">(</a><a id="2229" href="Graded.Erasure.Consequences.Soundness.html#2229" class="Bound">k</a> <a id="2231" class="Symbol">:</a> <a id="2233" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a><a id="2236" class="Symbol">)</a> <a id="2238" class="Symbol">→</a> <a id="2240" href="Graded.Erasure.Target.html#517" class="Datatype">T.Term</a> <a id="2247" href="Graded.Erasure.Consequences.Soundness.html#1980" class="Generalizable">n</a>
<a id="2249" href="Graded.Erasure.Consequences.Soundness.html#2220" class="Function">sucᵏ′</a> <a id="2255" class="Number">0</a>      <a id="2262" class="Symbol">=</a> <a id="2264" href="Graded.Erasure.Target.html#825" class="InductiveConstructor">T.zero</a>
<a id="2271" href="Graded.Erasure.Consequences.Soundness.html#2220" class="Function">sucᵏ′</a> <a id="2277" class="Symbol">(</a><a id="2278" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="2281" href="Graded.Erasure.Consequences.Soundness.html#2281" class="Bound">n</a><a id="2282" class="Symbol">)</a> <a id="2284" class="Symbol">=</a> <a id="2286" href="Graded.Erasure.Target.html#846" class="InductiveConstructor">T.suc</a> <a id="2292" class="Symbol">(</a><a id="2293" href="Graded.Erasure.Consequences.Soundness.html#2220" class="Function">sucᵏ′</a> <a id="2299" href="Graded.Erasure.Consequences.Soundness.html#2281" class="Bound">n</a><a id="2300" class="Symbol">)</a>

<a id="2303" class="Comment">-- Helper lemma for WH reduction soundness of zero</a>
<a id="2354" class="Comment">-- If t ® v ∷ℕ  and t ⇒* zero then v ⇒* zero</a>

<a id="soundness-zero′"></a><a id="2400" href="Graded.Erasure.Consequences.Soundness.html#2400" class="Function">soundness-zero′</a> <a id="2416" class="Symbol">:</a> <a id="2418" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="2420" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">®</a> <a id="2422" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="2424" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">∷ℕ</a> <a id="2427" class="Symbol">→</a> <a id="2429" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="2431" href="Definition.Typed.html#12516" class="Datatype Operator">⊢</a> <a id="2433" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="2435" href="Definition.Typed.html#12516" class="Datatype Operator">⇒*</a> <a id="2438" href="Definition.Untyped.html#3526" class="InductiveConstructor">zero</a> <a id="2443" href="Definition.Typed.html#12516" class="Datatype Operator">∷</a> <a id="2445" href="Definition.Untyped.html#2494" class="InductiveConstructor">ℕ</a> <a id="2447" class="Symbol">→</a> <a id="2449" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="2451" href="Graded.Erasure.Target.html#6026" class="Datatype Operator">T.⇒*</a> <a id="2456" href="Graded.Erasure.Target.html#825" class="InductiveConstructor">T.zero</a>
<a id="2463" href="Graded.Erasure.Consequences.Soundness.html#2400" class="Function">soundness-zero′</a> <a id="2479" class="Symbol">(</a><a id="2480" href="Graded.Erasure.LogicalRelation.html#1723" class="InductiveConstructor">zeroᵣ</a> <a id="2486" href="Graded.Erasure.Consequences.Soundness.html#2486" class="Bound">t⇒zero′</a> <a id="2494" href="Graded.Erasure.Consequences.Soundness.html#2494" class="Bound">v⇒zero</a><a id="2500" class="Symbol">)</a> <a id="2502" href="Graded.Erasure.Consequences.Soundness.html#2502" class="Bound">t⇒zero</a> <a id="2509" class="Symbol">=</a> <a id="2511" href="Graded.Erasure.Consequences.Soundness.html#2494" class="Bound">v⇒zero</a>
<a id="2518" href="Graded.Erasure.Consequences.Soundness.html#2400" class="Function">soundness-zero′</a> <a id="2534" class="Symbol">(</a><a id="2535" href="Graded.Erasure.LogicalRelation.html#1780" class="InductiveConstructor">sucᵣ</a> <a id="2540" href="Graded.Erasure.Consequences.Soundness.html#2540" class="Bound">t⇒suc</a> <a id="2546" href="Graded.Erasure.Consequences.Soundness.html#2546" class="Bound">v⇒suc</a> <a id="2552" href="Graded.Erasure.Consequences.Soundness.html#2552" class="Bound">t®v</a><a id="2555" class="Symbol">)</a> <a id="2557" href="Graded.Erasure.Consequences.Soundness.html#2557" class="Bound">t⇒zero</a>
  <a id="2566" class="Keyword">with</a> <a id="2571" href="Definition.Typed.Properties.html#10424" class="Function">whrDet*Term</a> <a id="2583" class="Symbol">(</a><a id="2584" href="Graded.Erasure.Consequences.Soundness.html#2557" class="Bound">t⇒zero</a> <a id="2591" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2593" href="Definition.Untyped.html#6045" class="InductiveConstructor">zeroₙ</a><a id="2598" class="Symbol">)</a> <a id="2600" class="Symbol">(</a><a id="2601" href="Graded.Erasure.Consequences.Soundness.html#2540" class="Bound">t⇒suc</a> <a id="2607" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2609" href="Definition.Untyped.html#6065" class="InductiveConstructor">sucₙ</a><a id="2613" class="Symbol">)</a>
<a id="2615" class="Symbol">...</a> <a id="2619" class="Symbol">|</a> <a id="2621" class="Symbol">()</a>

<a id="2625" class="Comment">-- WH reduction soundness of zero</a>
<a id="2659" class="Comment">-- If t ⇒* zero and 𝟘ᶜ ▸ t then erase t ⇒* zero</a>

<a id="soundness-zero"></a><a id="2708" href="Graded.Erasure.Consequences.Soundness.html#2708" class="Function">soundness-zero</a> <a id="2723" class="Symbol">:</a>
  <a id="2727" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="2729" href="Definition.Typed.html#12516" class="Datatype Operator">⊢</a> <a id="2731" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="2733" href="Definition.Typed.html#12516" class="Datatype Operator">⇒*</a> <a id="2736" href="Definition.Untyped.html#3526" class="InductiveConstructor">zero</a> <a id="2741" href="Definition.Typed.html#12516" class="Datatype Operator">∷</a> <a id="2743" href="Definition.Untyped.html#2494" class="InductiveConstructor">ℕ</a> <a id="2745" class="Symbol">→</a> <a id="2747" href="Graded.Context.html#1994" class="Function">𝟘ᶜ</a> <a id="2750" href="Graded.Usage.html#1118" class="Datatype Operator">▸[</a> <a id="2753" href="Graded.Mode.html#1041" class="InductiveConstructor">𝟙ᵐ</a> <a id="2756" href="Graded.Usage.html#1118" class="Datatype Operator">]</a> <a id="2758" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="2760" class="Symbol">→</a> <a id="2762" href="Graded.Erasure.Extraction.html#994" class="Function">erase</a> <a id="2768" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="2770" href="Graded.Erasure.Target.html#6026" class="Datatype Operator">T.⇒*</a> <a id="2775" href="Graded.Erasure.Target.html#825" class="InductiveConstructor">T.zero</a>
<a id="2782" href="Graded.Erasure.Consequences.Soundness.html#2708" class="Function">soundness-zero</a> <a id="2797" href="Graded.Erasure.Consequences.Soundness.html#2797" class="Bound">t⇒zero</a> <a id="2804" href="Graded.Erasure.Consequences.Soundness.html#2804" class="Bound">𝟘▸t</a> <a id="2808" class="Symbol">=</a>
  <a id="2812" class="Keyword">let</a> <a id="2816" href="Graded.Erasure.Consequences.Soundness.html#2816" class="Bound">⊢t</a> <a id="2819" class="Symbol">=</a> <a id="2821" href="Definition.Typed.Properties.html#5099" class="Function">redFirst*Term</a> <a id="2835" href="Graded.Erasure.Consequences.Soundness.html#2797" class="Bound">t⇒zero</a>
      <a id="2848" href="Graded.Erasure.Consequences.Soundness.html#2848" class="Bound">[ℕ]</a> <a id="2852" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2854" href="Graded.Erasure.Consequences.Soundness.html#2854" class="Bound">t®t′</a> <a id="2859" class="Symbol">=</a> <a id="2861" href="Graded.Erasure.LogicalRelation.Fundamental.html#16363" class="Function">fundamentalErased</a> <a id="2879" href="Graded.Erasure.Consequences.Soundness.html#2816" class="Bound">⊢t</a> <a id="2882" href="Graded.Erasure.Consequences.Soundness.html#2804" class="Bound">𝟘▸t</a>
      <a id="2892" href="Graded.Erasure.Consequences.Soundness.html#2892" class="Bound">t®t″</a> <a id="2897" class="Symbol">=</a> <a id="2899" href="Graded.Erasure.LogicalRelation.Irrelevance.html#3960" class="Function">irrelevanceTerm</a> <a id="2915" class="Symbol">{</a><a id="2916" class="Argument">l′</a> <a id="2919" class="Symbol">=</a> <a id="2921" href="Definition.LogicalRelation.html#5984" class="InductiveConstructor">¹</a><a id="2922" class="Symbol">}</a> <a id="2924" href="Graded.Erasure.Consequences.Soundness.html#2848" class="Bound">[ℕ]</a> <a id="2928" class="Symbol">(</a><a id="2929" href="Definition.LogicalRelation.html#14813" class="InductiveConstructor">ℕᵣ</a> <a id="2932" class="Symbol">(</a><a id="2933" href="Definition.Typed.Properties.html#11999" class="Function">idRed:*:</a> <a id="2942" class="Symbol">(</a><a id="2943" href="Definition.Typed.html#1159" class="InductiveConstructor">ℕⱼ</a> <a id="2946" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a><a id="2948" class="Symbol">)))</a> <a id="2952" class="Symbol">(</a><a id="2953" href="Graded.Erasure.Consequences.Soundness.html#2854" class="Bound">t®t′</a> <a id="2958" href="Graded.Erasure.LogicalRelation.Subsumption.html#2026" class="Function Operator">◀≢𝟘</a> <a id="2962" href="Graded.Modality.html#2836" class="Function">𝟙≉𝟘</a><a id="2965" class="Symbol">)</a>
  <a id="2969" class="Keyword">in</a>  <a id="2973" href="Graded.Erasure.Consequences.Soundness.html#2400" class="Function">soundness-zero′</a> <a id="2989" href="Graded.Erasure.Consequences.Soundness.html#2892" class="Bound">t®t″</a> <a id="2994" href="Graded.Erasure.Consequences.Soundness.html#2797" class="Bound">t⇒zero</a>

<a id="3002" class="Comment">-- Helper lemma for WH reduction soundness of suc</a>
<a id="3052" class="Comment">-- If t ® v ∷ℕ  and t ⇒* suc t′ then v ⇒* suc v′ and t′ ® v′ ∷ℕ for some v′</a>

<a id="soundness-suc′"></a><a id="3129" href="Graded.Erasure.Consequences.Soundness.html#3129" class="Function">soundness-suc′</a> <a id="3144" class="Symbol">:</a> <a id="3146" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="3148" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">®</a> <a id="3150" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="3152" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">∷ℕ</a> <a id="3155" class="Symbol">→</a> <a id="3157" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="3159" href="Definition.Typed.html#12516" class="Datatype Operator">⊢</a> <a id="3161" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="3163" href="Definition.Typed.html#12516" class="Datatype Operator">⇒*</a> <a id="3166" href="Definition.Untyped.html#3557" class="InductiveConstructor">suc</a> <a id="3170" href="Graded.Erasure.Consequences.Soundness.html#1994" class="Generalizable">t′</a> <a id="3173" href="Definition.Typed.html#12516" class="Datatype Operator">∷</a> <a id="3175" href="Definition.Untyped.html#2494" class="InductiveConstructor">ℕ</a>
               <a id="3192" class="Symbol">→</a> <a id="3194" href="Data.Product.html#1369" class="Function">∃</a> <a id="3196" class="Symbol">λ</a> <a id="3198" href="Graded.Erasure.Consequences.Soundness.html#3198" class="Bound">v′</a> <a id="3201" class="Symbol">→</a> <a id="3203" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="3205" href="Graded.Erasure.Target.html#6026" class="Datatype Operator">T.⇒*</a> <a id="3210" href="Graded.Erasure.Target.html#846" class="InductiveConstructor">T.suc</a> <a id="3216" href="Graded.Erasure.Consequences.Soundness.html#3198" class="Bound">v′</a> <a id="3219" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3221" href="Graded.Erasure.Consequences.Soundness.html#1994" class="Generalizable">t′</a> <a id="3224" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">®</a> <a id="3226" href="Graded.Erasure.Consequences.Soundness.html#3198" class="Bound">v′</a> <a id="3229" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">∷ℕ</a>
<a id="3232" href="Graded.Erasure.Consequences.Soundness.html#3129" class="Function">soundness-suc′</a> <a id="3247" class="Symbol">(</a><a id="3248" href="Graded.Erasure.LogicalRelation.html#1723" class="InductiveConstructor">zeroᵣ</a> <a id="3254" href="Graded.Erasure.Consequences.Soundness.html#3254" class="Bound">t⇒zero</a> <a id="3261" href="Graded.Erasure.Consequences.Soundness.html#3261" class="Bound">v⇒zero</a><a id="3267" class="Symbol">)</a> <a id="3269" href="Graded.Erasure.Consequences.Soundness.html#3269" class="Bound">t⇒suc</a>
  <a id="3277" class="Keyword">with</a> <a id="3282" href="Definition.Typed.Properties.html#10424" class="Function">whrDet*Term</a> <a id="3294" class="Symbol">(</a><a id="3295" href="Graded.Erasure.Consequences.Soundness.html#3254" class="Bound">t⇒zero</a> <a id="3302" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3304" href="Definition.Untyped.html#6045" class="InductiveConstructor">zeroₙ</a><a id="3309" class="Symbol">)</a> <a id="3311" class="Symbol">(</a><a id="3312" href="Graded.Erasure.Consequences.Soundness.html#3269" class="Bound">t⇒suc</a> <a id="3318" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3320" href="Definition.Untyped.html#6065" class="InductiveConstructor">sucₙ</a><a id="3324" class="Symbol">)</a>
<a id="3326" class="Symbol">...</a> <a id="3330" class="Symbol">|</a> <a id="3332" class="Symbol">()</a>
<a id="3335" href="Graded.Erasure.Consequences.Soundness.html#3129" class="Function">soundness-suc′</a> <a id="3350" class="Symbol">(</a><a id="3351" href="Graded.Erasure.LogicalRelation.html#1780" class="InductiveConstructor">sucᵣ</a> <a id="3356" class="Symbol">{</a><a id="3357" class="Argument">v′</a> <a id="3360" class="Symbol">=</a> <a id="3362" href="Graded.Erasure.Consequences.Soundness.html#3362" class="Bound">v′</a><a id="3364" class="Symbol">}</a> <a id="3366" href="Graded.Erasure.Consequences.Soundness.html#3366" class="Bound">t⇒suc′</a> <a id="3373" href="Graded.Erasure.Consequences.Soundness.html#3373" class="Bound">v⇒suc</a> <a id="3379" href="Graded.Erasure.Consequences.Soundness.html#3379" class="Bound">t®v</a><a id="3382" class="Symbol">)</a> <a id="3384" href="Graded.Erasure.Consequences.Soundness.html#3384" class="Bound">t⇒suc</a>
  <a id="3392" class="Keyword">with</a> <a id="3397" href="Definition.Typed.Properties.html#10424" class="Function">whrDet*Term</a> <a id="3409" class="Symbol">(</a><a id="3410" href="Graded.Erasure.Consequences.Soundness.html#3384" class="Bound">t⇒suc</a> <a id="3416" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3418" href="Definition.Untyped.html#6065" class="InductiveConstructor">sucₙ</a><a id="3422" class="Symbol">)</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Graded.Erasure.Consequences.Soundness.html#3366" class="Bound">t⇒suc′</a> <a id="3432" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3434" href="Definition.Untyped.html#6065" class="InductiveConstructor">sucₙ</a><a id="3438" class="Symbol">)</a>
<a id="3440" class="Symbol">...</a> <a id="3444" class="Symbol">|</a> <a id="3446" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3451" class="Symbol">=</a> <a id="3453" class="Bound">v′</a> <a id="3456" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3458" class="Symbol">(</a><a id="3459" class="Bound">v⇒suc</a> <a id="3465" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3467" class="Bound">t®v</a><a id="3470" class="Symbol">)</a>

<a id="3473" class="Comment">-- WH reduction soundness of suc</a>
<a id="3506" class="Comment">-- If t ⇒* suc t′ and 𝟘ᶜ ▸ t then erase t ⇒* suc v′ and t′ ® v′ ∷ℕ for some v′</a>

<a id="soundness-suc"></a><a id="3586" href="Graded.Erasure.Consequences.Soundness.html#3586" class="Function">soundness-suc</a> <a id="3600" class="Symbol">:</a> <a id="3602" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="3604" href="Definition.Typed.html#12516" class="Datatype Operator">⊢</a> <a id="3606" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="3608" href="Definition.Typed.html#12516" class="Datatype Operator">⇒*</a> <a id="3611" href="Definition.Untyped.html#3557" class="InductiveConstructor">suc</a> <a id="3615" href="Graded.Erasure.Consequences.Soundness.html#1994" class="Generalizable">t′</a> <a id="3618" href="Definition.Typed.html#12516" class="Datatype Operator">∷</a> <a id="3620" href="Definition.Untyped.html#2494" class="InductiveConstructor">ℕ</a> <a id="3622" class="Symbol">→</a> <a id="3624" href="Graded.Context.html#1994" class="Function">𝟘ᶜ</a> <a id="3627" href="Graded.Usage.html#1118" class="Datatype Operator">▸[</a> <a id="3630" href="Graded.Mode.html#1041" class="InductiveConstructor">𝟙ᵐ</a> <a id="3633" href="Graded.Usage.html#1118" class="Datatype Operator">]</a> <a id="3635" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a>
              <a id="3651" class="Symbol">→</a> <a id="3653" href="Data.Product.html#1369" class="Function">∃</a> <a id="3655" class="Symbol">λ</a> <a id="3657" href="Graded.Erasure.Consequences.Soundness.html#3657" class="Bound">v′</a> <a id="3660" class="Symbol">→</a> <a id="3662" href="Graded.Erasure.Extraction.html#994" class="Function">erase</a> <a id="3668" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="3670" href="Graded.Erasure.Target.html#6026" class="Datatype Operator">T.⇒*</a> <a id="3675" href="Graded.Erasure.Target.html#846" class="InductiveConstructor">T.suc</a> <a id="3681" href="Graded.Erasure.Consequences.Soundness.html#3657" class="Bound">v′</a> <a id="3684" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3686" href="Graded.Erasure.Consequences.Soundness.html#1994" class="Generalizable">t′</a> <a id="3689" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">®</a> <a id="3691" href="Graded.Erasure.Consequences.Soundness.html#3657" class="Bound">v′</a> <a id="3694" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">∷ℕ</a>
<a id="3697" href="Graded.Erasure.Consequences.Soundness.html#3586" class="Function">soundness-suc</a> <a id="3711" href="Graded.Erasure.Consequences.Soundness.html#3711" class="Bound">t⇒suc</a> <a id="3717" href="Graded.Erasure.Consequences.Soundness.html#3717" class="Bound">𝟘▸t</a> <a id="3721" class="Symbol">=</a>
  <a id="3725" class="Keyword">let</a> <a id="3729" href="Graded.Erasure.Consequences.Soundness.html#3729" class="Bound">⊢t</a> <a id="3732" class="Symbol">=</a> <a id="3734" href="Definition.Typed.Properties.html#5099" class="Function">redFirst*Term</a> <a id="3748" href="Graded.Erasure.Consequences.Soundness.html#3711" class="Bound">t⇒suc</a>
      <a id="3760" href="Graded.Erasure.Consequences.Soundness.html#3760" class="Bound">[ℕ]</a> <a id="3764" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3766" href="Graded.Erasure.Consequences.Soundness.html#3766" class="Bound">t®t′</a> <a id="3771" class="Symbol">=</a> <a id="3773" href="Graded.Erasure.LogicalRelation.Fundamental.html#16363" class="Function">fundamentalErased</a> <a id="3791" href="Graded.Erasure.Consequences.Soundness.html#3729" class="Bound">⊢t</a> <a id="3794" href="Graded.Erasure.Consequences.Soundness.html#3717" class="Bound">𝟘▸t</a>
      <a id="3804" href="Graded.Erasure.Consequences.Soundness.html#3804" class="Bound">t®t″</a> <a id="3809" class="Symbol">=</a> <a id="3811" href="Graded.Erasure.LogicalRelation.Irrelevance.html#3960" class="Function">irrelevanceTerm</a> <a id="3827" class="Symbol">{</a><a id="3828" class="Argument">l′</a> <a id="3831" class="Symbol">=</a> <a id="3833" href="Definition.LogicalRelation.html#5984" class="InductiveConstructor">¹</a><a id="3834" class="Symbol">}</a> <a id="3836" href="Graded.Erasure.Consequences.Soundness.html#3760" class="Bound">[ℕ]</a> <a id="3840" class="Symbol">(</a><a id="3841" href="Definition.LogicalRelation.html#14813" class="InductiveConstructor">ℕᵣ</a> <a id="3844" class="Symbol">(</a><a id="3845" href="Definition.Typed.Properties.html#11999" class="Function">idRed:*:</a> <a id="3854" class="Symbol">(</a><a id="3855" href="Definition.Typed.html#1159" class="InductiveConstructor">ℕⱼ</a> <a id="3858" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a><a id="3860" class="Symbol">)))</a> <a id="3864" class="Symbol">(</a><a id="3865" href="Graded.Erasure.Consequences.Soundness.html#3766" class="Bound">t®t′</a> <a id="3870" href="Graded.Erasure.LogicalRelation.Subsumption.html#2026" class="Function Operator">◀≢𝟘</a> <a id="3874" href="Graded.Modality.html#2836" class="Function">𝟙≉𝟘</a><a id="3877" class="Symbol">)</a>
  <a id="3881" class="Keyword">in</a>  <a id="3885" href="Graded.Erasure.Consequences.Soundness.html#3129" class="Function">soundness-suc′</a> <a id="3900" href="Graded.Erasure.Consequences.Soundness.html#3804" class="Bound">t®t″</a> <a id="3905" href="Graded.Erasure.Consequences.Soundness.html#3711" class="Bound">t⇒suc</a>

<a id="3912" class="Comment">-- Helper lemma for soundness of natural numbers</a>

<a id="soundness-ℕ′"></a><a id="3962" href="Graded.Erasure.Consequences.Soundness.html#3962" class="Function">soundness-ℕ′</a> <a id="3975" class="Symbol">:</a> <a id="3977" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="3979" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">®</a> <a id="3981" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="3983" href="Graded.Erasure.LogicalRelation.html#1671" class="Datatype Operator">∷ℕ</a> <a id="3986" class="Symbol">→</a> <a id="3988" href="Data.Product.html#1369" class="Function">∃</a> <a id="3990" class="Symbol">λ</a> <a id="3992" href="Graded.Erasure.Consequences.Soundness.html#3992" class="Bound">n</a> <a id="3994" class="Symbol">→</a> <a id="3996" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="3998" href="Graded.Erasure.SucRed.html#940" class="Datatype Operator">⊢</a> <a id="4000" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="4002" href="Graded.Erasure.SucRed.html#940" class="Datatype Operator">⇒ˢ*</a> <a id="4006" href="Graded.Erasure.Consequences.Soundness.html#2147" class="Function">sucᵏ</a> <a id="4011" href="Graded.Erasure.Consequences.Soundness.html#3992" class="Bound">n</a> <a id="4013" href="Graded.Erasure.SucRed.html#940" class="Datatype Operator">∷ℕ</a> <a id="4016" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4018" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="4020" href="Graded.Erasure.SucRed.html#2022" class="Datatype Operator">⇒ˢ*</a> <a id="4024" href="Graded.Erasure.Consequences.Soundness.html#2220" class="Function">sucᵏ′</a> <a id="4030" href="Graded.Erasure.Consequences.Soundness.html#3992" class="Bound">n</a>
<a id="4032" href="Graded.Erasure.Consequences.Soundness.html#3962" class="Function">soundness-ℕ′</a> <a id="4045" class="Symbol">(</a><a id="4046" href="Graded.Erasure.LogicalRelation.html#1723" class="InductiveConstructor">zeroᵣ</a> <a id="4052" href="Graded.Erasure.Consequences.Soundness.html#4052" class="Bound">x</a> <a id="4054" href="Graded.Erasure.Consequences.Soundness.html#4054" class="Bound">x₁</a><a id="4056" class="Symbol">)</a> <a id="4058" class="Symbol">=</a> <a id="4060" class="Number">0</a> <a id="4062" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4064" href="Graded.Erasure.SucRed.html#1233" class="Function">whred*</a> <a id="4071" href="Graded.Erasure.Consequences.Soundness.html#4052" class="Bound">x</a> <a id="4073" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4075" href="Graded.Erasure.SucRed.html#2236" class="Function">whred*′</a> <a id="4083" href="Graded.Erasure.Consequences.Soundness.html#4054" class="Bound">x₁</a>
<a id="4086" href="Graded.Erasure.Consequences.Soundness.html#3962" class="Function">soundness-ℕ′</a> <a id="4099" class="Symbol">(</a><a id="4100" href="Graded.Erasure.LogicalRelation.html#1780" class="InductiveConstructor">sucᵣ</a> <a id="4105" href="Graded.Erasure.Consequences.Soundness.html#4105" class="Bound">x</a> <a id="4107" href="Graded.Erasure.Consequences.Soundness.html#4107" class="Bound">x₁</a> <a id="4110" href="Graded.Erasure.Consequences.Soundness.html#4110" class="Bound">t®v</a><a id="4113" class="Symbol">)</a> <a id="4115" class="Symbol">=</a>
  <a id="4119" class="Keyword">let</a> <a id="4123" href="Graded.Erasure.Consequences.Soundness.html#4123" class="Bound">n</a> <a id="4125" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4127" href="Graded.Erasure.Consequences.Soundness.html#4127" class="Bound">d</a> <a id="4129" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4131" href="Graded.Erasure.Consequences.Soundness.html#4131" class="Bound">d′</a> <a id="4134" class="Symbol">=</a> <a id="4136" href="Graded.Erasure.Consequences.Soundness.html#3962" class="Function">soundness-ℕ′</a> <a id="4149" href="Graded.Erasure.Consequences.Soundness.html#4110" class="Bound">t®v</a>
  <a id="4155" class="Keyword">in</a>  <a id="4159" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="4162" href="Graded.Erasure.Consequences.Soundness.html#4123" class="Bound">n</a> <a id="4164" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4166" href="Graded.Erasure.SucRed.html#1092" class="Function">⇒ˢ*∷ℕ-trans</a> <a id="4178" class="Symbol">(</a><a id="4179" href="Graded.Erasure.SucRed.html#1233" class="Function">whred*</a> <a id="4186" href="Graded.Erasure.Consequences.Soundness.html#4105" class="Bound">x</a><a id="4187" class="Symbol">)</a> <a id="4189" class="Symbol">(</a><a id="4190" href="Graded.Erasure.SucRed.html#1333" class="Function">sucred*</a> <a id="4198" href="Graded.Erasure.Consequences.Soundness.html#4127" class="Bound">d</a><a id="4199" class="Symbol">)</a>
           <a id="4212" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4214" href="Graded.Erasure.SucRed.html#2116" class="Function">⇒ˢ*-trans</a> <a id="4224" class="Symbol">(</a><a id="4225" href="Graded.Erasure.SucRed.html#2236" class="Function">whred*′</a> <a id="4233" href="Graded.Erasure.Consequences.Soundness.html#4107" class="Bound">x₁</a><a id="4235" class="Symbol">)</a> <a id="4237" class="Symbol">(</a><a id="4238" href="Graded.Erasure.SucRed.html#2340" class="Function">sucred*′</a> <a id="4247" href="Graded.Erasure.Consequences.Soundness.html#4131" class="Bound">d′</a><a id="4249" class="Symbol">)</a>

<a id="4252" class="Comment">-- Soundness for erasure of natural numbers</a>
<a id="4296" class="Comment">-- Well-typed terms of the natural number type reduce to numerals</a>
<a id="4362" class="Comment">-- if erased matches are disallowed or the term is closed.</a>

<a id="soundness-ℕ"></a><a id="4422" href="Graded.Erasure.Consequences.Soundness.html#4422" class="Function">soundness-ℕ</a> <a id="4434" class="Symbol">:</a> <a id="4436" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="4438" href="Definition.Typed.html#1461" class="Datatype Operator">⊢</a> <a id="4440" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="4442" href="Definition.Typed.html#1461" class="Datatype Operator">∷</a> <a id="4444" href="Definition.Untyped.html#2494" class="InductiveConstructor">ℕ</a> <a id="4446" class="Symbol">→</a> <a id="4448" href="Graded.Context.html#1994" class="Function">𝟘ᶜ</a> <a id="4451" href="Graded.Usage.html#1118" class="Datatype Operator">▸[</a> <a id="4454" href="Graded.Mode.html#1041" class="InductiveConstructor">𝟙ᵐ</a> <a id="4457" href="Graded.Usage.html#1118" class="Datatype Operator">]</a> <a id="4459" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a>
            <a id="4473" class="Symbol">→</a> <a id="4475" href="Data.Product.html#1369" class="Function">∃</a> <a id="4477" class="Symbol">λ</a> <a id="4479" href="Graded.Erasure.Consequences.Soundness.html#4479" class="Bound">n</a> <a id="4481" class="Symbol">→</a> <a id="4483" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="4485" href="Graded.Erasure.SucRed.html#940" class="Datatype Operator">⊢</a> <a id="4487" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="4489" href="Graded.Erasure.SucRed.html#940" class="Datatype Operator">⇒ˢ*</a> <a id="4493" href="Graded.Erasure.Consequences.Soundness.html#2147" class="Function">sucᵏ</a> <a id="4498" href="Graded.Erasure.Consequences.Soundness.html#4479" class="Bound">n</a> <a id="4500" href="Graded.Erasure.SucRed.html#940" class="Datatype Operator">∷ℕ</a> <a id="4503" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4505" href="Graded.Erasure.Extraction.html#994" class="Function">erase</a> <a id="4511" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="4513" href="Graded.Erasure.SucRed.html#2022" class="Datatype Operator">⇒ˢ*</a> <a id="4517" href="Graded.Erasure.Consequences.Soundness.html#2220" class="Function">sucᵏ′</a> <a id="4523" href="Graded.Erasure.Consequences.Soundness.html#4479" class="Bound">n</a>
<a id="4525" href="Graded.Erasure.Consequences.Soundness.html#4422" class="Function">soundness-ℕ</a> <a id="4537" href="Graded.Erasure.Consequences.Soundness.html#4537" class="Bound">⊢t</a> <a id="4540" href="Graded.Erasure.Consequences.Soundness.html#4540" class="Bound">𝟘▸t</a> <a id="4544" class="Symbol">=</a>
  <a id="4548" class="Keyword">let</a> <a id="4552" href="Graded.Erasure.Consequences.Soundness.html#4552" class="Bound">[ℕ]</a> <a id="4556" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4558" href="Graded.Erasure.Consequences.Soundness.html#4558" class="Bound">t®v</a> <a id="4562" class="Symbol">=</a> <a id="4564" href="Graded.Erasure.LogicalRelation.Fundamental.html#16363" class="Function">fundamentalErased</a> <a id="4582" href="Graded.Erasure.Consequences.Soundness.html#4537" class="Bound">⊢t</a> <a id="4585" href="Graded.Erasure.Consequences.Soundness.html#4540" class="Bound">𝟘▸t</a>
  <a id="4591" class="Keyword">in</a>  <a id="4595" href="Graded.Erasure.Consequences.Soundness.html#3962" class="Function">soundness-ℕ′</a> <a id="4608" class="Symbol">(</a><a id="4609" href="Graded.Erasure.LogicalRelation.Irrelevance.html#3960" class="Function">irrelevanceTerm</a> <a id="4625" class="Symbol">{</a><a id="4626" class="Argument">l′</a> <a id="4629" class="Symbol">=</a> <a id="4631" href="Definition.LogicalRelation.html#5984" class="InductiveConstructor">¹</a><a id="4632" class="Symbol">}</a> <a id="4634" href="Graded.Erasure.Consequences.Soundness.html#4552" class="Bound">[ℕ]</a> <a id="4638" class="Symbol">(</a><a id="4639" href="Definition.LogicalRelation.html#14813" class="InductiveConstructor">ℕᵣ</a> <a id="4642" class="Symbol">(</a><a id="4643" href="Definition.Typed.Properties.html#11999" class="Function">idRed:*:</a> <a id="4652" class="Symbol">(</a><a id="4653" href="Definition.Typed.html#1159" class="InductiveConstructor">ℕⱼ</a> <a id="4656" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a><a id="4658" class="Symbol">)))</a> <a id="4662" class="Symbol">(</a><a id="4663" href="Graded.Erasure.Consequences.Soundness.html#4558" class="Bound">t®v</a> <a id="4667" href="Graded.Erasure.LogicalRelation.Subsumption.html#2026" class="Function Operator">◀≢𝟘</a> <a id="4671" href="Graded.Modality.html#2836" class="Function">𝟙≉𝟘</a><a id="4674" class="Symbol">))</a>

<a id="4678" class="Comment">-- Helper lemma for WH reduction soundness of unit</a>

<a id="soundness-star′"></a><a id="4730" href="Graded.Erasure.Consequences.Soundness.html#4730" class="Function">soundness-star′</a> <a id="4746" class="Symbol">:</a> <a id="4748" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="4750" href="Graded.Erasure.LogicalRelation.html#2153" class="Datatype Operator">®</a> <a id="4752" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="4754" href="Graded.Erasure.LogicalRelation.html#2153" class="Datatype Operator">∷Unit</a> <a id="4760" class="Symbol">→</a> <a id="4762" href="Graded.Erasure.Consequences.Soundness.html#2034" class="Generalizable">v</a> <a id="4764" href="Graded.Erasure.Target.html#6026" class="Datatype Operator">T.⇒*</a> <a id="4769" href="Graded.Erasure.Target.html#954" class="InductiveConstructor">T.star</a>
<a id="4776" href="Graded.Erasure.Consequences.Soundness.html#4730" class="Function">soundness-star′</a> <a id="4792" class="Symbol">(</a><a id="4793" href="Graded.Erasure.LogicalRelation.html#2208" class="InductiveConstructor">starᵣ</a> <a id="4799" class="Symbol">_</a> <a id="4801" href="Graded.Erasure.Consequences.Soundness.html#4801" class="Bound">v⇒star</a><a id="4807" class="Symbol">)</a> <a id="4809" class="Symbol">=</a> <a id="4811" href="Graded.Erasure.Consequences.Soundness.html#4801" class="Bound">v⇒star</a>

<a id="4819" class="Comment">-- WH reduction soundness of unit</a>

<a id="soundness-star"></a><a id="4854" href="Graded.Erasure.Consequences.Soundness.html#4854" class="Function">soundness-star</a> <a id="4869" class="Symbol">:</a>
  <a id="4873" href="Graded.Erasure.Consequences.Soundness.html#778" class="Bound">Δ</a> <a id="4875" href="Definition.Typed.html#12516" class="Datatype Operator">⊢</a> <a id="4877" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="4879" href="Definition.Typed.html#12516" class="Datatype Operator">⇒*</a> <a id="4882" href="Definition.Untyped.html#3670" class="InductiveConstructor">star</a> <a id="4887" href="Definition.Typed.html#12516" class="Datatype Operator">∷</a> <a id="4889" href="Definition.Untyped.html#2554" class="InductiveConstructor">Unit</a> <a id="4894" class="Symbol">→</a> <a id="4896" href="Graded.Context.html#1994" class="Function">𝟘ᶜ</a> <a id="4899" href="Graded.Usage.html#1118" class="Datatype Operator">▸[</a> <a id="4902" href="Graded.Mode.html#1041" class="InductiveConstructor">𝟙ᵐ</a> <a id="4905" href="Graded.Usage.html#1118" class="Datatype Operator">]</a> <a id="4907" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="4909" class="Symbol">→</a> <a id="4911" href="Graded.Erasure.Extraction.html#994" class="Function">erase</a> <a id="4917" href="Graded.Erasure.Consequences.Soundness.html#1992" class="Generalizable">t</a> <a id="4919" href="Graded.Erasure.Target.html#6026" class="Datatype Operator">T.⇒*</a> <a id="4924" href="Graded.Erasure.Target.html#954" class="InductiveConstructor">T.star</a>
<a id="4931" href="Graded.Erasure.Consequences.Soundness.html#4854" class="Function">soundness-star</a> <a id="4946" href="Graded.Erasure.Consequences.Soundness.html#4946" class="Bound">t⇒star</a> <a id="4953" href="Graded.Erasure.Consequences.Soundness.html#4953" class="Bound">γ▸t</a> <a id="4957" class="Symbol">=</a>
  <a id="4961" class="Keyword">let</a> <a id="4965" href="Graded.Erasure.Consequences.Soundness.html#4965" class="Bound">⊢t</a> <a id="4968" class="Symbol">=</a> <a id="4970" href="Definition.Typed.Properties.html#5099" class="Function">redFirst*Term</a> <a id="4984" href="Graded.Erasure.Consequences.Soundness.html#4946" class="Bound">t⇒star</a>
      <a id="4997" href="Graded.Erasure.Consequences.Soundness.html#4997" class="Bound">[⊤]</a> <a id="5001" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5003" href="Graded.Erasure.Consequences.Soundness.html#5003" class="Bound">t®t′</a> <a id="5008" class="Symbol">=</a> <a id="5010" href="Graded.Erasure.LogicalRelation.Fundamental.html#16363" class="Function">fundamentalErased</a> <a id="5028" href="Graded.Erasure.Consequences.Soundness.html#4965" class="Bound">⊢t</a> <a id="5031" href="Graded.Erasure.Consequences.Soundness.html#4953" class="Bound">γ▸t</a>
      <a id="5041" href="Graded.Erasure.Consequences.Soundness.html#5041" class="Bound">ok</a> <a id="5044" class="Symbol">=</a> <a id="5046" href="Definition.Typed.Consequences.Inversion.html#1890" class="Function">⊢∷Unit→Unit-restriction</a> <a id="5070" href="Graded.Erasure.Consequences.Soundness.html#4965" class="Bound">⊢t</a>
      <a id="5079" href="Graded.Erasure.Consequences.Soundness.html#5079" class="Bound">t®t″</a> <a id="5084" class="Symbol">=</a> <a id="5086" href="Graded.Erasure.LogicalRelation.Irrelevance.html#3960" class="Function">irrelevanceTerm</a> <a id="5102" class="Symbol">{</a><a id="5103" class="Argument">l′</a> <a id="5106" class="Symbol">=</a> <a id="5108" href="Definition.LogicalRelation.html#5984" class="InductiveConstructor">¹</a><a id="5109" class="Symbol">}</a>
               <a id="5126" href="Graded.Erasure.Consequences.Soundness.html#4997" class="Bound">[⊤]</a> <a id="5130" class="Symbol">(</a><a id="5131" href="Definition.LogicalRelation.html#14892" class="InductiveConstructor">Unitᵣ</a> <a id="5137" class="Symbol">(</a><a id="5138" href="Definition.LogicalRelation.html#5412" class="InductiveConstructor">Unitₜ</a> <a id="5144" class="Symbol">(</a><a id="5145" href="Definition.Typed.Properties.html#11999" class="Function">idRed:*:</a> <a id="5154" class="Symbol">(</a><a id="5155" href="Definition.Typed.html#1213" class="InductiveConstructor">Unitⱼ</a> <a id="5161" href="Graded.Erasure.Consequences.Soundness.html#795" class="Bound">⊢Δ</a> <a id="5164" href="Graded.Erasure.Consequences.Soundness.html#5041" class="Bound">ok</a><a id="5166" class="Symbol">))</a> <a id="5169" href="Graded.Erasure.Consequences.Soundness.html#5041" class="Bound">ok</a><a id="5171" class="Symbol">))</a>
               <a id="5189" class="Symbol">(</a><a id="5190" href="Graded.Erasure.Consequences.Soundness.html#5003" class="Bound">t®t′</a> <a id="5195" href="Graded.Erasure.LogicalRelation.Subsumption.html#2026" class="Function Operator">◀≢𝟘</a> <a id="5199" href="Graded.Modality.html#2836" class="Function">𝟙≉𝟘</a><a id="5202" class="Symbol">)</a>
  <a id="5206" class="Keyword">in</a>  <a id="5210" href="Graded.Erasure.Consequences.Soundness.html#4730" class="Function">soundness-star′</a> <a id="5226" href="Graded.Erasure.Consequences.Soundness.html#5079" class="Bound">t®t″</a>
</pre></body></html>