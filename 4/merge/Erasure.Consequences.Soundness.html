<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Erasure.Consequences.Soundness</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Soundness of the extraction function.</a>
<a id="115" class="Comment">------------------------------------------------------------------------</a>

<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Definition.Modality.html" class="Module">Definition.Modality</a>
<a id="221" class="Keyword">open</a> <a id="226" class="Keyword">import</a> <a id="233" href="Definition.Modality.Restrictions.Definitions.html" class="Module">Definition.Modality.Restrictions.Definitions</a>
  <a id="280" class="Keyword">using</a> <a id="286" class="Symbol">(</a><a id="287" href="Definition.Modality.Restrictions.Definitions.html#2762" class="Function">No-erased-matches</a><a id="304" class="Symbol">)</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Definition.Typed.EqualityRelation.html" class="Module">Definition.Typed.EqualityRelation</a>
<a id="352" class="Keyword">import</a> <a id="359" href="Definition.Untyped.html" class="Module">Definition.Untyped</a> <a id="378" class="Keyword">hiding</a> <a id="385" class="Symbol">(</a><a id="386" href="Definition.Untyped.NotParametrised.html#1138" class="InductiveConstructor Operator">_∷_</a><a id="389" class="Symbol">)</a>
<a id="391" class="Keyword">open</a> <a id="396" class="Keyword">import</a> <a id="403" href="Definition.Typed.Restrictions.html" class="Module">Definition.Typed.Restrictions</a>
<a id="433" class="Keyword">import</a> <a id="440" href="Definition.Typed.html" class="Module">Definition.Typed</a>
<a id="457" class="Keyword">open</a> <a id="462" class="Keyword">import</a> <a id="469" href="Tools.Empty.html" class="Module">Tools.Empty</a>
<a id="481" class="Keyword">open</a> <a id="486" class="Keyword">import</a> <a id="493" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>
<a id="521" class="Keyword">open</a> <a id="526" class="Keyword">import</a> <a id="533" href="Tools.Sum.html" class="Module">Tools.Sum</a>

<a id="544" class="Keyword">module</a> <a id="551" href="Erasure.Consequences.Soundness.html" class="Module">Erasure.Consequences.Soundness</a>
  <a id="584" class="Symbol">{</a><a id="585" href="Erasure.Consequences.Soundness.html#585" class="Bound">a</a> <a id="587" href="Erasure.Consequences.Soundness.html#587" class="Bound">k</a><a id="588" class="Symbol">}</a> <a id="590" class="Symbol">{</a><a id="591" href="Erasure.Consequences.Soundness.html#591" class="Bound">M</a> <a id="593" class="Symbol">:</a> <a id="595" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="599" href="Erasure.Consequences.Soundness.html#585" class="Bound">a</a><a id="600" class="Symbol">}</a>
  <a id="604" class="Symbol">(</a><a id="605" class="Keyword">open</a> <a id="610" href="Definition.Untyped.html" class="Module">Definition.Untyped</a> <a id="629" href="Erasure.Consequences.Soundness.html#591" class="Bound">M</a><a id="630" class="Symbol">)</a>
  <a id="634" class="Symbol">(</a><a id="635" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a> <a id="637" class="Symbol">:</a> <a id="639" href="Definition.Modality.html#5116" class="Record">Modality</a> <a id="648" href="Erasure.Consequences.Soundness.html#591" class="Bound">M</a><a id="649" class="Symbol">)</a>
  <a id="653" class="Symbol">(</a><a id="654" class="Keyword">open</a> <a id="659" href="Definition.Modality.html#5116" class="Module">Modality</a> <a id="668" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a><a id="669" class="Symbol">)</a>
  <a id="673" class="Symbol">(</a><a id="674" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a> <a id="676" class="Symbol">:</a> <a id="678" href="Definition.Typed.Restrictions.html#379" class="Record">Type-restrictions</a> <a id="696" href="Erasure.Consequences.Soundness.html#591" class="Bound">M</a><a id="697" class="Symbol">)</a>
  <a id="701" class="Symbol">(</a><a id="702" class="Keyword">open</a> <a id="707" href="Definition.Typed.html" class="Module">Definition.Typed</a> <a id="724" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a><a id="725" class="Symbol">)</a>
  <a id="729" class="Symbol">{</a><a id="730" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="732" class="Symbol">:</a> <a id="734" href="Definition.Untyped.NotParametrised.html#781" class="Datatype">Con</a> <a id="738" href="Definition.Untyped.html#1883" class="Datatype">Term</a> <a id="743" href="Erasure.Consequences.Soundness.html#587" class="Bound">k</a><a id="744" class="Symbol">}</a> <a id="746" class="Symbol">(</a><a id="747" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a> <a id="750" class="Symbol">:</a> <a id="752" href="Definition.Typed.html#981" class="Datatype Operator">⊢</a> <a id="754" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a><a id="755" class="Symbol">)</a>
  <a id="759" class="Symbol">(</a><a id="760" href="Erasure.Consequences.Soundness.html#760" class="Bound">𝟘-well-behaved</a> <a id="775" class="Symbol">:</a> <a id="777" href="Definition.Modality.html#2705" class="Record">Has-well-behaved-zero</a> <a id="799" href="Erasure.Consequences.Soundness.html#591" class="Bound">M</a> <a id="801" href="Definition.Modality.html#3912" class="Function">semiring-with-meet</a><a id="819" class="Symbol">)</a>
  <a id="823" class="Symbol">(</a><a id="824" href="Erasure.Consequences.Soundness.html#824" class="Bound">consistent</a> <a id="835" class="Symbol">:</a> <a id="837" class="Symbol">∀</a> <a id="839" class="Symbol">{</a><a id="840" href="Erasure.Consequences.Soundness.html#840" class="Bound">t</a><a id="841" class="Symbol">}</a> <a id="843" class="Symbol">→</a> <a id="845" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="847" href="Definition.Typed.html#1476" class="Datatype Operator">⊢</a> <a id="849" href="Erasure.Consequences.Soundness.html#840" class="Bound">t</a> <a id="851" href="Definition.Typed.html#1476" class="Datatype Operator">∷</a> <a id="853" href="Definition.Untyped.html#2416" class="InductiveConstructor">Empty</a> <a id="859" class="Symbol">→</a> <a id="861" href="Data.Empty.html#526" class="Datatype">⊥</a><a id="862" class="Symbol">)</a>
  <a id="866" class="Comment">-- Erased matches are not allowed unless the context</a>
  <a id="921" class="Comment">-- is empty</a>
  <a id="935" class="Symbol">(</a><a id="936" href="Erasure.Consequences.Soundness.html#936" class="Bound">no-erased-matches</a> <a id="954" class="Symbol">:</a> <a id="956" href="Definition.Modality.Restrictions.Definitions.html#2762" class="Function">No-erased-matches</a> <a id="974" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a> <a id="976" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="978" href="Erasure.Consequences.Soundness.html#587" class="Bound">k</a> <a id="980" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="982" class="Number">0</a><a id="983" class="Symbol">)</a>
  <a id="987" class="Symbol">{{</a><a id="989" href="Erasure.Consequences.Soundness.html#989" class="Bound">eqrel</a> <a id="995" class="Symbol">:</a> <a id="997" href="Definition.Typed.EqualityRelation.html#964" class="Record">EqRelSet</a> <a id="1006" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a><a id="1007" class="Symbol">}}</a>
  <a id="1012" class="Keyword">where</a>

<a id="1019" class="Keyword">open</a> <a id="1024" href="Definition.Typed.EqualityRelation.html#964" class="Module">EqRelSet</a> <a id="1033" class="Symbol">{{...}}</a>

<a id="1042" class="Keyword">open</a> <a id="1047" class="Keyword">import</a> <a id="1054" href="Definition.Typed.Consequences.Inversion.html" class="Module">Definition.Typed.Consequences.Inversion</a> <a id="1094" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a>
<a id="1096" class="Keyword">open</a> <a id="1101" class="Keyword">import</a> <a id="1108" href="Definition.Typed.Consequences.Syntactic.html" class="Module">Definition.Typed.Consequences.Syntactic</a> <a id="1148" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a>
<a id="1150" class="Keyword">open</a> <a id="1155" class="Keyword">import</a> <a id="1162" href="Definition.Typed.Properties.html" class="Module">Definition.Typed.Properties</a> <a id="1190" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a>
<a id="1192" class="Keyword">open</a> <a id="1197" class="Keyword">import</a> <a id="1204" href="Definition.LogicalRelation.html" class="Module">Definition.LogicalRelation</a> <a id="1231" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a>

<a id="1234" class="Keyword">open</a> <a id="1239" class="Keyword">import</a> <a id="1246" href="Definition.Modality.Context.html" class="Module">Definition.Modality.Context</a> <a id="1274" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a>
<a id="1276" class="Keyword">open</a> <a id="1281" class="Keyword">import</a> <a id="1288" href="Definition.Modality.Usage.html" class="Module">Definition.Modality.Usage</a> <a id="1314" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a>
<a id="1316" class="Keyword">open</a> <a id="1321" class="Keyword">import</a> <a id="1328" href="Definition.Modality.Properties.Has-well-behaved-zero.html" class="Module">Definition.Modality.Properties.Has-well-behaved-zero</a>
  <a id="1383" href="Definition.Modality.html#5158" class="Field">semiring-with-meet-and-star</a> <a id="1411" href="Erasure.Consequences.Soundness.html#760" class="Bound">𝟘-well-behaved</a>
<a id="1426" class="Keyword">open</a> <a id="1431" class="Keyword">import</a> <a id="1438" href="Definition.Mode.html" class="Module">Definition.Mode</a> <a id="1454" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a>

<a id="1457" class="Keyword">import</a> <a id="1464" href="Erasure.Target.html" class="Module">Erasure.Target</a> <a id="1479" class="Symbol">as</a> <a id="1482" class="Module">T</a>
<a id="1484" class="Keyword">open</a> <a id="1489" class="Keyword">import</a> <a id="1496" href="Erasure.Extraction.html" class="Module">Erasure.Extraction</a> <a id="1515" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a> <a id="1517" href="Definition.Modality.html#2915" class="Function">is-𝟘?</a>
<a id="1523" class="Keyword">open</a> <a id="1528" class="Keyword">import</a> <a id="1535" href="Erasure.SucRed.html" class="Module">Erasure.SucRed</a> <a id="1550" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a>
<a id="1552" class="Keyword">open</a> <a id="1557" class="Keyword">import</a> <a id="1564" href="Erasure.LogicalRelation.html" class="Module">Erasure.LogicalRelation</a> <a id="1588" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a> <a id="1590" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a> <a id="1592" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a> <a id="1595" href="Definition.Modality.html#2915" class="Function">is-𝟘?</a>
<a id="1601" class="Keyword">open</a> <a id="1606" class="Keyword">import</a> <a id="1613" href="Erasure.LogicalRelation.Fundamental.html" class="Module">Erasure.LogicalRelation.Fundamental</a>
  <a id="1651" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a> <a id="1653" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a> <a id="1655" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a> <a id="1658" href="Erasure.Consequences.Soundness.html#760" class="Bound">𝟘-well-behaved</a> <a id="1673" href="Erasure.Consequences.Soundness.html#824" class="Bound">consistent</a> <a id="1684" href="Erasure.Consequences.Soundness.html#936" class="Bound">no-erased-matches</a>
<a id="1702" class="Keyword">open</a> <a id="1707" class="Keyword">import</a> <a id="1714" href="Erasure.LogicalRelation.Irrelevance.html" class="Module">Erasure.LogicalRelation.Irrelevance</a> <a id="1750" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a> <a id="1752" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a> <a id="1754" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a> <a id="1757" href="Definition.Modality.html#2915" class="Function">is-𝟘?</a>
<a id="1763" class="Keyword">open</a> <a id="1768" class="Keyword">import</a> <a id="1775" href="Erasure.LogicalRelation.Subsumption.html" class="Module">Erasure.LogicalRelation.Subsumption</a> <a id="1811" href="Erasure.Consequences.Soundness.html#635" class="Bound">𝕄</a> <a id="1813" href="Erasure.Consequences.Soundness.html#674" class="Bound">R</a> <a id="1815" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a> <a id="1818" href="Definition.Modality.html#2915" class="Function">is-𝟘?</a>

<a id="1825" class="Keyword">open</a> <a id="1830" class="Keyword">import</a> <a id="1837" href="Tools.Nat.html" class="Module">Tools.Nat</a>
<a id="1847" class="Keyword">open</a> <a id="1852" class="Keyword">import</a> <a id="1859" href="Tools.Product.html" class="Module">Tools.Product</a>


<a id="1875" class="Keyword">private</a>
  <a id="1885" class="Keyword">variable</a>
    <a id="1898" href="Erasure.Consequences.Soundness.html#1898" class="Generalizable">n</a> <a id="1900" class="Symbol">:</a> <a id="1902" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a>
    <a id="1910" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="1912" href="Erasure.Consequences.Soundness.html#1912" class="Generalizable">t′</a> <a id="1915" href="Erasure.Consequences.Soundness.html#1915" class="Generalizable">u</a> <a id="1917" href="Erasure.Consequences.Soundness.html#1917" class="Generalizable">F</a> <a id="1919" class="Symbol">:</a> <a id="1921" href="Definition.Untyped.html#1883" class="Datatype">Term</a> <a id="1926" href="Erasure.Consequences.Soundness.html#1898" class="Generalizable">n</a>
    <a id="1932" href="Erasure.Consequences.Soundness.html#1932" class="Generalizable">G</a> <a id="1934" class="Symbol">:</a> <a id="1936" href="Definition.Untyped.html#1883" class="Datatype">Term</a> <a id="1941" class="Symbol">(</a><a id="1942" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="1945" href="Erasure.Consequences.Soundness.html#1898" class="Generalizable">n</a><a id="1946" class="Symbol">)</a>
    <a id="1952" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="1954" href="Erasure.Consequences.Soundness.html#1954" class="Generalizable">v′</a> <a id="1957" href="Erasure.Consequences.Soundness.html#1957" class="Generalizable">w</a> <a id="1959" class="Symbol">:</a> <a id="1961" href="Erasure.Target.html#486" class="Datatype">T.Term</a> <a id="1968" href="Erasure.Consequences.Soundness.html#1898" class="Generalizable">n</a>

<a id="1971" class="Comment">-- WH reduction soundness of natural numbers</a>

<a id="2017" class="Comment">-- Canonical representation of natural numbers</a>

<a id="sucᵏ"></a><a id="2065" href="Erasure.Consequences.Soundness.html#2065" class="Function">sucᵏ</a> <a id="2070" class="Symbol">:</a> <a id="2072" class="Symbol">(</a><a id="2073" href="Erasure.Consequences.Soundness.html#2073" class="Bound">k</a> <a id="2075" class="Symbol">:</a> <a id="2077" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a><a id="2080" class="Symbol">)</a> <a id="2082" class="Symbol">→</a> <a id="2084" href="Definition.Untyped.html#1883" class="Datatype">Term</a> <a id="2089" href="Erasure.Consequences.Soundness.html#1898" class="Generalizable">n</a>
<a id="2091" href="Erasure.Consequences.Soundness.html#2065" class="Function">sucᵏ</a> <a id="2096" class="Number">0</a>      <a id="2103" class="Symbol">=</a> <a id="2105" href="Definition.Untyped.html#3421" class="InductiveConstructor">zero</a>
<a id="2110" href="Erasure.Consequences.Soundness.html#2065" class="Function">sucᵏ</a> <a id="2115" class="Symbol">(</a><a id="2116" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="2119" href="Erasure.Consequences.Soundness.html#2119" class="Bound">n</a><a id="2120" class="Symbol">)</a> <a id="2122" class="Symbol">=</a> <a id="2124" href="Definition.Untyped.html#3452" class="InductiveConstructor">suc</a> <a id="2128" class="Symbol">(</a><a id="2129" href="Erasure.Consequences.Soundness.html#2065" class="Function">sucᵏ</a> <a id="2134" href="Erasure.Consequences.Soundness.html#2119" class="Bound">n</a><a id="2135" class="Symbol">)</a>

<a id="sucᵏ′"></a><a id="2138" href="Erasure.Consequences.Soundness.html#2138" class="Function">sucᵏ′</a> <a id="2144" class="Symbol">:</a> <a id="2146" class="Symbol">(</a><a id="2147" href="Erasure.Consequences.Soundness.html#2147" class="Bound">k</a> <a id="2149" class="Symbol">:</a> <a id="2151" href="Agda.Builtin.Nat.html#186" class="Datatype">Nat</a><a id="2154" class="Symbol">)</a> <a id="2156" class="Symbol">→</a> <a id="2158" href="Erasure.Target.html#486" class="Datatype">T.Term</a> <a id="2165" href="Erasure.Consequences.Soundness.html#1898" class="Generalizable">n</a>
<a id="2167" href="Erasure.Consequences.Soundness.html#2138" class="Function">sucᵏ′</a> <a id="2173" class="Number">0</a>      <a id="2180" class="Symbol">=</a> <a id="2182" href="Erasure.Target.html#625" class="InductiveConstructor">T.zero</a>
<a id="2189" href="Erasure.Consequences.Soundness.html#2138" class="Function">sucᵏ′</a> <a id="2195" class="Symbol">(</a><a id="2196" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="2199" href="Erasure.Consequences.Soundness.html#2199" class="Bound">n</a><a id="2200" class="Symbol">)</a> <a id="2202" class="Symbol">=</a> <a id="2204" href="Erasure.Target.html#646" class="InductiveConstructor">T.suc</a> <a id="2210" class="Symbol">(</a><a id="2211" href="Erasure.Consequences.Soundness.html#2138" class="Function">sucᵏ′</a> <a id="2217" href="Erasure.Consequences.Soundness.html#2199" class="Bound">n</a><a id="2218" class="Symbol">)</a>

<a id="2221" class="Comment">-- Helper lemma for WH reduction soundness of zero</a>
<a id="2272" class="Comment">-- If t ® v ∷ℕ  and t ⇒* zero then v ⇒* zero</a>

<a id="soundness-zero′"></a><a id="2318" href="Erasure.Consequences.Soundness.html#2318" class="Function">soundness-zero′</a> <a id="2334" class="Symbol">:</a> <a id="2336" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="2338" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">®</a> <a id="2340" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="2342" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">∷ℕ</a> <a id="2345" class="Symbol">→</a> <a id="2347" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="2349" href="Definition.Typed.html#13078" class="Datatype Operator">⊢</a> <a id="2351" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="2353" href="Definition.Typed.html#13078" class="Datatype Operator">⇒*</a> <a id="2356" href="Definition.Untyped.html#3421" class="InductiveConstructor">zero</a> <a id="2361" href="Definition.Typed.html#13078" class="Datatype Operator">∷</a> <a id="2363" href="Definition.Untyped.html#2389" class="InductiveConstructor">ℕ</a> <a id="2365" class="Symbol">→</a> <a id="2367" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="2369" href="Erasure.Target.html#5995" class="Datatype Operator">T.⇒*</a> <a id="2374" href="Erasure.Target.html#625" class="InductiveConstructor">T.zero</a>
<a id="2381" href="Erasure.Consequences.Soundness.html#2318" class="Function">soundness-zero′</a> <a id="2397" class="Symbol">(</a><a id="2398" href="Erasure.LogicalRelation.html#1472" class="InductiveConstructor">zeroᵣ</a> <a id="2404" href="Erasure.Consequences.Soundness.html#2404" class="Bound">t⇒zero′</a> <a id="2412" href="Erasure.Consequences.Soundness.html#2412" class="Bound">v⇒zero</a><a id="2418" class="Symbol">)</a> <a id="2420" href="Erasure.Consequences.Soundness.html#2420" class="Bound">t⇒zero</a> <a id="2427" class="Symbol">=</a> <a id="2429" href="Erasure.Consequences.Soundness.html#2412" class="Bound">v⇒zero</a>
<a id="2436" href="Erasure.Consequences.Soundness.html#2318" class="Function">soundness-zero′</a> <a id="2452" class="Symbol">(</a><a id="2453" href="Erasure.LogicalRelation.html#1529" class="InductiveConstructor">sucᵣ</a> <a id="2458" href="Erasure.Consequences.Soundness.html#2458" class="Bound">t⇒suc</a> <a id="2464" href="Erasure.Consequences.Soundness.html#2464" class="Bound">v⇒suc</a> <a id="2470" href="Erasure.Consequences.Soundness.html#2470" class="Bound">t®v</a><a id="2473" class="Symbol">)</a> <a id="2475" href="Erasure.Consequences.Soundness.html#2475" class="Bound">t⇒zero</a>
  <a id="2484" class="Keyword">with</a> <a id="2489" href="Definition.Typed.Properties.html#10789" class="Function">whrDet*Term</a> <a id="2501" class="Symbol">(</a><a id="2502" href="Erasure.Consequences.Soundness.html#2475" class="Bound">t⇒zero</a> <a id="2509" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2511" href="Definition.Untyped.html#5940" class="InductiveConstructor">zeroₙ</a><a id="2516" class="Symbol">)</a> <a id="2518" class="Symbol">(</a><a id="2519" href="Erasure.Consequences.Soundness.html#2458" class="Bound">t⇒suc</a> <a id="2525" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2527" href="Definition.Untyped.html#5960" class="InductiveConstructor">sucₙ</a><a id="2531" class="Symbol">)</a>
<a id="2533" class="Symbol">...</a> <a id="2537" class="Symbol">|</a> <a id="2539" class="Symbol">()</a>

<a id="2543" class="Comment">-- WH reduction soundness of zero</a>
<a id="2577" class="Comment">-- If t ⇒* zero and 𝟘ᶜ ▸ t then erase t ⇒* zero</a>

<a id="soundness-zero"></a><a id="2626" href="Erasure.Consequences.Soundness.html#2626" class="Function">soundness-zero</a> <a id="2641" class="Symbol">:</a>
  <a id="2645" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="2647" href="Definition.Typed.html#13078" class="Datatype Operator">⊢</a> <a id="2649" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="2651" href="Definition.Typed.html#13078" class="Datatype Operator">⇒*</a> <a id="2654" href="Definition.Untyped.html#3421" class="InductiveConstructor">zero</a> <a id="2659" href="Definition.Typed.html#13078" class="Datatype Operator">∷</a> <a id="2661" href="Definition.Untyped.html#2389" class="InductiveConstructor">ℕ</a> <a id="2663" class="Symbol">→</a> <a id="2665" href="Definition.Modality.Context.html#2011" class="Function">𝟘ᶜ</a> <a id="2668" href="Definition.Modality.Usage.html#1055" class="Datatype Operator">▸[</a> <a id="2671" href="Definition.Mode.html#1066" class="InductiveConstructor">𝟙ᵐ</a> <a id="2674" href="Definition.Modality.Usage.html#1055" class="Datatype Operator">]</a> <a id="2676" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="2678" class="Symbol">→</a> <a id="2680" href="Erasure.Extraction.html#972" class="Function">erase</a> <a id="2686" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="2688" href="Erasure.Target.html#5995" class="Datatype Operator">T.⇒*</a> <a id="2693" href="Erasure.Target.html#625" class="InductiveConstructor">T.zero</a>
<a id="2700" href="Erasure.Consequences.Soundness.html#2626" class="Function">soundness-zero</a> <a id="2715" href="Erasure.Consequences.Soundness.html#2715" class="Bound">t⇒zero</a> <a id="2722" href="Erasure.Consequences.Soundness.html#2722" class="Bound">𝟘▸t</a> <a id="2726" class="Symbol">=</a>
  <a id="2730" class="Keyword">let</a> <a id="2734" href="Erasure.Consequences.Soundness.html#2734" class="Bound">⊢t</a> <a id="2737" class="Symbol">=</a> <a id="2739" href="Definition.Typed.Properties.html#5095" class="Function">redFirst*Term</a> <a id="2753" href="Erasure.Consequences.Soundness.html#2715" class="Bound">t⇒zero</a>
      <a id="2766" href="Erasure.Consequences.Soundness.html#2766" class="Bound">[ℕ]</a> <a id="2770" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2772" href="Erasure.Consequences.Soundness.html#2772" class="Bound">t®t′</a> <a id="2777" class="Symbol">=</a> <a id="2779" href="Erasure.LogicalRelation.Fundamental.html#15843" class="Function">fundamentalErased</a> <a id="2797" href="Erasure.Consequences.Soundness.html#2734" class="Bound">⊢t</a> <a id="2800" href="Erasure.Consequences.Soundness.html#2722" class="Bound">𝟘▸t</a>
      <a id="2810" href="Erasure.Consequences.Soundness.html#2810" class="Bound">t®t″</a> <a id="2815" class="Symbol">=</a> <a id="2817" href="Erasure.LogicalRelation.Irrelevance.html#3967" class="Function">irrelevanceTerm</a> <a id="2833" class="Symbol">{</a><a id="2834" class="Argument">l′</a> <a id="2837" class="Symbol">=</a> <a id="2839" href="Definition.LogicalRelation.html#5984" class="InductiveConstructor">¹</a><a id="2840" class="Symbol">}</a> <a id="2842" href="Erasure.Consequences.Soundness.html#2766" class="Bound">[ℕ]</a> <a id="2846" class="Symbol">(</a><a id="2847" href="Definition.LogicalRelation.html#14813" class="InductiveConstructor">ℕᵣ</a> <a id="2850" class="Symbol">(</a><a id="2851" href="Definition.Typed.Properties.html#12363" class="Function">idRed:*:</a> <a id="2860" class="Symbol">(</a><a id="2861" href="Definition.Typed.html#1176" class="InductiveConstructor">ℕⱼ</a> <a id="2864" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a><a id="2866" class="Symbol">)))</a> <a id="2870" class="Symbol">(</a><a id="2871" href="Erasure.Consequences.Soundness.html#2772" class="Bound">t®t′</a> <a id="2876" href="Erasure.LogicalRelation.Subsumption.html#2069" class="Function Operator">◀≢𝟘</a> <a id="2880" href="Definition.Modality.html#2839" class="Function">𝟙≉𝟘</a><a id="2883" class="Symbol">)</a>
  <a id="2887" class="Keyword">in</a>  <a id="2891" href="Erasure.Consequences.Soundness.html#2318" class="Function">soundness-zero′</a> <a id="2907" href="Erasure.Consequences.Soundness.html#2810" class="Bound">t®t″</a> <a id="2912" href="Erasure.Consequences.Soundness.html#2715" class="Bound">t⇒zero</a>

<a id="2920" class="Comment">-- Helper lemma for WH reduction soundness of suc</a>
<a id="2970" class="Comment">-- If t ® v ∷ℕ  and t ⇒* suc t′ then v ⇒* suc v′ and t′ ® v′ ∷ℕ for some v′</a>

<a id="soundness-suc′"></a><a id="3047" href="Erasure.Consequences.Soundness.html#3047" class="Function">soundness-suc′</a> <a id="3062" class="Symbol">:</a> <a id="3064" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="3066" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">®</a> <a id="3068" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="3070" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">∷ℕ</a> <a id="3073" class="Symbol">→</a> <a id="3075" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="3077" href="Definition.Typed.html#13078" class="Datatype Operator">⊢</a> <a id="3079" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="3081" href="Definition.Typed.html#13078" class="Datatype Operator">⇒*</a> <a id="3084" href="Definition.Untyped.html#3452" class="InductiveConstructor">suc</a> <a id="3088" href="Erasure.Consequences.Soundness.html#1912" class="Generalizable">t′</a> <a id="3091" href="Definition.Typed.html#13078" class="Datatype Operator">∷</a> <a id="3093" href="Definition.Untyped.html#2389" class="InductiveConstructor">ℕ</a>
               <a id="3110" class="Symbol">→</a> <a id="3112" href="Data.Product.html#1369" class="Function">∃</a> <a id="3114" class="Symbol">λ</a> <a id="3116" href="Erasure.Consequences.Soundness.html#3116" class="Bound">v′</a> <a id="3119" class="Symbol">→</a> <a id="3121" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="3123" href="Erasure.Target.html#5995" class="Datatype Operator">T.⇒*</a> <a id="3128" href="Erasure.Target.html#646" class="InductiveConstructor">T.suc</a> <a id="3134" href="Erasure.Consequences.Soundness.html#3116" class="Bound">v′</a> <a id="3137" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3139" href="Erasure.Consequences.Soundness.html#1912" class="Generalizable">t′</a> <a id="3142" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">®</a> <a id="3144" href="Erasure.Consequences.Soundness.html#3116" class="Bound">v′</a> <a id="3147" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">∷ℕ</a>
<a id="3150" href="Erasure.Consequences.Soundness.html#3047" class="Function">soundness-suc′</a> <a id="3165" class="Symbol">(</a><a id="3166" href="Erasure.LogicalRelation.html#1472" class="InductiveConstructor">zeroᵣ</a> <a id="3172" href="Erasure.Consequences.Soundness.html#3172" class="Bound">t⇒zero</a> <a id="3179" href="Erasure.Consequences.Soundness.html#3179" class="Bound">v⇒zero</a><a id="3185" class="Symbol">)</a> <a id="3187" href="Erasure.Consequences.Soundness.html#3187" class="Bound">t⇒suc</a>
  <a id="3195" class="Keyword">with</a> <a id="3200" href="Definition.Typed.Properties.html#10789" class="Function">whrDet*Term</a> <a id="3212" class="Symbol">(</a><a id="3213" href="Erasure.Consequences.Soundness.html#3172" class="Bound">t⇒zero</a> <a id="3220" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3222" href="Definition.Untyped.html#5940" class="InductiveConstructor">zeroₙ</a><a id="3227" class="Symbol">)</a> <a id="3229" class="Symbol">(</a><a id="3230" href="Erasure.Consequences.Soundness.html#3187" class="Bound">t⇒suc</a> <a id="3236" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3238" href="Definition.Untyped.html#5960" class="InductiveConstructor">sucₙ</a><a id="3242" class="Symbol">)</a>
<a id="3244" class="Symbol">...</a> <a id="3248" class="Symbol">|</a> <a id="3250" class="Symbol">()</a>
<a id="3253" href="Erasure.Consequences.Soundness.html#3047" class="Function">soundness-suc′</a> <a id="3268" class="Symbol">(</a><a id="3269" href="Erasure.LogicalRelation.html#1529" class="InductiveConstructor">sucᵣ</a> <a id="3274" class="Symbol">{</a><a id="3275" class="Argument">v′</a> <a id="3278" class="Symbol">=</a> <a id="3280" href="Erasure.Consequences.Soundness.html#3280" class="Bound">v′</a><a id="3282" class="Symbol">}</a> <a id="3284" href="Erasure.Consequences.Soundness.html#3284" class="Bound">t⇒suc′</a> <a id="3291" href="Erasure.Consequences.Soundness.html#3291" class="Bound">v⇒suc</a> <a id="3297" href="Erasure.Consequences.Soundness.html#3297" class="Bound">t®v</a><a id="3300" class="Symbol">)</a> <a id="3302" href="Erasure.Consequences.Soundness.html#3302" class="Bound">t⇒suc</a>
  <a id="3310" class="Keyword">with</a> <a id="3315" href="Definition.Typed.Properties.html#10789" class="Function">whrDet*Term</a> <a id="3327" class="Symbol">(</a><a id="3328" href="Erasure.Consequences.Soundness.html#3302" class="Bound">t⇒suc</a> <a id="3334" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3336" href="Definition.Untyped.html#5960" class="InductiveConstructor">sucₙ</a><a id="3340" class="Symbol">)</a> <a id="3342" class="Symbol">(</a><a id="3343" href="Erasure.Consequences.Soundness.html#3284" class="Bound">t⇒suc′</a> <a id="3350" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3352" href="Definition.Untyped.html#5960" class="InductiveConstructor">sucₙ</a><a id="3356" class="Symbol">)</a>
<a id="3358" class="Symbol">...</a> <a id="3362" class="Symbol">|</a> <a id="3364" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3369" class="Symbol">=</a> <a id="3371" class="Bound">v′</a> <a id="3374" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3376" class="Symbol">(</a><a id="3377" class="Bound">v⇒suc</a> <a id="3383" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3385" class="Bound">t®v</a><a id="3388" class="Symbol">)</a>

<a id="3391" class="Comment">-- WH reduction soundness of suc</a>
<a id="3424" class="Comment">-- If t ⇒* suc t′ and 𝟘ᶜ ▸ t then erase t ⇒* suc v′ and t′ ® v′ ∷ℕ for some v′</a>

<a id="soundness-suc"></a><a id="3504" href="Erasure.Consequences.Soundness.html#3504" class="Function">soundness-suc</a> <a id="3518" class="Symbol">:</a> <a id="3520" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="3522" href="Definition.Typed.html#13078" class="Datatype Operator">⊢</a> <a id="3524" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="3526" href="Definition.Typed.html#13078" class="Datatype Operator">⇒*</a> <a id="3529" href="Definition.Untyped.html#3452" class="InductiveConstructor">suc</a> <a id="3533" href="Erasure.Consequences.Soundness.html#1912" class="Generalizable">t′</a> <a id="3536" href="Definition.Typed.html#13078" class="Datatype Operator">∷</a> <a id="3538" href="Definition.Untyped.html#2389" class="InductiveConstructor">ℕ</a> <a id="3540" class="Symbol">→</a> <a id="3542" href="Definition.Modality.Context.html#2011" class="Function">𝟘ᶜ</a> <a id="3545" href="Definition.Modality.Usage.html#1055" class="Datatype Operator">▸[</a> <a id="3548" href="Definition.Mode.html#1066" class="InductiveConstructor">𝟙ᵐ</a> <a id="3551" href="Definition.Modality.Usage.html#1055" class="Datatype Operator">]</a> <a id="3553" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a>
              <a id="3569" class="Symbol">→</a> <a id="3571" href="Data.Product.html#1369" class="Function">∃</a> <a id="3573" class="Symbol">λ</a> <a id="3575" href="Erasure.Consequences.Soundness.html#3575" class="Bound">v′</a> <a id="3578" class="Symbol">→</a> <a id="3580" href="Erasure.Extraction.html#972" class="Function">erase</a> <a id="3586" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="3588" href="Erasure.Target.html#5995" class="Datatype Operator">T.⇒*</a> <a id="3593" href="Erasure.Target.html#646" class="InductiveConstructor">T.suc</a> <a id="3599" href="Erasure.Consequences.Soundness.html#3575" class="Bound">v′</a> <a id="3602" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3604" href="Erasure.Consequences.Soundness.html#1912" class="Generalizable">t′</a> <a id="3607" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">®</a> <a id="3609" href="Erasure.Consequences.Soundness.html#3575" class="Bound">v′</a> <a id="3612" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">∷ℕ</a>
<a id="3615" href="Erasure.Consequences.Soundness.html#3504" class="Function">soundness-suc</a> <a id="3629" href="Erasure.Consequences.Soundness.html#3629" class="Bound">t⇒suc</a> <a id="3635" href="Erasure.Consequences.Soundness.html#3635" class="Bound">𝟘▸t</a> <a id="3639" class="Symbol">=</a>
  <a id="3643" class="Keyword">let</a> <a id="3647" href="Erasure.Consequences.Soundness.html#3647" class="Bound">⊢t</a> <a id="3650" class="Symbol">=</a> <a id="3652" href="Definition.Typed.Properties.html#5095" class="Function">redFirst*Term</a> <a id="3666" href="Erasure.Consequences.Soundness.html#3629" class="Bound">t⇒suc</a>
      <a id="3678" href="Erasure.Consequences.Soundness.html#3678" class="Bound">[ℕ]</a> <a id="3682" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3684" href="Erasure.Consequences.Soundness.html#3684" class="Bound">t®t′</a> <a id="3689" class="Symbol">=</a> <a id="3691" href="Erasure.LogicalRelation.Fundamental.html#15843" class="Function">fundamentalErased</a> <a id="3709" href="Erasure.Consequences.Soundness.html#3647" class="Bound">⊢t</a> <a id="3712" href="Erasure.Consequences.Soundness.html#3635" class="Bound">𝟘▸t</a>
      <a id="3722" href="Erasure.Consequences.Soundness.html#3722" class="Bound">t®t″</a> <a id="3727" class="Symbol">=</a> <a id="3729" href="Erasure.LogicalRelation.Irrelevance.html#3967" class="Function">irrelevanceTerm</a> <a id="3745" class="Symbol">{</a><a id="3746" class="Argument">l′</a> <a id="3749" class="Symbol">=</a> <a id="3751" href="Definition.LogicalRelation.html#5984" class="InductiveConstructor">¹</a><a id="3752" class="Symbol">}</a> <a id="3754" href="Erasure.Consequences.Soundness.html#3678" class="Bound">[ℕ]</a> <a id="3758" class="Symbol">(</a><a id="3759" href="Definition.LogicalRelation.html#14813" class="InductiveConstructor">ℕᵣ</a> <a id="3762" class="Symbol">(</a><a id="3763" href="Definition.Typed.Properties.html#12363" class="Function">idRed:*:</a> <a id="3772" class="Symbol">(</a><a id="3773" href="Definition.Typed.html#1176" class="InductiveConstructor">ℕⱼ</a> <a id="3776" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a><a id="3778" class="Symbol">)))</a> <a id="3782" class="Symbol">(</a><a id="3783" href="Erasure.Consequences.Soundness.html#3684" class="Bound">t®t′</a> <a id="3788" href="Erasure.LogicalRelation.Subsumption.html#2069" class="Function Operator">◀≢𝟘</a> <a id="3792" href="Definition.Modality.html#2839" class="Function">𝟙≉𝟘</a><a id="3795" class="Symbol">)</a>
  <a id="3799" class="Keyword">in</a>  <a id="3803" href="Erasure.Consequences.Soundness.html#3047" class="Function">soundness-suc′</a> <a id="3818" href="Erasure.Consequences.Soundness.html#3722" class="Bound">t®t″</a> <a id="3823" href="Erasure.Consequences.Soundness.html#3629" class="Bound">t⇒suc</a>

<a id="3830" class="Comment">-- Helper lemma for soundness of natural numbers</a>

<a id="soundness-ℕ′"></a><a id="3880" href="Erasure.Consequences.Soundness.html#3880" class="Function">soundness-ℕ′</a> <a id="3893" class="Symbol">:</a> <a id="3895" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="3897" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">®</a> <a id="3899" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="3901" href="Erasure.LogicalRelation.html#1420" class="Datatype Operator">∷ℕ</a> <a id="3904" class="Symbol">→</a> <a id="3906" href="Data.Product.html#1369" class="Function">∃</a> <a id="3908" class="Symbol">λ</a> <a id="3910" href="Erasure.Consequences.Soundness.html#3910" class="Bound">n</a> <a id="3912" class="Symbol">→</a> <a id="3914" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="3916" href="Erasure.SucRed.html#926" class="Datatype Operator">⊢</a> <a id="3918" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="3920" href="Erasure.SucRed.html#926" class="Datatype Operator">⇒ˢ*</a> <a id="3924" href="Erasure.Consequences.Soundness.html#2065" class="Function">sucᵏ</a> <a id="3929" href="Erasure.Consequences.Soundness.html#3910" class="Bound">n</a> <a id="3931" href="Erasure.SucRed.html#926" class="Datatype Operator">∷ℕ</a> <a id="3934" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3936" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="3938" href="Erasure.SucRed.html#2008" class="Datatype Operator">⇒ˢ*</a> <a id="3942" href="Erasure.Consequences.Soundness.html#2138" class="Function">sucᵏ′</a> <a id="3948" href="Erasure.Consequences.Soundness.html#3910" class="Bound">n</a>
<a id="3950" href="Erasure.Consequences.Soundness.html#3880" class="Function">soundness-ℕ′</a> <a id="3963" class="Symbol">(</a><a id="3964" href="Erasure.LogicalRelation.html#1472" class="InductiveConstructor">zeroᵣ</a> <a id="3970" href="Erasure.Consequences.Soundness.html#3970" class="Bound">x</a> <a id="3972" href="Erasure.Consequences.Soundness.html#3972" class="Bound">x₁</a><a id="3974" class="Symbol">)</a> <a id="3976" class="Symbol">=</a> <a id="3978" class="Number">0</a> <a id="3980" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3982" href="Erasure.SucRed.html#1219" class="Function">whred*</a> <a id="3989" href="Erasure.Consequences.Soundness.html#3970" class="Bound">x</a> <a id="3991" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3993" href="Erasure.SucRed.html#2222" class="Function">whred*′</a> <a id="4001" href="Erasure.Consequences.Soundness.html#3972" class="Bound">x₁</a>
<a id="4004" href="Erasure.Consequences.Soundness.html#3880" class="Function">soundness-ℕ′</a> <a id="4017" class="Symbol">(</a><a id="4018" href="Erasure.LogicalRelation.html#1529" class="InductiveConstructor">sucᵣ</a> <a id="4023" href="Erasure.Consequences.Soundness.html#4023" class="Bound">x</a> <a id="4025" href="Erasure.Consequences.Soundness.html#4025" class="Bound">x₁</a> <a id="4028" href="Erasure.Consequences.Soundness.html#4028" class="Bound">t®v</a><a id="4031" class="Symbol">)</a> <a id="4033" class="Symbol">=</a>
  <a id="4037" class="Keyword">let</a> <a id="4041" href="Erasure.Consequences.Soundness.html#4041" class="Bound">n</a> <a id="4043" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4045" href="Erasure.Consequences.Soundness.html#4045" class="Bound">d</a> <a id="4047" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4049" href="Erasure.Consequences.Soundness.html#4049" class="Bound">d′</a> <a id="4052" class="Symbol">=</a> <a id="4054" href="Erasure.Consequences.Soundness.html#3880" class="Function">soundness-ℕ′</a> <a id="4067" href="Erasure.Consequences.Soundness.html#4028" class="Bound">t®v</a>
  <a id="4073" class="Keyword">in</a>  <a id="4077" href="Tools.Nat.html#408" class="InductiveConstructor">1+</a> <a id="4080" href="Erasure.Consequences.Soundness.html#4041" class="Bound">n</a> <a id="4082" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4084" href="Erasure.SucRed.html#1078" class="Function">⇒ˢ*∷ℕ-trans</a> <a id="4096" class="Symbol">(</a><a id="4097" href="Erasure.SucRed.html#1219" class="Function">whred*</a> <a id="4104" href="Erasure.Consequences.Soundness.html#4023" class="Bound">x</a><a id="4105" class="Symbol">)</a> <a id="4107" class="Symbol">(</a><a id="4108" href="Erasure.SucRed.html#1319" class="Function">sucred*</a> <a id="4116" href="Erasure.Consequences.Soundness.html#4045" class="Bound">d</a><a id="4117" class="Symbol">)</a>
           <a id="4130" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4132" href="Erasure.SucRed.html#2102" class="Function">⇒ˢ*-trans</a> <a id="4142" class="Symbol">(</a><a id="4143" href="Erasure.SucRed.html#2222" class="Function">whred*′</a> <a id="4151" href="Erasure.Consequences.Soundness.html#4025" class="Bound">x₁</a><a id="4153" class="Symbol">)</a> <a id="4155" class="Symbol">(</a><a id="4156" href="Erasure.SucRed.html#2326" class="Function">sucred*′</a> <a id="4165" href="Erasure.Consequences.Soundness.html#4049" class="Bound">d′</a><a id="4167" class="Symbol">)</a>

<a id="4170" class="Comment">-- Soundness for erasure of natural numbers</a>
<a id="4214" class="Comment">-- Well-typed terms of the natural number type reduce to numerals</a>
<a id="4280" class="Comment">-- if erased matches are disallowed or the term is closed.</a>

<a id="soundness-ℕ"></a><a id="4340" href="Erasure.Consequences.Soundness.html#4340" class="Function">soundness-ℕ</a> <a id="4352" class="Symbol">:</a> <a id="4354" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="4356" href="Definition.Typed.html#1476" class="Datatype Operator">⊢</a> <a id="4358" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="4360" href="Definition.Typed.html#1476" class="Datatype Operator">∷</a> <a id="4362" href="Definition.Untyped.html#2389" class="InductiveConstructor">ℕ</a> <a id="4364" class="Symbol">→</a> <a id="4366" href="Definition.Modality.Context.html#2011" class="Function">𝟘ᶜ</a> <a id="4369" href="Definition.Modality.Usage.html#1055" class="Datatype Operator">▸[</a> <a id="4372" href="Definition.Mode.html#1066" class="InductiveConstructor">𝟙ᵐ</a> <a id="4375" href="Definition.Modality.Usage.html#1055" class="Datatype Operator">]</a> <a id="4377" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a>
            <a id="4391" class="Symbol">→</a> <a id="4393" href="Data.Product.html#1369" class="Function">∃</a> <a id="4395" class="Symbol">λ</a> <a id="4397" href="Erasure.Consequences.Soundness.html#4397" class="Bound">n</a> <a id="4399" class="Symbol">→</a> <a id="4401" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="4403" href="Erasure.SucRed.html#926" class="Datatype Operator">⊢</a> <a id="4405" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="4407" href="Erasure.SucRed.html#926" class="Datatype Operator">⇒ˢ*</a> <a id="4411" href="Erasure.Consequences.Soundness.html#2065" class="Function">sucᵏ</a> <a id="4416" href="Erasure.Consequences.Soundness.html#4397" class="Bound">n</a> <a id="4418" href="Erasure.SucRed.html#926" class="Datatype Operator">∷ℕ</a> <a id="4421" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4423" href="Erasure.Extraction.html#972" class="Function">erase</a> <a id="4429" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="4431" href="Erasure.SucRed.html#2008" class="Datatype Operator">⇒ˢ*</a> <a id="4435" href="Erasure.Consequences.Soundness.html#2138" class="Function">sucᵏ′</a> <a id="4441" href="Erasure.Consequences.Soundness.html#4397" class="Bound">n</a>
<a id="4443" href="Erasure.Consequences.Soundness.html#4340" class="Function">soundness-ℕ</a> <a id="4455" href="Erasure.Consequences.Soundness.html#4455" class="Bound">⊢t</a> <a id="4458" href="Erasure.Consequences.Soundness.html#4458" class="Bound">𝟘▸t</a> <a id="4462" class="Symbol">=</a>
  <a id="4466" class="Keyword">let</a> <a id="4470" href="Erasure.Consequences.Soundness.html#4470" class="Bound">[ℕ]</a> <a id="4474" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4476" href="Erasure.Consequences.Soundness.html#4476" class="Bound">t®v</a> <a id="4480" class="Symbol">=</a> <a id="4482" href="Erasure.LogicalRelation.Fundamental.html#15843" class="Function">fundamentalErased</a> <a id="4500" href="Erasure.Consequences.Soundness.html#4455" class="Bound">⊢t</a> <a id="4503" href="Erasure.Consequences.Soundness.html#4458" class="Bound">𝟘▸t</a>
  <a id="4509" class="Keyword">in</a>  <a id="4513" href="Erasure.Consequences.Soundness.html#3880" class="Function">soundness-ℕ′</a> <a id="4526" class="Symbol">(</a><a id="4527" href="Erasure.LogicalRelation.Irrelevance.html#3967" class="Function">irrelevanceTerm</a> <a id="4543" class="Symbol">{</a><a id="4544" class="Argument">l′</a> <a id="4547" class="Symbol">=</a> <a id="4549" href="Definition.LogicalRelation.html#5984" class="InductiveConstructor">¹</a><a id="4550" class="Symbol">}</a> <a id="4552" href="Erasure.Consequences.Soundness.html#4470" class="Bound">[ℕ]</a> <a id="4556" class="Symbol">(</a><a id="4557" href="Definition.LogicalRelation.html#14813" class="InductiveConstructor">ℕᵣ</a> <a id="4560" class="Symbol">(</a><a id="4561" href="Definition.Typed.Properties.html#12363" class="Function">idRed:*:</a> <a id="4570" class="Symbol">(</a><a id="4571" href="Definition.Typed.html#1176" class="InductiveConstructor">ℕⱼ</a> <a id="4574" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a><a id="4576" class="Symbol">)))</a> <a id="4580" class="Symbol">(</a><a id="4581" href="Erasure.Consequences.Soundness.html#4476" class="Bound">t®v</a> <a id="4585" href="Erasure.LogicalRelation.Subsumption.html#2069" class="Function Operator">◀≢𝟘</a> <a id="4589" href="Definition.Modality.html#2839" class="Function">𝟙≉𝟘</a><a id="4592" class="Symbol">))</a>

<a id="4596" class="Comment">-- Helper lemma for WH reduction soundness of unit</a>

<a id="soundness-star′"></a><a id="4648" href="Erasure.Consequences.Soundness.html#4648" class="Function">soundness-star′</a> <a id="4664" class="Symbol">:</a> <a id="4666" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="4668" href="Erasure.LogicalRelation.html#1666" class="Datatype Operator">®</a> <a id="4670" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="4672" href="Erasure.LogicalRelation.html#1666" class="Datatype Operator">∷Unit</a> <a id="4678" class="Symbol">→</a> <a id="4680" href="Erasure.Consequences.Soundness.html#1952" class="Generalizable">v</a> <a id="4682" href="Erasure.Target.html#5995" class="Datatype Operator">T.⇒*</a> <a id="4687" href="Erasure.Target.html#923" class="InductiveConstructor">T.star</a>
<a id="4694" href="Erasure.Consequences.Soundness.html#4648" class="Function">soundness-star′</a> <a id="4710" class="Symbol">(</a><a id="4711" href="Erasure.LogicalRelation.html#1721" class="InductiveConstructor">starᵣ</a> <a id="4717" class="Symbol">_</a> <a id="4719" href="Erasure.Consequences.Soundness.html#4719" class="Bound">v⇒star</a><a id="4725" class="Symbol">)</a> <a id="4727" class="Symbol">=</a> <a id="4729" href="Erasure.Consequences.Soundness.html#4719" class="Bound">v⇒star</a>

<a id="4737" class="Comment">-- WH reduction soundness of unit</a>

<a id="soundness-star"></a><a id="4772" href="Erasure.Consequences.Soundness.html#4772" class="Function">soundness-star</a> <a id="4787" class="Symbol">:</a>
  <a id="4791" href="Erasure.Consequences.Soundness.html#730" class="Bound">Δ</a> <a id="4793" href="Definition.Typed.html#13078" class="Datatype Operator">⊢</a> <a id="4795" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="4797" href="Definition.Typed.html#13078" class="Datatype Operator">⇒*</a> <a id="4800" href="Definition.Untyped.html#3565" class="InductiveConstructor">star</a> <a id="4805" href="Definition.Typed.html#13078" class="Datatype Operator">∷</a> <a id="4807" href="Definition.Untyped.html#2449" class="InductiveConstructor">Unit</a> <a id="4812" class="Symbol">→</a> <a id="4814" href="Definition.Modality.Context.html#2011" class="Function">𝟘ᶜ</a> <a id="4817" href="Definition.Modality.Usage.html#1055" class="Datatype Operator">▸[</a> <a id="4820" href="Definition.Mode.html#1066" class="InductiveConstructor">𝟙ᵐ</a> <a id="4823" href="Definition.Modality.Usage.html#1055" class="Datatype Operator">]</a> <a id="4825" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="4827" class="Symbol">→</a> <a id="4829" href="Erasure.Extraction.html#972" class="Function">erase</a> <a id="4835" href="Erasure.Consequences.Soundness.html#1910" class="Generalizable">t</a> <a id="4837" href="Erasure.Target.html#5995" class="Datatype Operator">T.⇒*</a> <a id="4842" href="Erasure.Target.html#923" class="InductiveConstructor">T.star</a>
<a id="4849" href="Erasure.Consequences.Soundness.html#4772" class="Function">soundness-star</a> <a id="4864" href="Erasure.Consequences.Soundness.html#4864" class="Bound">t⇒star</a> <a id="4871" href="Erasure.Consequences.Soundness.html#4871" class="Bound">γ▸t</a> <a id="4875" class="Symbol">=</a>
  <a id="4879" class="Keyword">let</a> <a id="4883" href="Erasure.Consequences.Soundness.html#4883" class="Bound">⊢t</a> <a id="4886" class="Symbol">=</a> <a id="4888" href="Definition.Typed.Properties.html#5095" class="Function">redFirst*Term</a> <a id="4902" href="Erasure.Consequences.Soundness.html#4864" class="Bound">t⇒star</a>
      <a id="4915" href="Erasure.Consequences.Soundness.html#4915" class="Bound">[⊤]</a> <a id="4919" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4921" href="Erasure.Consequences.Soundness.html#4921" class="Bound">t®t′</a> <a id="4926" class="Symbol">=</a> <a id="4928" href="Erasure.LogicalRelation.Fundamental.html#15843" class="Function">fundamentalErased</a> <a id="4946" href="Erasure.Consequences.Soundness.html#4883" class="Bound">⊢t</a> <a id="4949" href="Erasure.Consequences.Soundness.html#4871" class="Bound">γ▸t</a>
      <a id="4959" href="Erasure.Consequences.Soundness.html#4959" class="Bound">ok</a> <a id="4962" class="Symbol">=</a> <a id="4964" href="Definition.Typed.Consequences.Inversion.html#1890" class="Function">⊢∷Unit→Unit-restriction</a> <a id="4988" href="Erasure.Consequences.Soundness.html#4883" class="Bound">⊢t</a>
      <a id="4997" href="Erasure.Consequences.Soundness.html#4997" class="Bound">t®t″</a> <a id="5002" class="Symbol">=</a> <a id="5004" href="Erasure.LogicalRelation.Irrelevance.html#3967" class="Function">irrelevanceTerm</a> <a id="5020" class="Symbol">{</a><a id="5021" class="Argument">l′</a> <a id="5024" class="Symbol">=</a> <a id="5026" href="Definition.LogicalRelation.html#5984" class="InductiveConstructor">¹</a><a id="5027" class="Symbol">}</a>
               <a id="5044" href="Erasure.Consequences.Soundness.html#4915" class="Bound">[⊤]</a> <a id="5048" class="Symbol">(</a><a id="5049" href="Definition.LogicalRelation.html#14892" class="InductiveConstructor">Unitᵣ</a> <a id="5055" class="Symbol">(</a><a id="5056" href="Definition.LogicalRelation.html#5412" class="InductiveConstructor">Unitₜ</a> <a id="5062" class="Symbol">(</a><a id="5063" href="Definition.Typed.Properties.html#12363" class="Function">idRed:*:</a> <a id="5072" class="Symbol">(</a><a id="5073" href="Definition.Typed.html#1230" class="InductiveConstructor">Unitⱼ</a> <a id="5079" href="Erasure.Consequences.Soundness.html#747" class="Bound">⊢Δ</a> <a id="5082" href="Erasure.Consequences.Soundness.html#4959" class="Bound">ok</a><a id="5084" class="Symbol">))</a> <a id="5087" href="Erasure.Consequences.Soundness.html#4959" class="Bound">ok</a><a id="5089" class="Symbol">))</a>
               <a id="5107" class="Symbol">(</a><a id="5108" href="Erasure.Consequences.Soundness.html#4921" class="Bound">t®t′</a> <a id="5113" href="Erasure.LogicalRelation.Subsumption.html#2069" class="Function Operator">◀≢𝟘</a> <a id="5117" href="Definition.Modality.html#2839" class="Function">𝟙≉𝟘</a><a id="5120" class="Symbol">)</a>
  <a id="5124" class="Keyword">in</a>  <a id="5128" href="Erasure.Consequences.Soundness.html#4648" class="Function">soundness-star′</a> <a id="5144" href="Erasure.Consequences.Soundness.html#4997" class="Bound">t®t″</a>
</pre></body></html>