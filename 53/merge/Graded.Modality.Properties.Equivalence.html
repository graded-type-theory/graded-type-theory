<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Graded.Modality.Properties.Equivalence</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Properties of equality.</a>
<a id="101" class="Comment">------------------------------------------------------------------------</a>

<a id="175" class="Keyword">open</a> <a id="180" class="Keyword">import</a> <a id="187" href="Graded.Modality.html" class="Module">Graded.Modality</a>

<a id="204" class="Keyword">module</a> <a id="211" href="Graded.Modality.Properties.Equivalence.html" class="Module">Graded.Modality.Properties.Equivalence</a>
  <a id="252" class="Symbol">{</a><a id="253" href="Graded.Modality.Properties.Equivalence.html#253" class="Bound">a</a><a id="254" class="Symbol">}</a> <a id="256" class="Symbol">{</a><a id="257" href="Graded.Modality.Properties.Equivalence.html#257" class="Bound">M</a> <a id="259" class="Symbol">:</a> <a id="261" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="265" href="Graded.Modality.Properties.Equivalence.html#253" class="Bound">a</a><a id="266" class="Symbol">}</a> <a id="268" class="Symbol">(</a><a id="269" href="Graded.Modality.Properties.Equivalence.html#269" class="Bound">𝕄</a> <a id="271" class="Symbol">:</a> <a id="273" href="Graded.Modality.html#601" class="Record">Semiring-with-meet</a> <a id="292" href="Graded.Modality.Properties.Equivalence.html#257" class="Bound">M</a><a id="293" class="Symbol">)</a> <a id="295" class="Keyword">where</a>

<a id="302" class="Keyword">open</a> <a id="307" href="Graded.Modality.html#601" class="Module">Semiring-with-meet</a> <a id="326" href="Graded.Modality.Properties.Equivalence.html#269" class="Bound">𝕄</a>

<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Graded.Modality.Properties.PartialOrder.html" class="Module">Graded.Modality.Properties.PartialOrder</a> <a id="381" href="Graded.Modality.Properties.Equivalence.html#269" class="Bound">𝕄</a>

<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="Tools.Function.html" class="Module">Tools.Function</a>
<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>
<a id="451" class="Keyword">import</a> <a id="458" href="Tools.Reasoning.PropositionalEquality.html" class="Module">Tools.Reasoning.PropositionalEquality</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="Tools.Relation.html" class="Module">Tools.Relation</a>

<a id="524" class="Keyword">private</a> <a id="532" class="Keyword">variable</a>
  <a id="543" href="Graded.Modality.Properties.Equivalence.html#543" class="Generalizable">p</a> <a id="545" href="Graded.Modality.Properties.Equivalence.html#545" class="Generalizable">q</a> <a id="547" class="Symbol">:</a> <a id="549" href="Graded.Modality.Properties.Equivalence.html#257" class="Bound">M</a>

<a id="552" class="Comment">------------------------------------------------------------------------</a>
<a id="625" class="Comment">-- Decision procedures</a>

<a id="649" class="Comment">-- If _≤_ is decidable, then _≡_ is decidable (for M).</a>

<a id="≤-decidable→≡-decidable"></a><a id="705" href="Graded.Modality.Properties.Equivalence.html#705" class="Function">≤-decidable→≡-decidable</a> <a id="729" class="Symbol">:</a> <a id="731" href="Relation.Binary.Definitions.html#6713" class="Function">Decidable</a> <a id="741" href="Graded.Modality.html#1365" class="Function Operator">_≤_</a> <a id="745" class="Symbol">→</a> <a id="747" href="Relation.Binary.Definitions.html#6713" class="Function">Decidable</a> <a id="757" class="Symbol">(</a><a id="758" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a> <a id="762" class="Symbol">{</a><a id="763" class="Argument">A</a> <a id="765" class="Symbol">=</a> <a id="767" href="Graded.Modality.Properties.Equivalence.html#257" class="Bound">M</a><a id="768" class="Symbol">})</a>
<a id="771" href="Graded.Modality.Properties.Equivalence.html#705" class="Function">≤-decidable→≡-decidable</a> <a id="795" href="Graded.Modality.Properties.Equivalence.html#795" class="Bound Operator">_≤?_</a> <a id="800" href="Graded.Modality.Properties.Equivalence.html#800" class="Bound">p</a> <a id="802" href="Graded.Modality.Properties.Equivalence.html#802" class="Bound">q</a> <a id="804" class="Symbol">=</a> <a id="806" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="811" href="Graded.Modality.Properties.Equivalence.html#800" class="Bound">p</a> <a id="813" href="Graded.Modality.Properties.Equivalence.html#795" class="Bound Operator">≤?</a> <a id="816" href="Graded.Modality.Properties.Equivalence.html#802" class="Bound">q</a> <a id="818" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="821" class="Symbol">λ</a> <a id="823" class="Keyword">where</a>
  <a id="831" class="Symbol">(</a><a id="832" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="835" href="Graded.Modality.Properties.Equivalence.html#835" class="Bound">p≰q</a><a id="838" class="Symbol">)</a>  <a id="841" class="Symbol">→</a> <a id="843" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="846" class="Symbol">λ</a> <a id="848" href="Graded.Modality.Properties.Equivalence.html#848" class="Bound">p≡q</a> <a id="852" class="Symbol">→</a> <a id="854" href="Graded.Modality.Properties.Equivalence.html#835" class="Bound">p≰q</a> <a id="858" class="Symbol">(</a><a id="859" href="Graded.Modality.Properties.PartialOrder.html#1013" class="Function">≤-reflexive</a> <a id="871" href="Graded.Modality.Properties.Equivalence.html#848" class="Bound">p≡q</a><a id="874" class="Symbol">)</a>
  <a id="878" class="Symbol">(</a><a id="879" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="883" href="Graded.Modality.Properties.Equivalence.html#883" class="Bound">p≤q</a><a id="886" class="Symbol">)</a> <a id="888" class="Symbol">→</a> <a id="890" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="895" href="Graded.Modality.Properties.Equivalence.html#802" class="Bound">q</a> <a id="897" href="Graded.Modality.Properties.Equivalence.html#795" class="Bound Operator">≤?</a> <a id="900" href="Graded.Modality.Properties.Equivalence.html#800" class="Bound">p</a> <a id="902" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="905" class="Symbol">λ</a> <a id="907" class="Keyword">where</a>
    <a id="917" class="Symbol">(</a><a id="918" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="921" href="Graded.Modality.Properties.Equivalence.html#921" class="Bound">q≰p</a><a id="924" class="Symbol">)</a>  <a id="927" class="Symbol">→</a> <a id="929" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="932" class="Symbol">λ</a> <a id="934" href="Graded.Modality.Properties.Equivalence.html#934" class="Bound">p≡q</a> <a id="938" class="Symbol">→</a> <a id="940" href="Graded.Modality.Properties.Equivalence.html#921" class="Bound">q≰p</a> <a id="944" class="Symbol">(</a><a id="945" href="Graded.Modality.Properties.PartialOrder.html#1013" class="Function">≤-reflexive</a> <a id="957" class="Symbol">(</a><a id="958" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="962" href="Graded.Modality.Properties.Equivalence.html#934" class="Bound">p≡q</a><a id="965" class="Symbol">))</a>
    <a id="972" class="Symbol">(</a><a id="973" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="977" href="Graded.Modality.Properties.Equivalence.html#977" class="Bound">q≤p</a><a id="980" class="Symbol">)</a> <a id="982" class="Symbol">→</a> <a id="984" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="988" class="Symbol">(</a><a id="989" href="Graded.Modality.Properties.PartialOrder.html#853" class="Function">≤-antisym</a> <a id="999" href="Graded.Modality.Properties.Equivalence.html#883" class="Bound">p≤q</a> <a id="1003" href="Graded.Modality.Properties.Equivalence.html#977" class="Bound">q≤p</a><a id="1006" class="Symbol">)</a>

<a id="1009" class="Comment">------------------------------------------------------------------------</a>
<a id="1082" class="Comment">-- Some lemmas related to Trivial</a>

<a id="1117" class="Keyword">opaque</a>

  <a id="1127" class="Comment">-- It is decidable whether Trivial holds.</a>

  <a id="trivial?"></a><a id="1172" href="Graded.Modality.Properties.Equivalence.html#1172" class="Function">trivial?</a> <a id="1181" class="Symbol">:</a> <a id="1183" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a> <a id="1187" href="Graded.Modality.html#2006" class="Function">Trivial</a>
  <a id="1197" href="Graded.Modality.Properties.Equivalence.html#1172" class="Function">trivial?</a> <a id="1206" class="Symbol">=</a> <a id="1208" href="Graded.Modality.html#1795" class="Field">is-𝟘?</a> <a id="1214" href="Graded.Modality.html#928" class="Field">𝟙</a>

<a id="1217" class="Comment">-- If the semiring with meet is trivial, then every value is equal</a>
<a id="1284" class="Comment">-- to 𝟘.</a>

<a id="≡𝟘"></a><a id="1294" href="Graded.Modality.Properties.Equivalence.html#1294" class="Function">≡𝟘</a> <a id="1297" class="Symbol">:</a> <a id="1299" href="Graded.Modality.html#2006" class="Function">Trivial</a> <a id="1307" class="Symbol">→</a> <a id="1309" href="Graded.Modality.Properties.Equivalence.html#543" class="Generalizable">p</a> <a id="1311" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1313" href="Graded.Modality.html#926" class="Field">𝟘</a>
<a id="1315" href="Graded.Modality.Properties.Equivalence.html#1294" class="Function">≡𝟘</a> <a id="1318" class="Symbol">{</a><a id="1319" class="Argument">p</a> <a id="1321" class="Symbol">=</a> <a id="1323" href="Graded.Modality.Properties.Equivalence.html#1323" class="Bound">p</a><a id="1324" class="Symbol">}</a> <a id="1326" href="Graded.Modality.Properties.Equivalence.html#1326" class="Bound">𝟙≡𝟘</a> <a id="1330" class="Symbol">=</a> <a id="1332" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="1340" href="Graded.Modality.Properties.Equivalence.html#1323" class="Bound">p</a>      <a id="1347" href="Relation.Binary.Reasoning.Syntax.html#11539" class="Function">≡˘⟨</a> <a id="1351" href="Graded.Modality.html#3173" class="Function">·-identityˡ</a> <a id="1363" class="Symbol">_</a> <a id="1365" href="Relation.Binary.Reasoning.Syntax.html#11539" class="Function">⟩</a>
  <a id="1369" href="Graded.Modality.html#928" class="Field">𝟙</a> <a id="1371" href="Graded.Modality.html#906" class="Field Operator">·</a> <a id="1373" href="Graded.Modality.Properties.Equivalence.html#1323" class="Bound">p</a>  <a id="1376" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1379" href="Graded.Modality.html#3095" class="Function">·-congʳ</a> <a id="1387" href="Graded.Modality.Properties.Equivalence.html#1326" class="Bound">𝟙≡𝟘</a> <a id="1391" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
  <a id="1395" href="Graded.Modality.html#926" class="Field">𝟘</a> <a id="1397" href="Graded.Modality.html#906" class="Field Operator">·</a> <a id="1399" href="Graded.Modality.Properties.Equivalence.html#1323" class="Bound">p</a>  <a id="1402" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1405" href="Graded.Modality.html#3400" class="Function">·-zeroˡ</a> <a id="1413" class="Symbol">_</a> <a id="1415" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
  <a id="1419" href="Graded.Modality.html#926" class="Field">𝟘</a>      <a id="1426" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
  <a id="1430" class="Keyword">where</a>
  <a id="1438" class="Keyword">open</a> <a id="1443" href="Tools.Reasoning.PropositionalEquality.html" class="Module">Tools.Reasoning.PropositionalEquality</a>

<a id="1482" class="Comment">-- If the semiring with meet is trivial, then _≡_ is trivial.</a>

<a id="≡-trivial"></a><a id="1545" href="Graded.Modality.Properties.Equivalence.html#1545" class="Function">≡-trivial</a> <a id="1555" class="Symbol">:</a> <a id="1557" href="Graded.Modality.html#2006" class="Function">Trivial</a> <a id="1565" class="Symbol">→</a> <a id="1567" href="Graded.Modality.Properties.Equivalence.html#543" class="Generalizable">p</a> <a id="1569" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1571" href="Graded.Modality.Properties.Equivalence.html#545" class="Generalizable">q</a>
<a id="1573" href="Graded.Modality.Properties.Equivalence.html#1545" class="Function">≡-trivial</a> <a id="1583" class="Symbol">{</a><a id="1584" class="Argument">p</a> <a id="1586" class="Symbol">=</a> <a id="1588" href="Graded.Modality.Properties.Equivalence.html#1588" class="Bound">p</a><a id="1589" class="Symbol">}</a> <a id="1591" class="Symbol">{</a><a id="1592" class="Argument">q</a> <a id="1594" class="Symbol">=</a> <a id="1596" href="Graded.Modality.Properties.Equivalence.html#1596" class="Bound">q</a><a id="1597" class="Symbol">}</a> <a id="1599" href="Graded.Modality.Properties.Equivalence.html#1599" class="Bound">𝟙≡𝟘</a> <a id="1603" class="Symbol">=</a> <a id="1605" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="1613" href="Graded.Modality.Properties.Equivalence.html#1588" class="Bound">p</a>  <a id="1616" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1619" href="Graded.Modality.Properties.Equivalence.html#1294" class="Function">≡𝟘</a> <a id="1622" href="Graded.Modality.Properties.Equivalence.html#1599" class="Bound">𝟙≡𝟘</a> <a id="1626" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
  <a id="1630" href="Graded.Modality.html#926" class="Field">𝟘</a>  <a id="1633" href="Relation.Binary.Reasoning.Syntax.html#11539" class="Function">≡˘⟨</a> <a id="1637" href="Graded.Modality.Properties.Equivalence.html#1294" class="Function">≡𝟘</a> <a id="1640" href="Graded.Modality.Properties.Equivalence.html#1599" class="Bound">𝟙≡𝟘</a> <a id="1644" href="Relation.Binary.Reasoning.Syntax.html#11539" class="Function">⟩</a>
  <a id="1648" href="Graded.Modality.Properties.Equivalence.html#1596" class="Bound">q</a>  <a id="1651" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
  <a id="1655" class="Keyword">where</a>
  <a id="1663" class="Keyword">open</a> <a id="1668" href="Tools.Reasoning.PropositionalEquality.html" class="Module">Tools.Reasoning.PropositionalEquality</a>

<a id="1707" class="Comment">-- If there are two distinct values, then the semiring with meet is</a>
<a id="1775" class="Comment">-- non-trivial.</a>

<a id="≢→non-trivial"></a><a id="1792" href="Graded.Modality.Properties.Equivalence.html#1792" class="Function">≢→non-trivial</a> <a id="1806" class="Symbol">:</a> <a id="1808" href="Graded.Modality.Properties.Equivalence.html#543" class="Generalizable">p</a> <a id="1810" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="1812" href="Graded.Modality.Properties.Equivalence.html#545" class="Generalizable">q</a> <a id="1814" class="Symbol">→</a> <a id="1816" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="1818" href="Graded.Modality.html#2006" class="Function">Trivial</a>
<a id="1826" href="Graded.Modality.Properties.Equivalence.html#1792" class="Function">≢→non-trivial</a> <a id="1840" href="Graded.Modality.Properties.Equivalence.html#1840" class="Bound">p≢q</a> <a id="1844" class="Symbol">=</a> <a id="1846" href="Graded.Modality.Properties.Equivalence.html#1840" class="Bound">p≢q</a> <a id="1850" href="Function.Base.html#1115" class="Function Operator">∘→</a> <a id="1853" href="Graded.Modality.Properties.Equivalence.html#1545" class="Function">≡-trivial</a>
</pre></body></html>