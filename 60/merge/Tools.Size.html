<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tools.Size</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Sizes</a>
<a id="83" class="Comment">------------------------------------------------------------------------</a>

<a id="157" class="Keyword">module</a> <a id="164" href="Tools.Size.html" class="Module">Tools.Size</a> <a id="175" class="Keyword">where</a>

<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Induction.WellFounded.html" class="Module">Induction.WellFounded</a>
<a id="279" class="Keyword">import</a> <a id="286" href="Relation.Binary.Construct.On.html" class="Module">Relation.Binary.Construct.On</a> <a id="315" class="Symbol">as</a> <a id="318" class="Module">On</a>

<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Tools.Nat.html" class="Module">Tools.Nat</a>

<a id="345" class="Comment">-- Sizes are simple trees.</a>

<a id="373" class="Keyword">infixr</a> <a id="380" class="Number">6</a> <a id="382" href="Tools.Size.html#835" class="InductiveConstructor Operator">_⊕_</a>

<a id="387" class="Keyword">data</a> <a id="Size"></a><a id="392" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="397" class="Symbol">:</a> <a id="399" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="403" class="Keyword">where</a>
  <a id="Size.leaf"></a><a id="411" href="Tools.Size.html#411" class="InductiveConstructor">leaf</a> <a id="416" class="Symbol">:</a> <a id="418" href="Tools.Size.html#392" class="Datatype">Size</a>
  <a id="Size._⊕_"></a><a id="425" href="Tools.Size.html#425" class="InductiveConstructor Operator">_⊕_</a>  <a id="430" class="Symbol">:</a> <a id="432" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="437" class="Symbol">→</a> <a id="439" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="444" class="Symbol">→</a> <a id="446" href="Tools.Size.html#392" class="Datatype">Size</a>

<a id="452" class="Comment">-- A unary size &quot;constructor&quot;.</a>

<a id="484" class="Keyword">pattern</a> <a id="node"></a><a id="492" href="Tools.Size.html#492" class="InductiveConstructor">node</a> <a id="497" href="Tools.Size.html#501" class="Bound">s</a> <a id="499" class="Symbol">=</a> <a id="501" href="Tools.Size.html#501" class="Bound">s</a> <a id="503" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="505" href="Tools.Size.html#411" class="InductiveConstructor">leaf</a>

<a id="511" class="Keyword">private</a> <a id="519" class="Keyword">variable</a>
  <a id="530" href="Tools.Size.html#530" class="Generalizable">l</a> <a id="532" href="Tools.Size.html#532" class="Generalizable">l₁</a> <a id="535" href="Tools.Size.html#535" class="Generalizable">l₂</a> <a id="538" href="Tools.Size.html#538" class="Generalizable">r</a> <a id="540" href="Tools.Size.html#540" class="Generalizable">r₁</a> <a id="543" href="Tools.Size.html#543" class="Generalizable">r₂</a> <a id="546" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="548" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="551" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="554" href="Tools.Size.html#554" class="Generalizable">s₃</a> <a id="557" class="Symbol">:</a> <a id="559" href="Tools.Size.html#392" class="Datatype">Size</a>

<a id="565" class="Comment">-- The type s₁ ≤ˢ s₂ is inhabited when s₁ can be transformed into s₂</a>
<a id="634" class="Comment">-- through the addition of zero or more nodes (where one child is an</a>
<a id="703" class="Comment">-- arbitrary tree) anywhere in the tree.</a>

<a id="745" class="Keyword">infix</a> <a id="751" class="Number">10</a> <a id="754" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙_</a> <a id="757" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘_</a>
<a id="760" class="Keyword">infix</a>  <a id="767" class="Number">4</a> <a id="769" href="Tools.Size.html#780" class="Datatype Operator">_≤ˢ_</a>

<a id="775" class="Keyword">data</a> <a id="_≤ˢ_"></a><a id="780" href="Tools.Size.html#780" class="Datatype Operator">_≤ˢ_</a> <a id="785" class="Symbol">:</a> <a id="787" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="792" class="Symbol">→</a> <a id="794" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="799" class="Symbol">→</a> <a id="801" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="805" class="Keyword">where</a>
  <a id="_≤ˢ_.leaf"></a><a id="813" href="Tools.Size.html#813" class="InductiveConstructor">leaf</a> <a id="818" class="Symbol">:</a> <a id="820" href="Tools.Size.html#411" class="InductiveConstructor">leaf</a> <a id="825" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="828" href="Tools.Size.html#411" class="InductiveConstructor">leaf</a>
  <a id="_≤ˢ_._⊕_"></a><a id="835" href="Tools.Size.html#835" class="InductiveConstructor Operator">_⊕_</a>  <a id="840" class="Symbol">:</a> <a id="842" href="Tools.Size.html#532" class="Generalizable">l₁</a> <a id="845" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="848" href="Tools.Size.html#535" class="Generalizable">l₂</a> <a id="851" class="Symbol">→</a> <a id="853" href="Tools.Size.html#540" class="Generalizable">r₁</a> <a id="856" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="859" href="Tools.Size.html#543" class="Generalizable">r₂</a> <a id="862" class="Symbol">→</a> <a id="864" href="Tools.Size.html#532" class="Generalizable">l₁</a> <a id="867" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="869" href="Tools.Size.html#540" class="Generalizable">r₁</a> <a id="872" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="875" href="Tools.Size.html#535" class="Generalizable">l₂</a> <a id="878" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="880" href="Tools.Size.html#543" class="Generalizable">r₂</a>
  <a id="_≤ˢ_.↙_"></a><a id="885" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙_</a>   <a id="890" class="Symbol">:</a> <a id="892" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="894" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="897" href="Tools.Size.html#530" class="Generalizable">l</a> <a id="899" class="Symbol">→</a> <a id="901" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="903" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="906" href="Tools.Size.html#530" class="Generalizable">l</a> <a id="908" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="910" href="Tools.Size.html#538" class="Generalizable">r</a>
  <a id="_≤ˢ_.↘_"></a><a id="914" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘_</a>   <a id="919" class="Symbol">:</a> <a id="921" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="923" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="926" href="Tools.Size.html#538" class="Generalizable">r</a> <a id="928" class="Symbol">→</a> <a id="930" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="932" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="935" href="Tools.Size.html#530" class="Generalizable">l</a> <a id="937" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="939" href="Tools.Size.html#538" class="Generalizable">r</a>

<a id="942" class="Comment">-- The type s₁ &lt;ˢ s₂ is inhabited when s₁ can be transformed into s₂</a>
<a id="1011" class="Comment">-- through the addition of one or more nodes (where one child is an</a>
<a id="1079" class="Comment">-- arbitrary tree) anywhere in the tree.</a>

<a id="1121" class="Keyword">infixr</a> <a id="1128" class="Number">6</a> <a id="1130" href="Tools.Size.html#1193" class="InductiveConstructor Operator">_↙⊕_</a> <a id="1135" href="Tools.Size.html#1243" class="InductiveConstructor Operator">_⊕↘_</a>
<a id="1140" class="Keyword">infix</a>  <a id="1147" class="Number">4</a> <a id="1149" href="Tools.Size.html#1160" class="Datatype Operator">_&lt;ˢ_</a>

<a id="1155" class="Keyword">data</a> <a id="_&lt;ˢ_"></a><a id="1160" href="Tools.Size.html#1160" class="Datatype Operator">_&lt;ˢ_</a> <a id="1165" class="Symbol">:</a> <a id="1167" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="1172" class="Symbol">→</a> <a id="1174" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="1179" class="Symbol">→</a> <a id="1181" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1185" class="Keyword">where</a>
  <a id="_&lt;ˢ_._↙⊕_"></a><a id="1193" href="Tools.Size.html#1193" class="InductiveConstructor Operator">_↙⊕_</a> <a id="1198" class="Symbol">:</a> <a id="1200" href="Tools.Size.html#532" class="Generalizable">l₁</a> <a id="1203" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="1206" href="Tools.Size.html#535" class="Generalizable">l₂</a> <a id="1209" class="Symbol">→</a> <a id="1211" href="Tools.Size.html#540" class="Generalizable">r₁</a> <a id="1214" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1217" href="Tools.Size.html#543" class="Generalizable">r₂</a> <a id="1220" class="Symbol">→</a> <a id="1222" href="Tools.Size.html#532" class="Generalizable">l₁</a> <a id="1225" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="1227" href="Tools.Size.html#540" class="Generalizable">r₁</a> <a id="1230" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="1233" href="Tools.Size.html#535" class="Generalizable">l₂</a> <a id="1236" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="1238" href="Tools.Size.html#543" class="Generalizable">r₂</a>
  <a id="_&lt;ˢ_._⊕↘_"></a><a id="1243" href="Tools.Size.html#1243" class="InductiveConstructor Operator">_⊕↘_</a> <a id="1248" class="Symbol">:</a> <a id="1250" href="Tools.Size.html#532" class="Generalizable">l₁</a> <a id="1253" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1256" href="Tools.Size.html#535" class="Generalizable">l₂</a> <a id="1259" class="Symbol">→</a> <a id="1261" href="Tools.Size.html#540" class="Generalizable">r₁</a> <a id="1264" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="1267" href="Tools.Size.html#543" class="Generalizable">r₂</a> <a id="1270" class="Symbol">→</a> <a id="1272" href="Tools.Size.html#532" class="Generalizable">l₁</a> <a id="1275" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="1277" href="Tools.Size.html#540" class="Generalizable">r₁</a> <a id="1280" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="1283" href="Tools.Size.html#535" class="Generalizable">l₂</a> <a id="1286" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="1288" href="Tools.Size.html#543" class="Generalizable">r₂</a>
  <a id="_&lt;ˢ_.↙_"></a><a id="1293" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙_</a>   <a id="1298" class="Symbol">:</a> <a id="1300" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="1302" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1305" href="Tools.Size.html#530" class="Generalizable">l</a> <a id="1307" class="Symbol">→</a> <a id="1309" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="1311" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="1314" href="Tools.Size.html#530" class="Generalizable">l</a> <a id="1316" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="1318" href="Tools.Size.html#538" class="Generalizable">r</a>
  <a id="_&lt;ˢ_.↘_"></a><a id="1322" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘_</a>   <a id="1327" class="Symbol">:</a> <a id="1329" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="1331" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1334" href="Tools.Size.html#538" class="Generalizable">r</a> <a id="1336" class="Symbol">→</a> <a id="1338" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="1340" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="1343" href="Tools.Size.html#530" class="Generalizable">l</a> <a id="1345" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="1347" href="Tools.Size.html#538" class="Generalizable">r</a>

<a id="1350" class="Comment">------------------------------------------------------------------------</a>
<a id="1423" class="Comment">-- Conversion</a>

<a id="1438" class="Keyword">opaque</a>

  <a id="1448" class="Comment">-- The relation _&lt;ˢ_ is contained in _≤ˢ_.</a>

  <a id="&lt;ˢ→≤ˢ"></a><a id="1494" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="1500" class="Symbol">:</a> <a id="1502" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="1505" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="1508" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="1511" class="Symbol">→</a> <a id="1513" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="1516" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1519" href="Tools.Size.html#551" class="Generalizable">s₂</a>
  <a id="1524" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="1530" class="Symbol">(</a><a id="1531" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="1533" href="Tools.Size.html#1533" class="Bound">p</a><a id="1534" class="Symbol">)</a>    <a id="1539" class="Symbol">=</a> <a id="1541" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="1543" href="Tools.Size.html#1533" class="Bound">p</a>
  <a id="1547" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="1553" class="Symbol">(</a><a id="1554" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="1556" href="Tools.Size.html#1556" class="Bound">p</a><a id="1557" class="Symbol">)</a>    <a id="1562" class="Symbol">=</a> <a id="1564" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="1566" href="Tools.Size.html#1556" class="Bound">p</a>
  <a id="1570" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="1576" class="Symbol">(</a><a id="1577" href="Tools.Size.html#1577" class="Bound">p</a> <a id="1579" href="Tools.Size.html#1193" class="InductiveConstructor Operator">↙⊕</a> <a id="1582" href="Tools.Size.html#1582" class="Bound">q</a><a id="1583" class="Symbol">)</a> <a id="1585" class="Symbol">=</a> <a id="1587" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="1593" href="Tools.Size.html#1577" class="Bound">p</a> <a id="1595" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="1597" href="Tools.Size.html#1582" class="Bound">q</a>
  <a id="1601" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="1607" class="Symbol">(</a><a id="1608" href="Tools.Size.html#1608" class="Bound">p</a> <a id="1610" href="Tools.Size.html#1243" class="InductiveConstructor Operator">⊕↘</a> <a id="1613" href="Tools.Size.html#1613" class="Bound">q</a><a id="1614" class="Symbol">)</a> <a id="1616" class="Symbol">=</a> <a id="1618" href="Tools.Size.html#1608" class="Bound">p</a> <a id="1620" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="1622" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="1628" href="Tools.Size.html#1613" class="Bound">q</a>


<a id="1632" class="Comment">------------------------------------------------------------------------</a>
<a id="1705" class="Comment">-- Reflexivity</a>

<a id="1721" class="Keyword">opaque</a>

  <a id="1731" class="Comment">-- Reflexivity for _≤ˢ_.</a>

  <a id="◻"></a><a id="1759" href="Tools.Size.html#1759" class="Function">◻</a> <a id="1761" class="Symbol">:</a> <a id="1763" href="Tools.Size.html#546" class="Generalizable">s</a> <a id="1765" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1768" href="Tools.Size.html#546" class="Generalizable">s</a>
  <a id="1772" href="Tools.Size.html#1759" class="Function">◻</a> <a id="1774" class="Symbol">{</a><a id="1775" class="Argument">s</a> <a id="1777" class="Symbol">=</a> <a id="1779" href="Tools.Size.html#411" class="InductiveConstructor">leaf</a><a id="1783" class="Symbol">}</a>  <a id="1786" class="Symbol">=</a> <a id="1788" href="Tools.Size.html#813" class="InductiveConstructor">leaf</a>
  <a id="1795" href="Tools.Size.html#1759" class="Function">◻</a> <a id="1797" class="Symbol">{</a><a id="1798" class="Argument">s</a> <a id="1800" class="Symbol">=</a> <a id="1802" class="Symbol">_</a> <a id="1804" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="1806" class="Symbol">_}</a> <a id="1809" class="Symbol">=</a> <a id="1811" href="Tools.Size.html#1759" class="Function">◻</a> <a id="1813" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="1815" href="Tools.Size.html#1759" class="Function">◻</a>

<a id="1818" class="Comment">------------------------------------------------------------------------</a>
<a id="1891" class="Comment">-- Transitivity</a>

<a id="1908" class="Keyword">opaque</a>

  <a id="1918" class="Comment">-- Transitivity for _≤ˢ_.</a>

  <a id="≤ˢ-trans"></a><a id="1947" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="1956" class="Symbol">:</a> <a id="1958" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="1961" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1964" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="1967" class="Symbol">→</a> <a id="1969" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="1972" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1975" href="Tools.Size.html#554" class="Generalizable">s₃</a> <a id="1978" class="Symbol">→</a> <a id="1980" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="1983" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="1986" href="Tools.Size.html#554" class="Generalizable">s₃</a>
  <a id="1991" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2000" href="Tools.Size.html#2000" class="Bound">p</a>         <a id="2010" href="Tools.Size.html#813" class="InductiveConstructor">leaf</a>      <a id="2020" class="Symbol">=</a> <a id="2022" href="Tools.Size.html#2000" class="Bound">p</a>
  <a id="2026" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2035" href="Tools.Size.html#2035" class="Bound">p</a>         <a id="2045" class="Symbol">(</a><a id="2046" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="2048" href="Tools.Size.html#2048" class="Bound">q</a><a id="2049" class="Symbol">)</a>     <a id="2055" class="Symbol">=</a> <a id="2057" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="2059" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2068" href="Tools.Size.html#2035" class="Bound">p</a> <a id="2070" href="Tools.Size.html#2048" class="Bound">q</a>
  <a id="2074" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2083" href="Tools.Size.html#2083" class="Bound">p</a>         <a id="2093" class="Symbol">(</a><a id="2094" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="2096" href="Tools.Size.html#2096" class="Bound">q</a><a id="2097" class="Symbol">)</a>     <a id="2103" class="Symbol">=</a> <a id="2105" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="2107" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2116" href="Tools.Size.html#2083" class="Bound">p</a> <a id="2118" href="Tools.Size.html#2096" class="Bound">q</a>
  <a id="2122" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2131" class="Symbol">(</a><a id="2132" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="2134" href="Tools.Size.html#2134" class="Bound">p</a><a id="2135" class="Symbol">)</a>     <a id="2141" class="Symbol">(</a><a id="2142" href="Tools.Size.html#2142" class="Bound">q₁</a> <a id="2145" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2147" href="Tools.Size.html#2147" class="Bound">q₂</a><a id="2149" class="Symbol">)</a> <a id="2151" class="Symbol">=</a> <a id="2153" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2162" href="Tools.Size.html#2134" class="Bound">p</a> <a id="2164" class="Symbol">(</a><a id="2165" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="2167" href="Tools.Size.html#2142" class="Bound">q₁</a><a id="2169" class="Symbol">)</a>
  <a id="2173" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2182" class="Symbol">(</a><a id="2183" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="2185" href="Tools.Size.html#2185" class="Bound">p</a><a id="2186" class="Symbol">)</a>     <a id="2192" class="Symbol">(</a><a id="2193" href="Tools.Size.html#2193" class="Bound">q₁</a> <a id="2196" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2198" href="Tools.Size.html#2198" class="Bound">q₂</a><a id="2200" class="Symbol">)</a> <a id="2202" class="Symbol">=</a> <a id="2204" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2213" href="Tools.Size.html#2185" class="Bound">p</a> <a id="2215" class="Symbol">(</a><a id="2216" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="2218" href="Tools.Size.html#2198" class="Bound">q₂</a><a id="2220" class="Symbol">)</a>
  <a id="2224" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2233" class="Symbol">(</a><a id="2234" href="Tools.Size.html#2234" class="Bound">p₁</a> <a id="2237" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2239" href="Tools.Size.html#2239" class="Bound">p₂</a><a id="2241" class="Symbol">)</a> <a id="2243" class="Symbol">(</a><a id="2244" href="Tools.Size.html#2244" class="Bound">q₁</a> <a id="2247" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2249" href="Tools.Size.html#2249" class="Bound">q₂</a><a id="2251" class="Symbol">)</a> <a id="2253" class="Symbol">=</a> <a id="2255" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2264" href="Tools.Size.html#2234" class="Bound">p₁</a> <a id="2267" href="Tools.Size.html#2244" class="Bound">q₁</a> <a id="2270" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2272" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2281" href="Tools.Size.html#2239" class="Bound">p₂</a> <a id="2284" href="Tools.Size.html#2249" class="Bound">q₂</a>

<a id="2288" class="Keyword">opaque</a>

  <a id="2298" class="Comment">-- A variant of transitivity for _&lt;ˢ_ and _≤ˢ_.</a>

  <a id="&lt;ˢ-trans-≤ˢʳ"></a><a id="2349" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2362" class="Symbol">:</a> <a id="2364" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="2367" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="2370" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="2373" class="Symbol">→</a> <a id="2375" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="2378" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="2381" href="Tools.Size.html#554" class="Generalizable">s₃</a> <a id="2384" class="Symbol">→</a> <a id="2386" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="2389" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="2392" href="Tools.Size.html#554" class="Generalizable">s₃</a>
  <a id="2397" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2410" href="Tools.Size.html#2410" class="Bound">p</a>          <a id="2421" href="Tools.Size.html#813" class="InductiveConstructor">leaf</a>      <a id="2431" class="Symbol">=</a> <a id="2433" href="Tools.Size.html#2410" class="Bound">p</a>
  <a id="2437" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2450" href="Tools.Size.html#2450" class="Bound">p</a>          <a id="2461" class="Symbol">(</a><a id="2462" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="2464" href="Tools.Size.html#2464" class="Bound">q</a><a id="2465" class="Symbol">)</a>     <a id="2471" class="Symbol">=</a> <a id="2473" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="2475" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2484" class="Symbol">(</a><a id="2485" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="2491" href="Tools.Size.html#2450" class="Bound">p</a><a id="2492" class="Symbol">)</a> <a id="2494" href="Tools.Size.html#2464" class="Bound">q</a>
  <a id="2498" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2511" href="Tools.Size.html#2511" class="Bound">p</a>          <a id="2522" class="Symbol">(</a><a id="2523" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="2525" href="Tools.Size.html#2525" class="Bound">q</a><a id="2526" class="Symbol">)</a>     <a id="2532" class="Symbol">=</a> <a id="2534" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="2536" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2545" class="Symbol">(</a><a id="2546" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="2552" href="Tools.Size.html#2511" class="Bound">p</a><a id="2553" class="Symbol">)</a> <a id="2555" href="Tools.Size.html#2525" class="Bound">q</a>
  <a id="2559" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2572" class="Symbol">(</a><a id="2573" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="2575" href="Tools.Size.html#2575" class="Bound">p</a><a id="2576" class="Symbol">)</a>      <a id="2583" class="Symbol">(</a><a id="2584" href="Tools.Size.html#2584" class="Bound">q</a> <a id="2586" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2588" class="Symbol">_)</a>   <a id="2593" class="Symbol">=</a> <a id="2595" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="2597" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2606" href="Tools.Size.html#2575" class="Bound">p</a> <a id="2608" href="Tools.Size.html#2584" class="Bound">q</a>
  <a id="2612" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2625" class="Symbol">(</a><a id="2626" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="2628" href="Tools.Size.html#2628" class="Bound">p</a><a id="2629" class="Symbol">)</a>      <a id="2636" class="Symbol">(_</a> <a id="2639" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2641" href="Tools.Size.html#2641" class="Bound">q</a><a id="2642" class="Symbol">)</a>   <a id="2646" class="Symbol">=</a> <a id="2648" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="2650" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2659" href="Tools.Size.html#2628" class="Bound">p</a> <a id="2661" href="Tools.Size.html#2641" class="Bound">q</a>
  <a id="2665" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2678" class="Symbol">(</a><a id="2679" href="Tools.Size.html#2679" class="Bound">p₁</a> <a id="2682" href="Tools.Size.html#1193" class="InductiveConstructor Operator">↙⊕</a> <a id="2685" href="Tools.Size.html#2685" class="Bound">p₂</a><a id="2687" class="Symbol">)</a> <a id="2689" class="Symbol">(</a><a id="2690" href="Tools.Size.html#2690" class="Bound">q₁</a> <a id="2693" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2695" href="Tools.Size.html#2695" class="Bound">q₂</a><a id="2697" class="Symbol">)</a> <a id="2699" class="Symbol">=</a> <a id="2701" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2714" href="Tools.Size.html#2679" class="Bound">p₁</a> <a id="2717" href="Tools.Size.html#2690" class="Bound">q₁</a> <a id="2720" href="Tools.Size.html#1193" class="InductiveConstructor Operator">↙⊕</a>
                                      <a id="2761" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2770" href="Tools.Size.html#2685" class="Bound">p₂</a> <a id="2773" href="Tools.Size.html#2695" class="Bound">q₂</a>
  <a id="2778" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2791" class="Symbol">(</a><a id="2792" href="Tools.Size.html#2792" class="Bound">p₁</a> <a id="2795" href="Tools.Size.html#1243" class="InductiveConstructor Operator">⊕↘</a> <a id="2798" href="Tools.Size.html#2798" class="Bound">p₂</a><a id="2800" class="Symbol">)</a> <a id="2802" class="Symbol">(</a><a id="2803" href="Tools.Size.html#2803" class="Bound">q₁</a> <a id="2806" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="2808" href="Tools.Size.html#2808" class="Bound">q₂</a><a id="2810" class="Symbol">)</a> <a id="2812" class="Symbol">=</a> <a id="2814" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="2823" href="Tools.Size.html#2792" class="Bound">p₁</a> <a id="2826" href="Tools.Size.html#2803" class="Bound">q₁</a> <a id="2829" href="Tools.Size.html#1243" class="InductiveConstructor Operator">⊕↘</a>
                                      <a id="2870" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="2883" href="Tools.Size.html#2798" class="Bound">p₂</a> <a id="2886" href="Tools.Size.html#2808" class="Bound">q₂</a>

<a id="2890" class="Keyword">opaque</a>

  <a id="2900" class="Comment">-- Transitivity for _&lt;ˢ_.</a>

  <a id="&lt;ˢ-trans"></a><a id="2929" href="Tools.Size.html#2929" class="Function">&lt;ˢ-trans</a> <a id="2938" class="Symbol">:</a> <a id="2940" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="2943" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="2946" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="2949" class="Symbol">→</a> <a id="2951" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="2954" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="2957" href="Tools.Size.html#554" class="Generalizable">s₃</a> <a id="2960" class="Symbol">→</a> <a id="2962" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="2965" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="2968" href="Tools.Size.html#554" class="Generalizable">s₃</a>
  <a id="2973" href="Tools.Size.html#2929" class="Function">&lt;ˢ-trans</a> <a id="2982" href="Tools.Size.html#2982" class="Bound">p</a> <a id="2984" href="Tools.Size.html#2984" class="Bound">q</a> <a id="2986" class="Symbol">=</a> <a id="2988" href="Tools.Size.html#2349" class="Function">&lt;ˢ-trans-≤ˢʳ</a> <a id="3001" href="Tools.Size.html#2982" class="Bound">p</a> <a id="3003" class="Symbol">(</a><a id="3004" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="3010" href="Tools.Size.html#2984" class="Bound">q</a><a id="3011" class="Symbol">)</a>

<a id="3014" class="Keyword">opaque</a>

  <a id="3024" class="Comment">-- A variant of transitivity for _&lt;ˢ_ and _≤ˢ_.</a>

  <a id="&lt;ˢ-trans-≤ˢˡ"></a><a id="3075" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3088" class="Symbol">:</a> <a id="3090" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="3093" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="3096" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="3099" class="Symbol">→</a> <a id="3101" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="3104" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="3107" href="Tools.Size.html#554" class="Generalizable">s₃</a> <a id="3110" class="Symbol">→</a> <a id="3112" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="3115" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="3118" href="Tools.Size.html#554" class="Generalizable">s₃</a>
  <a id="3123" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3136" href="Tools.Size.html#813" class="InductiveConstructor">leaf</a>      <a id="3146" href="Tools.Size.html#3146" class="Bound">q</a>          <a id="3157" class="Symbol">=</a> <a id="3159" href="Tools.Size.html#3146" class="Bound">q</a>
  <a id="3163" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3176" class="Symbol">(</a><a id="3177" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="3179" href="Tools.Size.html#3179" class="Bound">p</a><a id="3180" class="Symbol">)</a>     <a id="3186" href="Tools.Size.html#3186" class="Bound">q</a>          <a id="3197" class="Symbol">=</a> <a id="3199" href="Tools.Size.html#2929" class="Function">&lt;ˢ-trans</a> <a id="3208" class="Symbol">(</a><a id="3209" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="3211" href="Tools.Size.html#3179" class="Bound">p</a><a id="3212" class="Symbol">)</a> <a id="3214" href="Tools.Size.html#3186" class="Bound">q</a>
  <a id="3218" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3231" class="Symbol">(</a><a id="3232" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="3234" href="Tools.Size.html#3234" class="Bound">p</a><a id="3235" class="Symbol">)</a>     <a id="3241" href="Tools.Size.html#3241" class="Bound">q</a>          <a id="3252" class="Symbol">=</a> <a id="3254" href="Tools.Size.html#2929" class="Function">&lt;ˢ-trans</a> <a id="3263" class="Symbol">(</a><a id="3264" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="3266" href="Tools.Size.html#3234" class="Bound">p</a><a id="3267" class="Symbol">)</a> <a id="3269" href="Tools.Size.html#3241" class="Bound">q</a>
  <a id="3273" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3286" href="Tools.Size.html#3286" class="Bound">p</a><a id="3287" class="Symbol">@(_</a> <a id="3291" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="3293" class="Symbol">_)</a> <a id="3296" class="Symbol">(</a><a id="3297" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="3299" href="Tools.Size.html#3299" class="Bound">q</a><a id="3300" class="Symbol">)</a>      <a id="3307" class="Symbol">=</a> <a id="3309" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="3311" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="3320" href="Tools.Size.html#3286" class="Bound">p</a> <a id="3322" href="Tools.Size.html#3299" class="Bound">q</a>
  <a id="3326" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3339" href="Tools.Size.html#3339" class="Bound">p</a><a id="3340" class="Symbol">@(_</a> <a id="3344" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="3346" class="Symbol">_)</a> <a id="3349" class="Symbol">(</a><a id="3350" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="3352" href="Tools.Size.html#3352" class="Bound">q</a><a id="3353" class="Symbol">)</a>      <a id="3360" class="Symbol">=</a> <a id="3362" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="3364" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="3373" href="Tools.Size.html#3339" class="Bound">p</a> <a id="3375" href="Tools.Size.html#3352" class="Bound">q</a>
  <a id="3379" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3392" class="Symbol">(</a><a id="3393" href="Tools.Size.html#3393" class="Bound">p₁</a> <a id="3396" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="3398" href="Tools.Size.html#3398" class="Bound">p₂</a><a id="3400" class="Symbol">)</a> <a id="3402" class="Symbol">(</a><a id="3403" href="Tools.Size.html#3403" class="Bound">q₁</a> <a id="3406" href="Tools.Size.html#1193" class="InductiveConstructor Operator">↙⊕</a> <a id="3409" href="Tools.Size.html#3409" class="Bound">q₂</a><a id="3411" class="Symbol">)</a> <a id="3413" class="Symbol">=</a> <a id="3415" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3428" href="Tools.Size.html#3393" class="Bound">p₁</a> <a id="3431" href="Tools.Size.html#3403" class="Bound">q₁</a> <a id="3434" href="Tools.Size.html#1193" class="InductiveConstructor Operator">↙⊕</a>
                                      <a id="3475" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="3484" href="Tools.Size.html#3398" class="Bound">p₂</a> <a id="3487" href="Tools.Size.html#3409" class="Bound">q₂</a>
  <a id="3492" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3505" class="Symbol">(</a><a id="3506" href="Tools.Size.html#3506" class="Bound">p₁</a> <a id="3509" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="3511" href="Tools.Size.html#3511" class="Bound">p₂</a><a id="3513" class="Symbol">)</a> <a id="3515" class="Symbol">(</a><a id="3516" href="Tools.Size.html#3516" class="Bound">q₁</a> <a id="3519" href="Tools.Size.html#1243" class="InductiveConstructor Operator">⊕↘</a> <a id="3522" href="Tools.Size.html#3522" class="Bound">q₂</a><a id="3524" class="Symbol">)</a> <a id="3526" class="Symbol">=</a> <a id="3528" href="Tools.Size.html#1947" class="Function">≤ˢ-trans</a> <a id="3537" href="Tools.Size.html#3506" class="Bound">p₁</a> <a id="3540" href="Tools.Size.html#3516" class="Bound">q₁</a> <a id="3543" href="Tools.Size.html#1243" class="InductiveConstructor Operator">⊕↘</a>
                                      <a id="3584" href="Tools.Size.html#3075" class="Function">&lt;ˢ-trans-≤ˢˡ</a> <a id="3597" href="Tools.Size.html#3511" class="Bound">p₂</a> <a id="3600" href="Tools.Size.html#3522" class="Bound">q₂</a>

<a id="3604" class="Comment">------------------------------------------------------------------------</a>
<a id="3677" class="Comment">-- More lemmas</a>

<a id="3693" class="Keyword">opaque</a>

  <a id="3703" class="Comment">-- If s₁ ⊕ s₂ ≤ˢ s₃, then s₁ &lt;ˢ s₃.</a>

  <a id="⊕≤ˢ→&lt;ˢˡ"></a><a id="3742" href="Tools.Size.html#3742" class="Function">⊕≤ˢ→&lt;ˢˡ</a> <a id="3750" class="Symbol">:</a> <a id="3752" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="3755" class="InductiveConstructor Operator">⊕</a> <a id="3757" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="3760" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="3763" href="Tools.Size.html#554" class="Generalizable">s₃</a> <a id="3766" class="Symbol">→</a> <a id="3768" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="3771" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="3774" href="Tools.Size.html#554" class="Generalizable">s₃</a>
  <a id="3779" href="Tools.Size.html#3742" class="Function">⊕≤ˢ→&lt;ˢˡ</a> <a id="3787" class="Symbol">(</a><a id="3788" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="3790" href="Tools.Size.html#3790" class="Bound">p</a><a id="3791" class="Symbol">)</a>   <a id="3795" class="Symbol">=</a> <a id="3797" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="3799" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="3805" class="Symbol">(</a><a id="3806" href="Tools.Size.html#3742" class="Function">⊕≤ˢ→&lt;ˢˡ</a> <a id="3814" href="Tools.Size.html#3790" class="Bound">p</a><a id="3815" class="Symbol">)</a>
  <a id="3819" href="Tools.Size.html#3742" class="Function">⊕≤ˢ→&lt;ˢˡ</a> <a id="3827" class="Symbol">(</a><a id="3828" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="3830" href="Tools.Size.html#3830" class="Bound">p</a><a id="3831" class="Symbol">)</a>   <a id="3835" class="Symbol">=</a> <a id="3837" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="3839" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="3845" class="Symbol">(</a><a id="3846" href="Tools.Size.html#3742" class="Function">⊕≤ˢ→&lt;ˢˡ</a> <a id="3854" href="Tools.Size.html#3830" class="Bound">p</a><a id="3855" class="Symbol">)</a>
  <a id="3859" href="Tools.Size.html#3742" class="Function">⊕≤ˢ→&lt;ˢˡ</a> <a id="3867" class="Symbol">(</a><a id="3868" href="Tools.Size.html#3868" class="Bound">p</a> <a id="3870" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="3872" class="Symbol">_)</a> <a id="3875" class="Symbol">=</a> <a id="3877" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="3879" href="Tools.Size.html#3868" class="Bound">p</a>

<a id="3882" class="Keyword">opaque</a>

  <a id="3892" class="Comment">-- If s₁ ⊕ s₂ ≤ˢ s₃, then s₂ &lt;ˢ s₃.</a>

  <a id="⊕≤ˢ→&lt;ˢʳ"></a><a id="3931" href="Tools.Size.html#3931" class="Function">⊕≤ˢ→&lt;ˢʳ</a> <a id="3939" class="Symbol">:</a> <a id="3941" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="3944" class="InductiveConstructor Operator">⊕</a> <a id="3946" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="3949" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="3952" href="Tools.Size.html#554" class="Generalizable">s₃</a> <a id="3955" class="Symbol">→</a> <a id="3957" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="3960" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="3963" href="Tools.Size.html#554" class="Generalizable">s₃</a>
  <a id="3968" href="Tools.Size.html#3931" class="Function">⊕≤ˢ→&lt;ˢʳ</a> <a id="3976" class="Symbol">(</a><a id="3977" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="3979" href="Tools.Size.html#3979" class="Bound">p</a><a id="3980" class="Symbol">)</a>   <a id="3984" class="Symbol">=</a> <a id="3986" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="3988" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="3994" class="Symbol">(</a><a id="3995" href="Tools.Size.html#3931" class="Function">⊕≤ˢ→&lt;ˢʳ</a> <a id="4003" href="Tools.Size.html#3979" class="Bound">p</a><a id="4004" class="Symbol">)</a>
  <a id="4008" href="Tools.Size.html#3931" class="Function">⊕≤ˢ→&lt;ˢʳ</a> <a id="4016" class="Symbol">(</a><a id="4017" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="4019" href="Tools.Size.html#4019" class="Bound">p</a><a id="4020" class="Symbol">)</a>   <a id="4024" class="Symbol">=</a> <a id="4026" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="4028" href="Tools.Size.html#1494" class="Function">&lt;ˢ→≤ˢ</a> <a id="4034" class="Symbol">(</a><a id="4035" href="Tools.Size.html#3931" class="Function">⊕≤ˢ→&lt;ˢʳ</a> <a id="4043" href="Tools.Size.html#4019" class="Bound">p</a><a id="4044" class="Symbol">)</a>
  <a id="4048" href="Tools.Size.html#3931" class="Function">⊕≤ˢ→&lt;ˢʳ</a> <a id="4056" class="Symbol">(_</a> <a id="4059" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="4061" href="Tools.Size.html#4061" class="Bound">p</a><a id="4062" class="Symbol">)</a> <a id="4064" class="Symbol">=</a> <a id="4066" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="4068" href="Tools.Size.html#4061" class="Bound">p</a>

<a id="4071" class="Comment">------------------------------------------------------------------------</a>
<a id="4144" class="Comment">-- Converting sizes to natural numbers</a>

<a id="4184" class="Keyword">opaque</a>

  <a id="4194" class="Comment">-- Sizes can be turned into natural numbers.</a>

  <a id="size-of-size"></a><a id="4242" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="4255" class="Symbol">:</a> <a id="4257" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="4262" class="Symbol">→</a> <a id="4264" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
  <a id="4270" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="4283" href="Tools.Size.html#411" class="InductiveConstructor">leaf</a>    <a id="4291" class="Symbol">=</a> <a id="4293" class="Number">0</a>
  <a id="4297" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="4310" class="Symbol">(</a><a id="4311" href="Tools.Size.html#4311" class="Bound">l</a> <a id="4313" href="Tools.Size.html#425" class="InductiveConstructor Operator">⊕</a> <a id="4315" href="Tools.Size.html#4315" class="Bound">r</a><a id="4316" class="Symbol">)</a> <a id="4318" class="Symbol">=</a> <a id="4320" class="Number">1</a> <a id="4322" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4324" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="4337" href="Tools.Size.html#4311" class="Bound">l</a> <a id="4339" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4341" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="4354" href="Tools.Size.html#4315" class="Bound">r</a>

<a id="4357" class="Keyword">opaque</a>
  <a id="4366" class="Keyword">unfolding</a> <a id="4376" href="Tools.Size.html#4242" class="Function">size-of-size</a>

  <a id="4392" class="Comment">-- The function size-of-size is monotone with respect to _≤ˢ_ and</a>
  <a id="4460" class="Comment">-- _≤_.</a>

  <a id="size-of-size-mono-≤"></a><a id="4471" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4491" class="Symbol">:</a>
    <a id="4497" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="4500" href="Tools.Size.html#780" class="Datatype Operator">≤ˢ</a> <a id="4503" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="4506" class="Symbol">→</a> <a id="4508" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="4521" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="4524" href="Data.Nat.Base.html#1691" class="Datatype Operator">≤</a> <a id="4526" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="4539" href="Tools.Size.html#551" class="Generalizable">s₂</a>
  <a id="4544" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4564" href="Tools.Size.html#813" class="InductiveConstructor">leaf</a> <a id="4569" class="Symbol">=</a>
    <a id="4575" href="Data.Nat.Properties.html#5805" class="Function">≤-refl</a>
  <a id="4584" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4604" class="Symbol">(</a><a id="4605" href="Tools.Size.html#885" class="InductiveConstructor Operator">↙</a> <a id="4607" href="Tools.Size.html#4607" class="Bound">p</a><a id="4608" class="Symbol">)</a> <a id="4610" class="Symbol">=</a>
    <a id="4616" href="Data.Nat.Properties.html#5988" class="Function">≤-trans</a> <a id="4624" class="Symbol">(</a><a id="4625" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4645" href="Tools.Size.html#4607" class="Bound">p</a><a id="4646" class="Symbol">)</a> <a id="4648" class="Symbol">(</a><a id="4649" href="Data.Nat.Properties.html#5988" class="Function">≤-trans</a> <a id="4657" class="Symbol">(</a><a id="4658" href="Data.Nat.Properties.html#18982" class="Function">m≤m+n</a> <a id="4664" class="Symbol">_</a> <a id="4666" class="Symbol">_)</a> <a id="4669" class="Symbol">(</a><a id="4670" href="Data.Nat.Properties.html#8511" class="Function">n≤1+n</a> <a id="4676" class="Symbol">_))</a>
  <a id="4682" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4702" class="Symbol">(</a><a id="4703" href="Tools.Size.html#914" class="InductiveConstructor Operator">↘</a> <a id="4705" href="Tools.Size.html#4705" class="Bound">p</a><a id="4706" class="Symbol">)</a> <a id="4708" class="Symbol">=</a>
    <a id="4714" href="Data.Nat.Properties.html#5988" class="Function">≤-trans</a> <a id="4722" class="Symbol">(</a><a id="4723" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4743" href="Tools.Size.html#4705" class="Bound">p</a><a id="4744" class="Symbol">)</a> <a id="4746" class="Symbol">(</a><a id="4747" href="Data.Nat.Properties.html#5988" class="Function">≤-trans</a> <a id="4755" class="Symbol">(</a><a id="4756" href="Data.Nat.Properties.html#19065" class="Function">m≤n+m</a> <a id="4762" class="Symbol">_</a> <a id="4764" class="Symbol">_)</a> <a id="4767" class="Symbol">(</a><a id="4768" href="Data.Nat.Properties.html#8511" class="Function">n≤1+n</a> <a id="4774" class="Symbol">_))</a>
  <a id="4780" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4800" class="Symbol">(</a><a id="4801" href="Tools.Size.html#4801" class="Bound">p</a> <a id="4803" href="Tools.Size.html#835" class="InductiveConstructor Operator">⊕</a> <a id="4805" href="Tools.Size.html#4805" class="Bound">q</a><a id="4806" class="Symbol">)</a> <a id="4808" class="Symbol">=</a>
    <a id="4814" href="Data.Nat.Base.html#1756" class="InductiveConstructor">s≤s</a> <a id="4818" class="Symbol">(</a><a id="4819" href="Data.Nat.Properties.html#19400" class="Function">+-mono-≤</a> <a id="4828" class="Symbol">(</a><a id="4829" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4849" href="Tools.Size.html#4801" class="Bound">p</a><a id="4850" class="Symbol">)</a> <a id="4852" class="Symbol">(</a><a id="4853" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="4873" href="Tools.Size.html#4805" class="Bound">q</a><a id="4874" class="Symbol">))</a>

<a id="4878" class="Keyword">opaque</a>
  <a id="4887" class="Keyword">unfolding</a> <a id="4897" href="Tools.Size.html#4242" class="Function">size-of-size</a>

  <a id="4913" class="Comment">-- The function size-of-size is monotone with respect to _&lt;ˢ_ and</a>
  <a id="4981" class="Comment">-- _&lt;_.</a>

  <a id="size-of-size-mono-&lt;"></a><a id="4992" href="Tools.Size.html#4992" class="Function">size-of-size-mono-&lt;</a> <a id="5012" class="Symbol">:</a>
    <a id="5018" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="5021" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="5024" href="Tools.Size.html#551" class="Generalizable">s₂</a> <a id="5027" class="Symbol">→</a> <a id="5029" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="5042" href="Tools.Size.html#548" class="Generalizable">s₁</a> <a id="5045" href="Data.Nat.Base.html#1801" class="Function Operator">&lt;</a> <a id="5047" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="5060" href="Tools.Size.html#551" class="Generalizable">s₂</a>
  <a id="5065" href="Tools.Size.html#4992" class="Function">size-of-size-mono-&lt;</a> <a id="5085" class="Symbol">(</a><a id="5086" href="Tools.Size.html#1293" class="InductiveConstructor Operator">↙</a> <a id="5088" href="Tools.Size.html#5088" class="Bound">p</a><a id="5089" class="Symbol">)</a> <a id="5091" class="Symbol">=</a>
    <a id="5097" href="Data.Nat.Base.html#1756" class="InductiveConstructor">s≤s</a> <a id="5101" class="Symbol">(</a><a id="5102" href="Data.Nat.Properties.html#5988" class="Function">≤-trans</a> <a id="5110" class="Symbol">(</a><a id="5111" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="5131" href="Tools.Size.html#5088" class="Bound">p</a><a id="5132" class="Symbol">)</a> <a id="5134" class="Symbol">(</a><a id="5135" href="Data.Nat.Properties.html#18982" class="Function">m≤m+n</a> <a id="5141" class="Symbol">_</a> <a id="5143" class="Symbol">_))</a>
  <a id="5149" href="Tools.Size.html#4992" class="Function">size-of-size-mono-&lt;</a> <a id="5169" class="Symbol">(</a><a id="5170" href="Tools.Size.html#1322" class="InductiveConstructor Operator">↘</a> <a id="5172" href="Tools.Size.html#5172" class="Bound">p</a><a id="5173" class="Symbol">)</a> <a id="5175" class="Symbol">=</a>
    <a id="5181" href="Data.Nat.Base.html#1756" class="InductiveConstructor">s≤s</a> <a id="5185" class="Symbol">(</a><a id="5186" href="Data.Nat.Properties.html#5988" class="Function">≤-trans</a> <a id="5194" class="Symbol">(</a><a id="5195" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="5215" href="Tools.Size.html#5172" class="Bound">p</a><a id="5216" class="Symbol">)</a> <a id="5218" class="Symbol">(</a><a id="5219" href="Data.Nat.Properties.html#19065" class="Function">m≤n+m</a> <a id="5225" class="Symbol">_</a> <a id="5227" class="Symbol">_))</a>
  <a id="5233" href="Tools.Size.html#4992" class="Function">size-of-size-mono-&lt;</a> <a id="5253" class="Symbol">(</a><a id="5254" href="Tools.Size.html#5254" class="Bound">p</a> <a id="5256" href="Tools.Size.html#1193" class="InductiveConstructor Operator">↙⊕</a> <a id="5259" href="Tools.Size.html#5259" class="Bound">q</a><a id="5260" class="Symbol">)</a> <a id="5262" class="Symbol">=</a>
    <a id="5268" href="Data.Nat.Base.html#1756" class="InductiveConstructor">s≤s</a> <a id="5272" class="Symbol">(</a><a id="5273" href="Data.Nat.Properties.html#19736" class="Function">+-mono-&lt;-≤</a> <a id="5284" class="Symbol">(</a><a id="5285" href="Tools.Size.html#4992" class="Function">size-of-size-mono-&lt;</a> <a id="5305" href="Tools.Size.html#5254" class="Bound">p</a><a id="5306" class="Symbol">)</a> <a id="5308" class="Symbol">(</a><a id="5309" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="5329" href="Tools.Size.html#5259" class="Bound">q</a><a id="5330" class="Symbol">))</a>
  <a id="5335" href="Tools.Size.html#4992" class="Function">size-of-size-mono-&lt;</a> <a id="5355" class="Symbol">(</a><a id="5356" href="Tools.Size.html#5356" class="Bound">p</a> <a id="5358" href="Tools.Size.html#1243" class="InductiveConstructor Operator">⊕↘</a> <a id="5361" href="Tools.Size.html#5361" class="Bound">q</a><a id="5362" class="Symbol">)</a> <a id="5364" class="Symbol">=</a>
    <a id="5370" href="Data.Nat.Base.html#1756" class="InductiveConstructor">s≤s</a> <a id="5374" class="Symbol">(</a><a id="5375" href="Data.Nat.Properties.html#19922" class="Function">+-mono-≤-&lt;</a> <a id="5386" class="Symbol">(</a><a id="5387" href="Tools.Size.html#4471" class="Function">size-of-size-mono-≤</a> <a id="5407" href="Tools.Size.html#5356" class="Bound">p</a><a id="5408" class="Symbol">)</a> <a id="5410" class="Symbol">(</a><a id="5411" href="Tools.Size.html#4992" class="Function">size-of-size-mono-&lt;</a> <a id="5431" href="Tools.Size.html#5361" class="Bound">q</a><a id="5432" class="Symbol">))</a>

<a id="5436" class="Comment">------------------------------------------------------------------------</a>
<a id="5509" class="Comment">-- Well-founded induction</a>

<a id="5536" class="Keyword">opaque</a>

  <a id="5546" class="Comment">-- The relation _&lt;ˢ_ is well-founded.</a>

  <a id="&lt;ˢ-well-founded"></a><a id="5587" href="Tools.Size.html#5587" class="Function">&lt;ˢ-well-founded</a> <a id="5603" class="Symbol">:</a> <a id="5605" href="Induction.WellFounded.html#1604" class="Function">WellFounded</a> <a id="5617" href="Tools.Size.html#1160" class="Datatype Operator">_&lt;ˢ_</a>
  <a id="5624" href="Tools.Size.html#5587" class="Function">&lt;ˢ-well-founded</a> <a id="5640" class="Symbol">=</a>
    <a id="5646" href="Induction.WellFounded.html#5171" class="Function">Subrelation.wellFounded</a>
      <a id="5676" href="Tools.Size.html#4992" class="Function">size-of-size-mono-&lt;</a>
      <a id="5702" class="Symbol">(</a><a id="5703" href="Relation.Binary.Construct.On.html#2860" class="Function">On.wellFounded</a> <a id="5718" href="Tools.Size.html#4242" class="Function">size-of-size</a> <a id="5731" href="Data.Nat.Induction.html#2190" class="Function">&lt;-wellFounded</a><a id="5744" class="Symbol">)</a>

<a id="5747" class="Keyword">opaque</a>

  <a id="5757" class="Comment">-- Well-founded induction for sizes.</a>

  <a id="well-founded-induction"></a><a id="5797" href="Tools.Size.html#5797" class="Function">well-founded-induction</a> <a id="5820" class="Symbol">:</a>
    <a id="5826" class="Symbol">∀</a> <a id="5828" class="Symbol">{</a><a id="5829" href="Tools.Size.html#5829" class="Bound">p</a><a id="5830" class="Symbol">}</a> <a id="5832" class="Symbol">(</a><a id="5833" href="Tools.Size.html#5833" class="Bound">P</a> <a id="5835" class="Symbol">:</a> <a id="5837" href="Tools.Size.html#392" class="Datatype">Size</a> <a id="5842" class="Symbol">→</a> <a id="5844" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="5848" href="Tools.Size.html#5829" class="Bound">p</a><a id="5849" class="Symbol">)</a> <a id="5851" class="Symbol">→</a>
    <a id="5857" class="Symbol">(∀</a> <a id="5860" href="Tools.Size.html#5860" class="Bound">s₁</a> <a id="5863" class="Symbol">→</a> <a id="5865" class="Symbol">(∀</a> <a id="5868" class="Symbol">{</a><a id="5869" href="Tools.Size.html#5869" class="Bound">s₂</a><a id="5871" class="Symbol">}</a> <a id="5873" class="Symbol">→</a> <a id="5875" href="Tools.Size.html#5869" class="Bound">s₂</a> <a id="5878" href="Tools.Size.html#1160" class="Datatype Operator">&lt;ˢ</a> <a id="5881" href="Tools.Size.html#5860" class="Bound">s₁</a> <a id="5884" class="Symbol">→</a> <a id="5886" href="Tools.Size.html#5833" class="Bound">P</a> <a id="5888" href="Tools.Size.html#5869" class="Bound">s₂</a><a id="5890" class="Symbol">)</a> <a id="5892" class="Symbol">→</a> <a id="5894" href="Tools.Size.html#5833" class="Bound">P</a> <a id="5896" href="Tools.Size.html#5860" class="Bound">s₁</a><a id="5898" class="Symbol">)</a> <a id="5900" class="Symbol">→</a>
    <a id="5906" class="Symbol">∀</a> <a id="5908" href="Tools.Size.html#5908" class="Bound">s</a> <a id="5910" class="Symbol">→</a> <a id="5912" href="Tools.Size.html#5833" class="Bound">P</a> <a id="5914" href="Tools.Size.html#5908" class="Bound">s</a>
  <a id="5918" href="Tools.Size.html#5797" class="Function">well-founded-induction</a> <a id="5941" class="Symbol">=</a>
    <a id="5947" href="Induction.WellFounded.html#3153" class="Function">All.wfRec</a> <a id="5957" href="Tools.Size.html#5587" class="Function">&lt;ˢ-well-founded</a> <a id="5973" class="Symbol">_</a>
</pre></body></html>