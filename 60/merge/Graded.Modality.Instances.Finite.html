<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Graded.Modality.Instances.Finite</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- A finite semiring is a modality instance.</a>
<a id="119" class="Comment">------------------------------------------------------------------------</a>

<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Tools.Bool.html" class="Module">Tools.Bool</a> <a id="216" class="Keyword">hiding</a> <a id="223" class="Symbol">(</a><a id="224" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a><a id="227" class="Symbol">;</a> <a id="229" href="Tools.Bool.html#2993" class="Function">∧-decreasingˡ</a><a id="242" class="Symbol">;</a> <a id="244" href="Tools.Bool.html#3179" class="Function">∧-decreasingʳ</a><a id="257" class="Symbol">)</a>
<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Tools.Fin.html" class="Module">Tools.Fin</a>
<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Tools.Nat.html" class="Module">Tools.Nat</a> <a id="303" class="Keyword">using</a> <a id="309" class="Symbol">(</a><a id="310" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a><a id="313" class="Symbol">;</a> <a id="315" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a><a id="317" class="Symbol">)</a>
<a id="319" class="Keyword">open</a> <a id="324" class="Keyword">import</a> <a id="331" href="Tools.Product.html" class="Module">Tools.Product</a>
<a id="345" class="Keyword">open</a> <a id="350" class="Keyword">import</a> <a id="357" href="Tools.PropositionalEquality.html" class="Module">Tools.PropositionalEquality</a>
<a id="385" class="Keyword">import</a> <a id="392" href="Graded.Modality.html" class="Module">Graded.Modality</a>

<a id="409" class="Keyword">module</a> <a id="416" href="Graded.Modality.Instances.Finite.html" class="Module">Graded.Modality.Instances.Finite</a>
  <a id="451" class="Symbol">{</a><a id="452" href="Graded.Modality.Instances.Finite.html#452" class="Bound">a</a><a id="453" class="Symbol">}</a> <a id="455" class="Symbol">{</a><a id="456" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a> <a id="458" class="Symbol">:</a> <a id="460" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="464" href="Graded.Modality.Instances.Finite.html#452" class="Bound">a</a><a id="465" class="Symbol">}</a>
  <a id="469" class="Symbol">(</a><a id="470" class="Keyword">open</a> <a id="475" href="Graded.Modality.html" class="Module">Graded.Modality</a> <a id="491" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="492" class="Symbol">)</a>
  <a id="496" class="Symbol">(</a><a id="497" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a> <a id="499" class="Symbol">:</a> <a id="501" href="Graded.Modality.html#601" class="Record">Semiring-with-meet</a><a id="519" class="Symbol">)</a>
  <a id="523" class="Symbol">(</a><a id="524" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a> <a id="528" class="Symbol">:</a> <a id="530" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="532" class="Symbol">λ</a> <a id="534" href="Graded.Modality.Instances.Finite.html#534" class="Bound">n</a> <a id="536" class="Symbol">→</a> <a id="538" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a> <a id="540" class="Symbol">(</a><a id="541" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="545" class="Symbol">(</a><a id="546" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="549" href="Graded.Modality.Instances.Finite.html#534" class="Bound">n</a><a id="550" class="Symbol">)</a> <a id="552" class="Symbol">→</a> <a id="554" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="555" class="Symbol">)</a>
                 <a id="574" class="Symbol">λ</a> <a id="576" href="Graded.Modality.Instances.Finite.html#576" class="Bound">f</a> <a id="578" class="Symbol">→</a> <a id="580" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a> <a id="582" class="Symbol">(</a><a id="583" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a> <a id="585" class="Symbol">→</a> <a id="587" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="591" class="Symbol">(</a><a id="592" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="595" href="Graded.Modality.Instances.Finite.html#534" class="Bound">n</a><a id="596" class="Symbol">))</a>
                 <a id="616" class="Symbol">λ</a> <a id="618" href="Graded.Modality.Instances.Finite.html#618" class="Bound">f⁻¹</a> <a id="622" class="Symbol">→</a> <a id="624" class="Symbol">((</a><a id="626" href="Graded.Modality.Instances.Finite.html#626" class="Bound">p</a> <a id="628" class="Symbol">:</a> <a id="630" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="631" class="Symbol">)</a> <a id="633" class="Symbol">→</a> <a id="635" href="Graded.Modality.Instances.Finite.html#576" class="Bound">f</a> <a id="637" class="Symbol">(</a><a id="638" href="Graded.Modality.Instances.Finite.html#618" class="Bound">f⁻¹</a> <a id="642" href="Graded.Modality.Instances.Finite.html#626" class="Bound">p</a><a id="643" class="Symbol">)</a> <a id="645" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="647" href="Graded.Modality.Instances.Finite.html#626" class="Bound">p</a><a id="648" class="Symbol">))</a>
  <a id="653" class="Keyword">where</a>

<a id="660" class="Keyword">private</a>
  <a id="670" class="Keyword">variable</a>
    <a id="683" href="Graded.Modality.Instances.Finite.html#683" class="Generalizable">n</a> <a id="685" class="Symbol">:</a> <a id="687" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>

<a id="692" class="Keyword">open</a> <a id="697" href="Graded.Modality.html#601" class="Module">Semiring-with-meet</a> <a id="716" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a>

<a id="719" class="Keyword">import</a> <a id="726" href="Graded.Modality.Instances.LowerBounded.html" class="Module">Graded.Modality.Instances.LowerBounded</a> <a id="765" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a> <a id="767" class="Symbol">as</a> <a id="LB"></a><a id="770" href="Graded.Modality.Instances.Finite.html#770" class="Module">LB</a>
<a id="773" class="Keyword">open</a> <a id="778" class="Keyword">import</a> <a id="785" href="Graded.Modality.Variant.html" class="Module">Graded.Modality.Variant</a> <a id="809" href="Graded.Modality.Instances.Finite.html#452" class="Bound">a</a>
<a id="811" class="Keyword">open</a> <a id="816" class="Keyword">import</a> <a id="823" href="Graded.Modality.Properties.Meet.html" class="Module">Graded.Modality.Properties.Meet</a> <a id="855" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a>
<a id="857" class="Keyword">open</a> <a id="862" class="Keyword">import</a> <a id="869" href="Graded.Modality.Properties.PartialOrder.html" class="Module">Graded.Modality.Properties.PartialOrder</a> <a id="909" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a>

<a id="912" class="Keyword">open</a> <a id="917" class="Keyword">import</a> <a id="924" href="Tools.Reasoning.PropositionalEquality.html" class="Module">Tools.Reasoning.PropositionalEquality</a>
<a id="962" class="Keyword">open</a> <a id="967" class="Keyword">import</a> <a id="974" href="Tools.Relation.html" class="Module">Tools.Relation</a> <a id="989" class="Symbol">as</a> <a id="992" class="Module">Dec</a>

<a id="|M|"></a><a id="997" href="Graded.Modality.Instances.Finite.html#997" class="Function">|M|</a> <a id="1001" class="Symbol">:</a> <a id="1003" href="Agda.Builtin.Nat.html#203" class="Datatype">Nat</a>
<a id="1007" href="Graded.Modality.Instances.Finite.html#997" class="Function">|M|</a> <a id="1011" class="Symbol">=</a> <a id="1013" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="1016" class="Symbol">(</a><a id="1017" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1023" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a><a id="1026" class="Symbol">)</a>

<a id="f"></a><a id="1029" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="1031" class="Symbol">:</a> <a id="1033" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1037" href="Graded.Modality.Instances.Finite.html#997" class="Function">|M|</a> <a id="1041" class="Symbol">→</a> <a id="1043" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a>
<a id="1045" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="1047" class="Symbol">=</a> <a id="1049" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1062" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a><a id="1065" class="Symbol">)</a>

<a id="f⁻¹"></a><a id="1068" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="1072" class="Symbol">:</a> <a id="1074" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a> <a id="1076" class="Symbol">→</a> <a id="1078" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1082" href="Graded.Modality.Instances.Finite.html#997" class="Function">|M|</a>
<a id="1086" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="1090" class="Symbol">=</a> <a id="1092" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1098" class="Symbol">(</a><a id="1099" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1105" class="Symbol">(</a><a id="1106" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1112" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a><a id="1115" class="Symbol">))</a>

<a id="f-f⁻¹"></a><a id="1119" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="1125" class="Symbol">:</a> <a id="1127" class="Symbol">(</a><a id="1128" href="Graded.Modality.Instances.Finite.html#1128" class="Bound">p</a> <a id="1130" class="Symbol">:</a> <a id="1132" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1133" class="Symbol">)</a> <a id="1135" class="Symbol">→</a> <a id="1137" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="1139" class="Symbol">(</a><a id="1140" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="1144" href="Graded.Modality.Instances.Finite.html#1128" class="Bound">p</a><a id="1145" class="Symbol">)</a> <a id="1147" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1149" href="Graded.Modality.Instances.Finite.html#1128" class="Bound">p</a>
<a id="1151" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="1157" class="Symbol">=</a> <a id="1159" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1165" class="Symbol">(</a><a id="1166" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1172" class="Symbol">(</a><a id="1173" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1179" href="Graded.Modality.Instances.Finite.html#524" class="Bound">fin</a><a id="1182" class="Symbol">))</a>

<a id="1186" class="Comment">-- n-ary meet</a>

<a id="⋀"></a><a id="1201" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1203" class="Symbol">:</a> <a id="1205" class="Symbol">(</a><a id="1206" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1210" class="Symbol">(</a><a id="1211" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="1214" href="Graded.Modality.Instances.Finite.html#683" class="Generalizable">n</a><a id="1215" class="Symbol">)</a> <a id="1217" class="Symbol">→</a> <a id="1219" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1220" class="Symbol">)</a> <a id="1222" class="Symbol">→</a> <a id="1224" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a>
<a id="1226" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1228" class="Symbol">{</a><a id="1229" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">Nat.zero</a><a id="1237" class="Symbol">}</a> <a id="1239" href="Graded.Modality.Instances.Finite.html#1239" class="Bound">aₙ</a> <a id="1242" class="Symbol">=</a> <a id="1244" href="Graded.Modality.Instances.Finite.html#1239" class="Bound">aₙ</a> <a id="1247" href="Data.Fin.Base.html#1181" class="InductiveConstructor">x0</a>
<a id="1250" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1252" class="Symbol">{</a><a id="1253" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="1256" href="Graded.Modality.Instances.Finite.html#1256" class="Bound">n</a><a id="1257" class="Symbol">}</a> <a id="1259" href="Graded.Modality.Instances.Finite.html#1259" class="Bound">aₙ</a> <a id="1262" class="Symbol">=</a> <a id="1264" class="Symbol">(</a><a id="1265" href="Graded.Modality.Instances.Finite.html#1259" class="Bound">aₙ</a> <a id="1268" href="Data.Fin.Base.html#1181" class="InductiveConstructor">x0</a><a id="1270" class="Symbol">)</a> <a id="1272" href="Graded.Modality.html#910" class="Function Operator">∧</a> <a id="1274" class="Symbol">(</a><a id="1275" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1277" class="Symbol">(λ</a> <a id="1280" href="Graded.Modality.Instances.Finite.html#1280" class="Bound">x</a> <a id="1282" class="Symbol">→</a> <a id="1284" href="Graded.Modality.Instances.Finite.html#1259" class="Bound">aₙ</a> <a id="1287" class="Symbol">(</a><a id="1288" href="Graded.Modality.Instances.Finite.html#1280" class="Bound">x</a> <a id="1290" href="Data.Fin.Base.html#1202" class="InductiveConstructor Operator">+1</a><a id="1292" class="Symbol">)))</a>

<a id="1297" class="Comment">-- ∞ is the meet of all elements</a>

<a id="∞"></a><a id="1331" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="1333" class="Symbol">:</a> <a id="1335" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a>
<a id="1337" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="1339" class="Symbol">=</a> <a id="1341" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1343" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a>

<a id="1346" class="Comment">-- ⋀ is decreasing (i.e. smaller than all its arguments)</a>

<a id="⋀-decr"></a><a id="1404" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1411" class="Symbol">:</a> <a id="1413" class="Symbol">(</a><a id="1414" href="Graded.Modality.Instances.Finite.html#1414" class="Bound">f</a> <a id="1416" class="Symbol">:</a> <a id="1418" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1422" class="Symbol">(</a><a id="1423" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="1426" href="Graded.Modality.Instances.Finite.html#683" class="Generalizable">n</a><a id="1427" class="Symbol">)</a> <a id="1429" class="Symbol">→</a> <a id="1431" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1432" class="Symbol">)</a> <a id="1434" class="Symbol">→</a> <a id="1436" class="Symbol">(</a><a id="1437" href="Graded.Modality.Instances.Finite.html#1437" class="Bound">x</a> <a id="1439" class="Symbol">:</a> <a id="1441" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1445" class="Symbol">(</a><a id="1446" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="1449" href="Graded.Modality.Instances.Finite.html#683" class="Generalizable">n</a><a id="1450" class="Symbol">))</a> <a id="1453" class="Symbol">→</a> <a id="1455" href="Graded.Modality.Instances.Finite.html#1201" class="Function">⋀</a> <a id="1457" href="Graded.Modality.Instances.Finite.html#1414" class="Bound">f</a> <a id="1459" href="Graded.Modality.html#1365" class="Function Operator">≤</a> <a id="1461" href="Graded.Modality.Instances.Finite.html#1414" class="Bound">f</a> <a id="1463" href="Graded.Modality.Instances.Finite.html#1437" class="Bound">x</a>
<a id="1465" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1472" class="Symbol">{</a><a id="1473" class="Number">0</a><a id="1474" class="Symbol">}</a> <a id="1476" href="Graded.Modality.Instances.Finite.html#1476" class="Bound">f</a> <a id="1478" href="Data.Fin.Base.html#1181" class="InductiveConstructor">x0</a> <a id="1481" class="Symbol">=</a> <a id="1483" href="Graded.Modality.Properties.PartialOrder.html#571" class="Function">≤-refl</a>
<a id="1490" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1497" class="Symbol">{</a><a id="1498" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="1501" href="Graded.Modality.Instances.Finite.html#1501" class="Bound">n</a><a id="1502" class="Symbol">}</a> <a id="1504" href="Graded.Modality.Instances.Finite.html#1504" class="Bound">f</a> <a id="1506" href="Data.Fin.Base.html#1181" class="InductiveConstructor">x0</a> <a id="1509" class="Symbol">=</a> <a id="1511" href="Graded.Modality.Properties.Meet.html#1916" class="Function">∧-decreasingˡ</a> <a id="1525" class="Symbol">_</a> <a id="1527" class="Symbol">_</a>
<a id="1529" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1536" class="Symbol">{</a><a id="1537" href="Tools.Nat.html#2085" class="InductiveConstructor">1+</a> <a id="1540" href="Graded.Modality.Instances.Finite.html#1540" class="Bound">n</a><a id="1541" class="Symbol">}</a> <a id="1543" href="Graded.Modality.Instances.Finite.html#1543" class="Bound">f</a> <a id="1545" class="Symbol">(</a><a id="1546" href="Data.Fin.Base.html#1202" class="InductiveConstructor Operator">_+1</a> <a id="1550" href="Graded.Modality.Instances.Finite.html#1550" class="Bound">x</a><a id="1551" class="Symbol">)</a> <a id="1553" class="Symbol">=</a> <a id="1555" href="Graded.Modality.Properties.PartialOrder.html#668" class="Function">≤-trans</a> <a id="1563" class="Symbol">(</a><a id="1564" href="Graded.Modality.Properties.Meet.html#2216" class="Function">∧-decreasingʳ</a> <a id="1578" class="Symbol">_</a> <a id="1580" class="Symbol">_)</a> <a id="1583" class="Symbol">(</a><a id="1584" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1591" class="Symbol">(λ</a> <a id="1594" href="Graded.Modality.Instances.Finite.html#1594" class="Bound">x</a> <a id="1596" class="Symbol">→</a> <a id="1598" href="Graded.Modality.Instances.Finite.html#1543" class="Bound">f</a> <a id="1600" class="Symbol">(</a><a id="1601" href="Graded.Modality.Instances.Finite.html#1594" class="Bound">x</a> <a id="1603" href="Data.Fin.Base.html#1202" class="InductiveConstructor Operator">+1</a><a id="1605" class="Symbol">))</a> <a id="1608" href="Graded.Modality.Instances.Finite.html#1550" class="Bound">x</a><a id="1609" class="Symbol">)</a>

<a id="1612" class="Comment">-- ∞ is the least element</a>

<a id="∞-min"></a><a id="1639" href="Graded.Modality.Instances.Finite.html#1639" class="Function">∞-min</a> <a id="1645" class="Symbol">:</a> <a id="1647" class="Symbol">(</a><a id="1648" href="Graded.Modality.Instances.Finite.html#1648" class="Bound">p</a> <a id="1650" class="Symbol">:</a> <a id="1652" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1653" class="Symbol">)</a> <a id="1655" class="Symbol">→</a> <a id="1657" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="1659" href="Graded.Modality.html#1365" class="Function Operator">≤</a> <a id="1661" href="Graded.Modality.Instances.Finite.html#1648" class="Bound">p</a>
<a id="1663" href="Graded.Modality.Instances.Finite.html#1639" class="Function">∞-min</a> <a id="1669" href="Graded.Modality.Instances.Finite.html#1669" class="Bound">p</a> <a id="1671" class="Symbol">=</a> <a id="1673" href="Graded.Modality.Properties.PartialOrder.html#668" class="Function">≤-trans</a> <a id="1681" class="Symbol">(</a><a id="1682" href="Graded.Modality.Instances.Finite.html#1404" class="Function">⋀-decr</a> <a id="1689" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="1691" class="Symbol">(</a><a id="1692" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="1696" href="Graded.Modality.Instances.Finite.html#1669" class="Bound">p</a><a id="1697" class="Symbol">))</a> <a id="1700" class="Symbol">(</a><a id="1701" href="Graded.Modality.Properties.PartialOrder.html#1013" class="Function">≤-reflexive</a> <a id="1713" class="Symbol">(</a><a id="1714" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="1720" href="Graded.Modality.Instances.Finite.html#1669" class="Bound">p</a><a id="1721" class="Symbol">))</a>

<a id="1725" class="Comment">-- The least element can be used to define a natrec-star operator.</a>

<a id="has-star"></a><a id="1793" href="Graded.Modality.Instances.Finite.html#1793" class="Function">has-star</a> <a id="1802" class="Symbol">:</a> <a id="1804" href="Graded.Modality.html#6970" class="Record">Has-star</a> <a id="1813" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a>
<a id="1815" href="Graded.Modality.Instances.Finite.html#1793" class="Function">has-star</a> <a id="1824" class="Symbol">=</a> <a id="1826" href="Graded.Modality.Instances.LowerBounded.html#4308" class="Function">LB.has-star</a> <a id="1838" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="1840" href="Graded.Modality.Instances.Finite.html#1639" class="Function">∞-min</a>

<a id="1847" class="Keyword">opaque</a>

  <a id="1857" class="Comment">-- Equality is decidable for M.</a>

  <a id="1892" class="Keyword">infix</a> <a id="1898" class="Number">10</a> <a id="1901" href="Graded.Modality.Instances.Finite.html#1908" class="Function Operator">_≟_</a>

  <a id="_≟_"></a><a id="1908" href="Graded.Modality.Instances.Finite.html#1908" class="Function Operator">_≟_</a> <a id="1912" class="Symbol">:</a> <a id="1914" href="Relation.Binary.Definitions.html#6713" class="Function">Decidable</a> <a id="1924" class="Symbol">(</a><a id="1925" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a> <a id="1929" class="Symbol">{</a><a id="1930" class="Argument">A</a> <a id="1932" class="Symbol">=</a> <a id="1934" href="Graded.Modality.Instances.Finite.html#456" class="Bound">M</a><a id="1935" class="Symbol">})</a>
  <a id="1940" href="Graded.Modality.Instances.Finite.html#1940" class="Bound">p</a> <a id="1942" href="Graded.Modality.Instances.Finite.html#1908" class="Function Operator">≟</a> <a id="1944" href="Graded.Modality.Instances.Finite.html#1944" class="Bound">q</a> <a id="1946" class="Symbol">=</a>
    <a id="1952" href="Tools.Relation.html#700" class="Function">Dec.map</a>
      <a id="1966" class="Symbol">(λ</a> <a id="1969" href="Graded.Modality.Instances.Finite.html#1969" class="Bound">f⁻¹p≡f⁻¹q</a> <a id="1979" class="Symbol">→</a>
         <a id="1990" href="Graded.Modality.Instances.Finite.html#1940" class="Bound">p</a>          <a id="2001" href="Relation.Binary.Reasoning.Syntax.html#11539" class="Function">≡˘⟨</a> <a id="2005" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="2011" class="Symbol">_</a> <a id="2013" href="Relation.Binary.Reasoning.Syntax.html#11539" class="Function">⟩</a>
         <a id="2024" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="2026" class="Symbol">(</a><a id="2027" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="2031" href="Graded.Modality.Instances.Finite.html#1940" class="Bound">p</a><a id="2032" class="Symbol">)</a>  <a id="2035" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="2038" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="2043" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="2045" href="Graded.Modality.Instances.Finite.html#1969" class="Bound">f⁻¹p≡f⁻¹q</a> <a id="2055" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
         <a id="2066" href="Graded.Modality.Instances.Finite.html#1029" class="Function">f</a> <a id="2068" class="Symbol">(</a><a id="2069" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="2073" href="Graded.Modality.Instances.Finite.html#1944" class="Bound">q</a><a id="2074" class="Symbol">)</a>  <a id="2077" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="2080" href="Graded.Modality.Instances.Finite.html#1119" class="Function">f-f⁻¹</a> <a id="2086" class="Symbol">_</a> <a id="2088" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
         <a id="2099" href="Graded.Modality.Instances.Finite.html#1944" class="Bound">q</a>          <a id="2110" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a><a id="2111" class="Symbol">)</a>
      <a id="2119" class="Symbol">(</a><a id="2120" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="2125" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a><a id="2128" class="Symbol">)</a>
      <a id="2136" class="Symbol">(</a><a id="2137" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="2141" href="Graded.Modality.Instances.Finite.html#1940" class="Bound">p</a> <a id="2143" href="Tools.Fin.html#267" class="Function Operator">≟ⱽ</a> <a id="2146" href="Graded.Modality.Instances.Finite.html#1068" class="Function">f⁻¹</a> <a id="2150" href="Graded.Modality.Instances.Finite.html#1944" class="Bound">q</a><a id="2151" class="Symbol">)</a>

<a id="2154" class="Comment">-- If certain properties hold, then 𝕄 can be turned into a certain</a>
<a id="2221" class="Comment">-- kind of modality.</a>

<a id="isModality"></a><a id="2243" href="Graded.Modality.Instances.Finite.html#2243" class="Function">isModality</a> <a id="2254" class="Symbol">:</a>
  <a id="2258" class="Symbol">(</a><a id="2259" href="Graded.Modality.Instances.Finite.html#2259" class="Bound">variant</a> <a id="2267" class="Symbol">:</a> <a id="2269" href="Graded.Modality.Variant.html#710" class="Record">Modality-variant</a><a id="2285" class="Symbol">)</a> <a id="2287" class="Symbol">→</a>
  <a id="2291" class="Keyword">let</a> <a id="2295" class="Keyword">open</a> <a id="2300" href="Graded.Modality.Variant.html#710" class="Module">Modality-variant</a> <a id="2317" href="Graded.Modality.Instances.Finite.html#2259" class="Bound">variant</a> <a id="2325" class="Keyword">in</a>
  <a id="2330" class="Symbol">(</a><a id="2331" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="2333" href="Graded.Modality.Variant.html#820" class="Field">𝟘ᵐ-allowed</a> <a id="2344" class="Symbol">→</a> <a id="2346" href="Graded.Modality.html#3694" class="Record">Has-well-behaved-zero</a> <a id="2368" href="Graded.Modality.Instances.Finite.html#497" class="Bound">𝕄</a><a id="2369" class="Symbol">)</a> <a id="2371" class="Symbol">→</a>
  <a id="2375" href="Graded.Modality.html#8202" class="Record">Modality</a>
<a id="2384" href="Graded.Modality.Instances.Finite.html#2243" class="Function">isModality</a> <a id="2395" class="Symbol">=</a> <a id="2397" href="Graded.Modality.Instances.LowerBounded.html#4744" class="Function">LB.isModality</a> <a id="2411" href="Graded.Modality.Instances.Finite.html#1331" class="Function">∞</a> <a id="2413" href="Graded.Modality.Instances.Finite.html#1639" class="Function">∞-min</a>
</pre></body></html>